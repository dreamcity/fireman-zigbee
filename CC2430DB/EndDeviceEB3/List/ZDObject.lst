###############################################################################
#                                                                             #
# IAR 8051 C/C++ Compiler V7.30B/W32                    18/Mar/2013  18:21:49 #
# Copyright 2004-2007 IAR Systems. All rights reserved.                       #
#                                                                             #
#    Core               =  plain                                              #
#    Code model         =  banked                                             #
#    Data model         =  large                                              #
#    Calling convention =  xdata reentrant                                    #
#    Constant location  =  data                                               #
#    Dptr setup         =  1,16                                               #
#    Source file        =  C:\Texas Instruments\ZStack-1.4.3-1.2.1\Components #
#                          \stack\zdo\ZDObject.c                              #
#    Command line       =  -f "C:\Texas Instruments\ZStack-1.4.3-1.2.1\Projec #
#                          ts\zstack\Samples\cc2430-zstack-adxl345\CC2430DB\. #
#                          .\..\..\Tools\CC2430DB\f8wEndev.cfg" (-DCPU32MHZ   #
#                          -DFORCE_MAC_NEAR -DROOT=__near_func                #
#                          -DMAC_OPT_FFD=0 -DBLINK_LEDS "-DCONST=const        #
#                          __code" -DGENERIC=__generic) -f "C:\Texas          #
#                          Instruments\ZStack-1.4.3-1.2.1\Projects\zstack\Sam #
#                          ples\cc2430-zstack-adxl345\CC2430DB\..\..\..\Tools #
#                          \CC2430DB\f8wConfig.cfg" (-DSECURE=0               #
#                          -DDEFAULT_CHANLIST=0x00000800                      #
#                          -DZDAPP_CONFIG_PAN_ID=0xFFFF                       #
#                          -DNWK_START_DELAY=100 -DEXTENDED_JOINING_RANDOM_MA #
#                          SK=0x007F -DBEACON_REQUEST_DELAY=100               #
#                          -DBEACON_REQ_DELAY_MASK=0x00FF                     #
#                          -DROUTE_EXPIRY_TIME=30 -DAPSC_ACK_WAIT_DURATION_PO #
#                          LLED=3000 -DNWK_INDIRECT_MSG_TIMEOUT=7             #
#                          -DMAX_RREQ_ENTRIES=10 -DAPSC_MAX_FRAME_RETRIES=3   #
#                          -DNWK_MAX_DATA_RETRIES=2                           #
#                          -DMAX_POLL_FAILURE_RETRIES=2 -DMAX_BCAST=9         #
#                          -DAPS_MAX_GROUPS=16 -DMAX_RTG_ENTRIES=20           #
#                          -DNWK_MAX_BINDING_ENTRIES=10                       #
#                          -DMAX_BINDING_CLUSTER_IDS=5 "-DDEFAULT_KEY={0x01,  #
#                          0x03, 0x05, 0x07, 0x09, 0x0B, 0x0D, 0x0F, 0x00,    #
#                          0x02, 0x04, 0x06, 0x08, 0x0A, 0x0C, 0x0D}"         #
#                          -DRFD_RCVC_ALWAYS_ON=FALSE -DPOLL_RATE=1000        #
#                          -DQUEUED_POLL_RATE=100 -DRESPONSE_POLL_RATE=100)   #
#                          -DREJOIN_POLL_RATE=440 "C:\Texas                   #
#                          Instruments\ZStack-1.4.3-1.2.1\Components\stack\zd #
#                          o\ZDObject.c" -D CC2430EB -D AXD_END3 -D           #
#                          NWK_AUTO_POLL -D REFLECTOR -D xZTOOL_P1 -D         #
#                          xMT_TASK -D xMT_ZDO_FUNC -D xLCD_SUPPORTED=DEBUG   #
#                          -D xPOWER_SAVING -lC "C:\Texas                     #
#                          Instruments\ZStack-1.4.3-1.2.1\Projects\zstack\Sam #
#                          ples\cc2430-zstack-adxl345\CC2430DB\EndDeviceEB3\L #
#                          ist\" -lA "C:\Texas Instruments\ZStack-1.4.3-1.2.1 #
#                          \Projects\zstack\Samples\cc2430-zstack-adxl345\CC2 #
#                          430DB\EndDeviceEB3\List\" --diag_suppress          #
#                          Pe001,Pa010 --diag_remark pe550 -o "C:\Texas       #
#                          Instruments\ZStack-1.4.3-1.2.1\Projects\zstack\Sam #
#                          ples\cc2430-zstack-adxl345\CC2430DB\EndDeviceEB3\O #
#                          bj\" -e --require_prototypes -z2 --no_cse          #
#                          --no_unroll --no_inline --no_code_motion           #
#                          --no_tbaa --debug --core=plain --dptr=16,1         #
#                          --data_model=large --code_model=banked             #
#                          --calling_convention=xdata_reentrant               #
#                          --place_constants=data --nr_virtual_regs 8 -I      #
#                          "C:\Texas Instruments\ZStack-1.4.3-1.2.1\Projects\ #
#                          zstack\Samples\cc2430-zstack-adxl345\CC2430DB\"    #
#                          -I "C:\Texas Instruments\ZStack-1.4.3-1.2.1\Projec #
#                          ts\zstack\Samples\cc2430-zstack-adxl345\CC2430DB\. #
#                          .\SOURCE\" -I "C:\Texas Instruments\ZStack-1.4.3-1 #
#                          .2.1\Projects\zstack\Samples\cc2430-zstack-adxl345 #
#                          \CC2430DB\..\Drivers\" -I "C:\Texas                #
#                          Instruments\ZStack-1.4.3-1.2.1\Projects\zstack\Sam #
#                          ples\cc2430-zstack-adxl345\CC2430DB\..\..\..\ZMAIN #
#                          \TI2430DB\" -I "C:\Texas                           #
#                          Instruments\ZStack-1.4.3-1.2.1\Projects\zstack\Sam #
#                          ples\cc2430-zstack-adxl345\CC2430DB\..\..\..\..\.. #
#                          \COMPONENTS\MT\" -I "C:\Texas                      #
#                          Instruments\ZStack-1.4.3-1.2.1\Projects\zstack\Sam #
#                          ples\cc2430-zstack-adxl345\CC2430DB\..\..\..\..\.. #
#                          \COMPONENTS\HAL\INCLUDE\" -I "C:\Texas             #
#                          Instruments\ZStack-1.4.3-1.2.1\Projects\zstack\Sam #
#                          ples\cc2430-zstack-adxl345\CC2430DB\..\..\..\..\.. #
#                          \COMPONENTS\HAL\TARGET\CC2430EB\" -I "C:\Texas     #
#                          Instruments\ZStack-1.4.3-1.2.1\Projects\zstack\Sam #
#                          ples\cc2430-zstack-adxl345\CC2430DB\..\..\..\..\.. #
#                          \COMPONENTS\OSAL\MCU\CCSOC\" -I "C:\Texas          #
#                          Instruments\ZStack-1.4.3-1.2.1\Projects\zstack\Sam #
#                          ples\cc2430-zstack-adxl345\CC2430DB\..\..\..\..\.. #
#                          \COMPONENTS\OSAL\INCLUDE\" -I "C:\Texas            #
#                          Instruments\ZStack-1.4.3-1.2.1\Projects\zstack\Sam #
#                          ples\cc2430-zstack-adxl345\CC2430DB\..\..\..\..\.. #
#                          \COMPONENTS\STACK\AF\" -I "C:\Texas                #
#                          Instruments\ZStack-1.4.3-1.2.1\Projects\zstack\Sam #
#                          ples\cc2430-zstack-adxl345\CC2430DB\..\..\..\..\.. #
#                          \COMPONENTS\STACK\NWK\" -I "C:\Texas               #
#                          Instruments\ZStack-1.4.3-1.2.1\Projects\zstack\Sam #
#                          ples\cc2430-zstack-adxl345\CC2430DB\..\..\..\..\.. #
#                          \COMPONENTS\STACK\SEC\" -I "C:\Texas               #
#                          Instruments\ZStack-1.4.3-1.2.1\Projects\zstack\Sam #
#                          ples\cc2430-zstack-adxl345\CC2430DB\..\..\..\..\.. #
#                          \COMPONENTS\STACK\SYS\" -I "C:\Texas               #
#                          Instruments\ZStack-1.4.3-1.2.1\Projects\zstack\Sam #
#                          ples\cc2430-zstack-adxl345\CC2430DB\..\..\..\..\.. #
#                          \COMPONENTS\STACK\ZDO\" -I "C:\Texas               #
#                          Instruments\ZStack-1.4.3-1.2.1\Projects\zstack\Sam #
#                          ples\cc2430-zstack-adxl345\CC2430DB\..\..\..\..\.. #
#                          \COMPONENTS\ZMAC\F8W\" -I "C:\Texas                #
#                          Instruments\ZStack-1.4.3-1.2.1\Projects\zstack\Sam #
#                          ples\cc2430-zstack-adxl345\CC2430DB\..\..\..\..\.. #
#                          \COMPONENTS\ZMAC\" -I "C:\Texas                    #
#                          Instruments\ZStack-1.4.3-1.2.1\Projects\zstack\Sam #
#                          ples\cc2430-zstack-adxl345\CC2430DB\..\..\..\..\.. #
#                          \COMPONENTS\SERVICES\SADDR\" -I "C:\Texas          #
#                          Instruments\ZStack-1.4.3-1.2.1\Projects\zstack\Sam #
#                          ples\cc2430-zstack-adxl345\CC2430DB\..\..\..\..\.. #
#                          \COMPONENTS\SERVICES\SDATA\" -I "C:\Texas          #
#                          Instruments\ZStack-1.4.3-1.2.1\Projects\zstack\Sam #
#                          ples\cc2430-zstack-adxl345\CC2430DB\..\..\..\..\.. #
#                          \COMPONENTS\MAC\INCLUDE\" -I "C:\Texas             #
#                          Instruments\ZStack-1.4.3-1.2.1\Projects\zstack\Sam #
#                          ples\cc2430-zstack-adxl345\CC2430DB\..\..\..\..\.. #
#                          \COMPONENTS\MAC\HIGH_LEVEL\" -I "C:\Texas          #
#                          Instruments\ZStack-1.4.3-1.2.1\Projects\zstack\Sam #
#                          ples\cc2430-zstack-adxl345\CC2430DB\..\..\..\..\.. #
#                          \COMPONENTS\MAC\LOW_LEVEL\SRF03\" -I "C:\Texas     #
#                          Instruments\ZStack-1.4.3-1.2.1\Projects\zstack\Sam #
#                          ples\cc2430-zstack-adxl345\CC2430DB\..\..\..\..\.. #
#                          \COMPONENTS\MAC\LOW_LEVEL\SRF03\SINGLE_CHIP\" -I   #
#                          "C:\Program Files\IAR Systems\Embedded Workbench   #
#                          4.0 Evaluation version\8051\INC\" -I "C:\Program   #
#                          Files\IAR Systems\Embedded Workbench 4.0           #
#                          Evaluation version\8051\INC\CLIB\"                 #
#    List file          =  C:\Texas Instruments\ZStack-1.4.3-1.2.1\Projects\z #
#                          stack\Samples\cc2430-zstack-adxl345\CC2430DB\EndDe #
#                          viceEB3\List\ZDObject.lst                          #
#    Object file        =  C:\Texas Instruments\ZStack-1.4.3-1.2.1\Projects\z #
#                          stack\Samples\cc2430-zstack-adxl345\CC2430DB\EndDe #
#                          viceEB3\Obj\ZDObject.r51                           #
#                                                                             #
#                                                                             #
###############################################################################

C:\Texas Instruments\ZStack-1.4.3-1.2.1\Components\stack\zdo\ZDObject.c
      1          /**************************************************************************************************
      2            Filename:       ZDObject.c
      3            Revised:        $Date: 2007-11-27 10:58:37 -0800 (Tue, 27 Nov 2007) $
      4            Revision:       $Revision: 15969 $
      5          
      6            Description:    This is the Zigbee Device Object.
      7          
      8          
      9            Copyright 2004-2007 Texas Instruments Incorporated. All rights reserved.
     10          
     11            IMPORTANT: Your use of this Software is limited to those specific rights
     12            granted under the terms of a software license agreement between the user
     13            who downloaded the software, his/her employer (which must be your employer)
     14            and Texas Instruments Incorporated (the "License").  You may not use this
     15            Software unless you agree to abide by the terms of the License. The License
     16            limits your use, and you acknowledge, that the Software may not be modified,
     17            copied or distributed unless embedded on a Texas Instruments microcontroller
     18            or used solely and exclusively in conjunction with a Texas Instruments radio
     19            frequency transceiver, which is integrated into your product.  Other than for
     20            the foregoing purpose, you may not use, reproduce, copy, prepare derivative
     21            works of, modify, distribute, perform, display or sell this Software and/or
     22            its documentation for any purpose.
     23          
     24            YOU FURTHER ACKNOWLEDGE AND AGREE THAT THE SOFTWARE AND DOCUMENTATION ARE
     25            PROVIDED “AS IS” WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESS OR IMPLIED,
     26            INCLUDING WITHOUT LIMITATION, ANY WARRANTY OF MERCHANTABILITY, TITLE,
     27            NON-INFRINGEMENT AND FITNESS FOR A PARTICULAR PURPOSE. IN NO EVENT SHALL
     28            TEXAS INSTRUMENTS OR ITS LICENSORS BE LIABLE OR OBLIGATED UNDER CONTRACT,
     29            NEGLIGENCE, STRICT LIABILITY, CONTRIBUTION, BREACH OF WARRANTY, OR OTHER
     30            LEGAL EQUITABLE THEORY ANY DIRECT OR INDIRECT DAMAGES OR EXPENSES
     31            INCLUDING BUT NOT LIMITED TO ANY INCIDENTAL, SPECIAL, INDIRECT, PUNITIVE
     32            OR CONSEQUENTIAL DAMAGES, LOST PROFITS OR LOST DATA, COST OF PROCUREMENT
     33            OF SUBSTITUTE GOODS, TECHNOLOGY, SERVICES, OR ANY CLAIMS BY THIRD PARTIES
     34            (INCLUDING BUT NOT LIMITED TO ANY DEFENSE THEREOF), OR OTHER SIMILAR COSTS.
     35          
     36            Should you have any questions regarding your right to use this Software,
     37            contact Texas Instruments Incorporated at www.TI.com.
     38          **************************************************************************************************/
     39          
     40          /*********************************************************************
     41           * INCLUDES
     42           */
     43          #include "ZComdef.h"
     44          #include "OSAL.h"
     45          #include "OSAL_Nv.h"
     46          #include "rtg.h"
     47          #include "NLMEDE.h"
     48          #include "nwk_globals.h"
     49          #include "APS.h"
     50          #include "APSMEDE.h"
     51          #include "AssocList.h"
     52          #include "BindingTable.h"
     53          #include "AddrMgr.h"
     54          #include "AF.h"
     55          #include "ZDObject.h"
     56          #include "ZDProfile.h"
     57          #include "ZDConfig.h"
     58          #include "ZDSecMgr.h"
     59          #include "ZDApp.h"
     60          #include "nwk_util.h"   // NLME_IsAddressBroadcast()
     61          #include "ZGlobals.h"
     62          
     63          #if defined( LCD_SUPPORTED )
     64            #include "OnBoard.h"
     65          #endif
     66          
     67          /* HAL */
     68          #include "hal_lcd.h"
     69          
     70          /*********************************************************************
     71           * MACROS
     72           */
     73          
     74          /*********************************************************************
     75           * CONSTANTS
     76           */
     77          // NLME Stub Implementations
     78          #define ZDO_ProcessMgmtPermitJoinTimeout NLME_PermitJoiningTimeout
     79          
     80          // Status fields used by ZDO_ProcessMgmtRtgReq
     81          #define ZDO_MGMT_RTG_ENTRY_ACTIVE             0x00
     82          #define ZDO_MGMT_RTG_ENTRY_DISCOVERY_UNDERWAY 0x01
     83          #define ZDO_MGMT_RTG_ENTRY_DISCOVERY_FAILED   0x02
     84          #define ZDO_MGMT_RTG_ENTRY_INACTIVE           0x03
     85          
     86          #if !defined( CACHE_EP_MAX )
     87            #define CACHE_EP_MAX  15
     88          #endif
     89          
     90          /*********************************************************************
     91           * TYPEDEFS
     92           */
     93          #if defined ( REFLECTOR )
     94          typedef struct
     95          {
     96            byte SrcTransSeq;
     97            zAddrType_t SrcAddr;
     98            uint16 LocalCoordinator;
     99            byte epIntf;
    100            uint16 ProfileID;
    101            byte numInClusters;
    102            uint16 *inClusters;
    103            byte numOutClusters;
    104            uint16 *outClusters;
    105            byte SecurityUse;
    106            byte status;
    107          } ZDO_EDBind_t;
    108          #endif // defined ( REFLECTOR )
    109          
    110          #if defined ( ZDO_COORDINATOR )
    111          enum
    112          {
    113            ZDMATCH_INIT,           // Initialized
    114            ZDMATCH_WAIT_REQ,       // Received first request, waiting for second
    115            ZDMATCH_SENDING_BINDS   // Received both requests, sending unbind/binds
    116          };
    117          
    118          enum
    119          {
    120            ZDMATCH_SENDING_NOT,
    121            ZDMATCH_SENDING_UNBIND,
    122            ZDMATCH_SENDING_BIND
    123          };
    124          #endif
    125          
    126          /*********************************************************************
    127           * GLOBAL VARIABLES
    128           */
    129          #if defined ( ZDO_COORDINATOR )
    130            ZDMatchEndDeviceBind_t *matchED = (ZDMatchEndDeviceBind_t *)NULL;
    131          #endif
    132          
    133          /*********************************************************************
    134           * EXTERNAL VARIABLES
    135           */
    136          
    137          /*********************************************************************
    138           * EXTERNAL FUNCTIONS
    139           */
    140          
    141          /*********************************************************************
    142           * LOCAL VARIABLES
    143           */

   \                                 In  segment XDATA_Z, align 1, keep-with-next
    144          static uint16 ZDOBuildBuf[26];  // temp area to build data without allocation
   \                     ZDOBuildBuf:
   \   000000                DS 52
   \   000034                REQUIRE __INIT_XDATA_Z
    145          
    146          #if defined ( REFLECTOR )

   \                                 In  segment XDATA_Z, align 1, keep-with-next
    147          static ZDO_EDBind_t *ZDO_EDBind;     // Null when not used
   \                     ZDO_EDBind:
   \   000000                DS 2
   \   000002                REQUIRE __INIT_XDATA_Z
    148          #endif
    149          
    150          #if defined ( MANAGED_SCAN )
    151            uint32 managedScanNextChannel = 0;
    152            uint32 managedScanChannelMask = 0;
    153            uint8  managedScanTimesPerChannel = 0;
    154          #endif
    155          
    156          /*********************************************************************
    157           * LOCAL FUNCTIONS
    158           */
    159          static void ZDODeviceSetup( void );
    160          #if defined ( MANAGED_SCAN )
    161            static void ZDOManagedScan_Next( void );
    162          #endif
    163          #if defined ( REFLECTOR )
    164            static void ZDO_RemoveEndDeviceBind( void );
    165            static void ZDO_SendEDBindRsp( byte TransSeq, zAddrType_t *dstAddr, byte Status, byte secUse );
    166          #endif
    167          #if defined ( ZDO_COORDINATOR )
    168            static byte ZDO_CompareClusterLists( byte numList1, uint16 *list1,
    169                                          byte numList2, uint16 *list2, uint16 *pMatches );
    170          #endif
    171          #if defined ( ZDO_COORDINATOR )
    172            static void ZDO_RemoveMatchMemory( void );
    173            static uint8 ZDO_CopyMatchInfo( ZDEndDeviceBind_t *destReq, ZDEndDeviceBind_t *srcReq );
    174            static void ZDO_EndDeviceBindMatchTimeoutCB( void );
    175          #endif
    176          uint8 *ZDO_ConvertOTAClusters( uint8 cnt, uint8 *inBuf, uint16 *outList );
    177          
    178          /*********************************************************************
    179           * @fn          ZDO_Init
    180           *
    181           * @brief       ZDObject and ZDProfile initialization.
    182           *
    183           * @param       none
    184           *
    185           * @return      none
    186           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    187          void ZDO_Init( void )
   \                     ZDO_Init:
    188          {
   \   000000   C082         PUSH    DPL
   \   000002   C083         PUSH    DPH
   \   000004                ; Saved register size: 2
   \   000004                ; Auto size: 0
    189            // Initialize ZD items
    190            #if defined ( REFLECTOR )
    191            ZDO_EDBind = NULL;
   \   000004   90....       MOV     DPTR,#ZDO_EDBind
   \   000007   7400         MOV     A,#0x0
   \   000009   F0           MOVX    @DPTR,A
   \   00000A   A3           INC     DPTR
   \   00000B   7400         MOV     A,#0x0
   \   00000D   F0           MOVX    @DPTR,A
    192            #endif
    193          
    194            // Setup the device - type of device to create.
    195            ZDODeviceSetup();
   \   00000E                ; Setup parameters for call to function ZDODeviceSetup
   \   00000E   12....       LCALL   ??ZDODeviceSetup?relay
    196          }
   \   000011   D083         POP     DPH
   \   000013   D082         POP     DPL
   \   000015   02....       LJMP    ?BRET
    197          
    198          #if defined ( MANAGED_SCAN )
    199          /*********************************************************************
    200           * @fn      ZDOManagedScan_Next()
    201           *
    202           * @brief   Setup a managed scan.
    203           *
    204           * @param   none
    205           *
    206           * @return  none
    207           */
    208          static void ZDOManagedScan_Next( void )
    209          {
    210            // Is it the first time
    211            if ( managedScanNextChannel == 0 && managedScanTimesPerChannel == 0 )
    212            {
    213              // Setup the defaults
    214              managedScanNextChannel  = 1;
    215          
    216              while( managedScanNextChannel && (zgDefaultChannelList & managedScanNextChannel) == 0 )
    217                managedScanNextChannel <<= 1;
    218          
    219              managedScanChannelMask = managedScanNextChannel;
    220              managedScanTimesPerChannel = MANAGEDSCAN_TIMES_PRE_CHANNEL;
    221            }
    222            else
    223            {
    224              // Do we need to go to the next channel
    225              if ( managedScanTimesPerChannel == 0 )
    226              {
    227                // Find next active channel
    228                managedScanChannelMask  = managedScanNextChannel;
    229                managedScanTimesPerChannel = MANAGEDSCAN_TIMES_PRE_CHANNEL;
    230              }
    231              else
    232              {
    233                managedScanTimesPerChannel--;
    234          
    235                if ( managedScanTimesPerChannel == 0 )
    236                {
    237                  managedScanNextChannel  <<= 1;
    238                  while( managedScanNextChannel && (zgDefaultChannelList & managedScanNextChannel) == 0 )
    239                    managedScanNextChannel <<= 1;
    240          
    241                  if ( managedScanNextChannel == 0 )
    242                    zdoDiscCounter  = NUM_DISC_ATTEMPTS + 1; // Stop
    243                }
    244              }
    245            }
    246          }
    247          #endif // MANAGED_SCAN
    248          
    249          /*********************************************************************
    250           * @fn      ZDODeviceSetup()
    251           *
    252           * @brief   Call set functions depending on the type of device compiled.
    253           *
    254           * @param   none
    255           *
    256           * @return  none
    257           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    258          static void ZDODeviceSetup( void )
   \                     ZDODeviceSetup:
    259          {
   \   000000   C082         PUSH    DPL
   \   000002   C083         PUSH    DPH
   \   000004                ; Saved register size: 2
   \   000004                ; Auto size: 0
    260          #if defined( ZDO_COORDINATOR )
    261            NLME_CoordinatorInit();
    262          #endif
    263          
    264          #if defined ( REFLECTOR )
    265            #if defined ( ZDO_COORDINATOR )
    266              APS_ReflectorInit( APS_REFLECTOR_PUBLIC );
    267            #else
    268              APS_ReflectorInit( APS_REFLECTOR_PRIVATE );
   \   000004                ; Setup parameters for call to function APS_ReflectorInit
   \   000004   7901         MOV     R1,#0x1
   \   000006   12....       LCALL   ??APS_ReflectorInit?relay
    269            #endif
    270          #endif
    271          
    272          #if !defined( ZDO_COORDINATOR ) || defined( SOFT_START )
    273            NLME_DeviceJoiningInit();
   \   000009                ; Setup parameters for call to function NLME_DeviceJoiningInit
   \   000009   12....       LCALL   ??NLME_DeviceJoiningInit?relay
    274          #endif
    275          }
   \   00000C   D083         POP     DPH
   \   00000E   D082         POP     DPL
   \   000010   02....       LJMP    ?BRET
    276          
    277          /*********************************************************************
    278           * @fn          ZDO_StartDevice
    279           *
    280           * @brief       This function starts a device in a network.
    281           *
    282           * @param       logicalType     - Device type to start
    283           *              startMode       - indicates mode of device startup
    284           *              beaconOrder     - indicates time betwen beacons
    285           *              superframeOrder - indicates length of active superframe
    286           *
    287           * @return      none
    288           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    289          void ZDO_StartDevice( byte logicalType, devStartModes_t startMode, byte beaconOrder, byte superframeOrder )
   \                     ZDO_StartDevice:
    290          {
   \   000000   74F1         MOV     A,#-0xf
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 15
   \   000005                ; Auto size: 11
   \   000005   74F5         MOV     A,#-0xb
   \   000007   12....       LCALL   ?ALLOC_XSTACK8
   \   00000A   89..         MOV     ?V0 + 4,R1
   \   00000C   EA           MOV     A,R2
   \   00000D   FF           MOV     R7,A
    291            ZStatus_t ret;
    292          
    293            ret = ZUnsupportedMode;
   \   00000E   7E12         MOV     R6,#0x12
    294          
    295          #if defined(ZDO_COORDINATOR)
    296            if ( logicalType == NODETYPE_COORDINATOR )
    297            {
    298              if ( startMode == MODE_HARD )
    299              {
    300                devState = DEV_COORD_STARTING;
    301                ret = NLME_NetworkFormationRequest( zgConfigPANID, zgDefaultChannelList,
    302                                                    zgDefaultStartingScanDuration, beaconOrder,
    303                                                    superframeOrder, false );
    304              }
    305              else if ( startMode == MODE_RESUME )
    306              {
    307                // Just start the coordinator
    308                devState = DEV_COORD_STARTING;
    309                ret = NLME_StartRouterRequest( beaconOrder, beaconOrder, false );
    310              }
    311              else
    312              {
    313          #if defined( LCD_SUPPORTED )
    314                HalLcdWriteScreen( "StartDevice ERR", "MODE unknown" );
    315          #endif
    316              }
    317            }
    318          #endif  // !ZDO_COORDINATOR
    319          
    320          #if !defined ( ZDO_COORDINATOR ) || defined( SOFT_START )
    321            if ( logicalType == NODETYPE_ROUTER || logicalType == NODETYPE_DEVICE )
   \   000010   7401         MOV     A,#0x1
   \   000012   65..         XRL     A,?V0 + 4
   \   000014   6009         JZ      ??ZDO_StartDevice_0
   \   000016   7402         MOV     A,#0x2
   \   000018   65..         XRL     A,?V0 + 4
   \   00001A   6003         JZ      $+5
   \   00001C   02....       LJMP    ??ZDO_StartDevice_1 & 0xFFFF
    322            {
    323              if ( (startMode == MODE_JOIN) || (startMode == MODE_REJOIN) )
   \                     ??ZDO_StartDevice_0:
   \   00001F   EF           MOV     A,R7
   \   000020   6005         JZ      ??ZDO_StartDevice_2
   \   000022   7403         MOV     A,#0x3
   \   000024   6F           XRL     A,R7
   \   000025   7023         JNZ     ??ZDO_StartDevice_3
    324              {
    325                devState = DEV_NWK_DISC;
   \                     ??ZDO_StartDevice_2:
   \   000027   7402         MOV     A,#0x2
   \   000029   90....       MOV     DPTR,#devState
   \   00002C   F0           MOVX    @DPTR,A
    326          
    327            #if defined( MANAGED_SCAN )
    328                ZDOManagedScan_Next();
    329                ret = NLME_NetworkDiscoveryRequest( managedScanChannelMask, BEACON_ORDER_15_MSEC );
    330            #else
    331                ret = NLME_NetworkDiscoveryRequest( zgDefaultChannelList, zgDefaultStartingScanDuration );
   \   00002D                ; Setup parameters for call to function NLME_NetworkDiscoveryRequest
   \   00002D   90....       MOV     DPTR,#zgDefaultStartingScanDuration
   \   000030   E0           MOVX    A,@DPTR
   \   000031   F9           MOV     R1,A
   \   000032   90....       MOV     DPTR,#zgDefaultChannelList
   \   000035   78..         MOV     R0,#?V0 + 0
   \   000037   12....       LCALL   ?L_MOV_X
   \   00003A   AA..         MOV     R2,?V0 + 0
   \   00003C   AB..         MOV     R3,?V0 + 1
   \   00003E   AC..         MOV     R4,?V0 + 2
   \   000040   AD..         MOV     R5,?V0 + 3
   \   000042   12....       LCALL   ??NLME_NetworkDiscoveryRequest?relay
   \   000045   E9           MOV     A,R1
   \   000046   FE           MOV     R6,A
   \   000047   02....       LJMP    ??ZDO_StartDevice_1 & 0xFFFF
    332            #endif
    333              }
    334              else if ( startMode == MODE_RESUME )
   \                     ??ZDO_StartDevice_3:
   \   00004A   7401         MOV     A,#0x1
   \   00004C   6F           XRL     A,R7
   \   00004D   707D         JNZ     ??ZDO_StartDevice_1
    335              {
    336                if ( logicalType == NODETYPE_ROUTER )
   \   00004F   7401         MOV     A,#0x1
   \   000051   65..         XRL     A,?V0 + 4
   \   000053   7057         JNZ     ??ZDO_StartDevice_4
    337                {
    338                  ZMacScanCnf_t scanCnf;
    339                  devState = DEV_NWK_ORPHAN;
   \   000055   740A         MOV     A,#0xa
   \   000057   90....       MOV     DPTR,#devState
   \   00005A   F0           MOVX    @DPTR,A
    340          
    341                  /* if router and nvram is available, fake successful orphan scan */
    342                  scanCnf.hdr.Status = ZSUCCESS;
   \   00005B   7400         MOV     A,#0x0
   \   00005D   C0E0         PUSH    A
   \   00005F   7401         MOV     A,#0x1
   \   000061   12....       LCALL   ?XSTACK_DISP0_8
   \   000064   D0E0         POP     A
   \   000066   F0           MOVX    @DPTR,A
    343                  scanCnf.ScanType = ZMAC_ORPHAN_SCAN;
   \   000067   7403         MOV     A,#0x3
   \   000069   C0E0         PUSH    A
   \   00006B   7402         MOV     A,#0x2
   \   00006D   12....       LCALL   ?XSTACK_DISP0_8
   \   000070   D0E0         POP     A
   \   000072   F0           MOVX    @DPTR,A
    344                  scanCnf.UnscannedChannels = 0;
   \   000073   90....       MOV     DPTR,#__Constant_0
   \   000076   78..         MOV     R0,#?V0 + 0
   \   000078   12....       LCALL   ?L_MOV_X
   \   00007B   7404         MOV     A,#0x4
   \   00007D   12....       LCALL   ?XSTACK_DISP0_8
   \   000080   E5..         MOV     A,?V0 + 0
   \   000082   F0           MOVX    @DPTR,A
   \   000083   A3           INC     DPTR
   \   000084   E5..         MOV     A,?V0 + 1
   \   000086   F0           MOVX    @DPTR,A
   \   000087   A3           INC     DPTR
   \   000088   E5..         MOV     A,?V0 + 2
   \   00008A   F0           MOVX    @DPTR,A
   \   00008B   A3           INC     DPTR
   \   00008C   E5..         MOV     A,?V0 + 3
   \   00008E   F0           MOVX    @DPTR,A
    345                  scanCnf.ResultListSize = 0;
   \   00008F   7400         MOV     A,#0x0
   \   000091   C0E0         PUSH    A
   \   000093   7408         MOV     A,#0x8
   \   000095   12....       LCALL   ?XSTACK_DISP0_8
   \   000098   D0E0         POP     A
   \   00009A   F0           MOVX    @DPTR,A
    346                  nwk_ScanJoiningOrphan(&scanCnf);
   \   00009B                ; Setup parameters for call to function nwk_ScanJoiningOrphan
   \   00009B   85..82       MOV     DPL,?XSP + 0
   \   00009E   85..83       MOV     DPH,?XSP + 1
   \   0000A1   AA82         MOV     R2,DPL
   \   0000A3   AB83         MOV     R3,DPH
   \   0000A5   12....       LCALL   ??nwk_ScanJoiningOrphan?relay
    347          
    348                  ret = ZSuccess;
   \   0000A8   7E00         MOV     R6,#0x0
   \   0000AA   8020         SJMP    ??ZDO_StartDevice_1
    349                }
    350                else
    351                {
    352                  devState = DEV_NWK_ORPHAN;
   \                     ??ZDO_StartDevice_4:
   \   0000AC   740A         MOV     A,#0xa
   \   0000AE   90....       MOV     DPTR,#devState
   \   0000B1   F0           MOVX    @DPTR,A
    353                  ret = NLME_OrphanJoinRequest( zgDefaultChannelList,
    354                                                zgDefaultStartingScanDuration );
   \   0000B2                ; Setup parameters for call to function NLME_OrphanJoinRequest
   \   0000B2   90....       MOV     DPTR,#zgDefaultStartingScanDuration
   \   0000B5   E0           MOVX    A,@DPTR
   \   0000B6   F9           MOV     R1,A
   \   0000B7   90....       MOV     DPTR,#zgDefaultChannelList
   \   0000BA   78..         MOV     R0,#?V0 + 0
   \   0000BC   12....       LCALL   ?L_MOV_X
   \   0000BF   AA..         MOV     R2,?V0 + 0
   \   0000C1   AB..         MOV     R3,?V0 + 1
   \   0000C3   AC..         MOV     R4,?V0 + 2
   \   0000C5   AD..         MOV     R5,?V0 + 3
   \   0000C7   12....       LCALL   ??NLME_OrphanJoinRequest?relay
   \   0000CA   E9           MOV     A,R1
   \   0000CB   FE           MOV     R6,A
    355                }
    356              }
    357              else
    358              {
    359          #if defined( LCD_SUPPORTED )
    360                HalLcdWriteScreen( "StartDevice ERR", "MODE unknown" );
    361          #endif
    362              }
    363            }
    364          #endif  //!ZDO COORDINATOR || SOFT_START
    365          
    366            if ( ret != ZSuccess )
   \                     ??ZDO_StartDevice_1:
   \   0000CC   EE           MOV     A,R6
   \   0000CD   6010         JZ      ??ZDO_StartDevice_5
    367              osal_start_timerEx(ZDAppTaskID, ZDO_NETWORK_INIT, NWK_RETRY_DELAY );
   \   0000CF                ; Setup parameters for call to function osal_start_timerEx
   \   0000CF   7CE8         MOV     R4,#-0x18
   \   0000D1   7D03         MOV     R5,#0x3
   \   0000D3   7A01         MOV     R2,#0x1
   \   0000D5   7B00         MOV     R3,#0x0
   \   0000D7   90....       MOV     DPTR,#ZDAppTaskID
   \   0000DA   E0           MOVX    A,@DPTR
   \   0000DB   F9           MOV     R1,A
   \   0000DC   12....       LCALL   ??osal_start_timerEx?relay
    368          }
   \                     ??ZDO_StartDevice_5:
   \   0000DF   740B         MOV     A,#0xb
   \   0000E1   12....       LCALL   ?DEALLOC_XSTACK8
   \   0000E4   7F07         MOV     R7,#0x7
   \   0000E6   02....       LJMP    ?BANKED_LEAVE_XDATA
    369          
    370          /*********************************************************************
    371           * @fn      ZDO_UpdateNwkStatus()
    372           *
    373           * @brief
    374           *
    375           *   This function will send an update message to each registered
    376           *   application endpoint/interface about a network status change.
    377           *
    378           * @param   none
    379           *
    380           * @return  none
    381           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    382          void ZDO_UpdateNwkStatus( devStates_t state )
   \                     ZDO_UpdateNwkStatus:
    383          {
   \   000000   74F2         MOV     A,#-0xe
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 14
   \   000005                ; Auto size: 0
   \   000005   89..         MOV     ?V0 + 3,R1
    384            // Endpoint/Interface descriptor list.
    385            epList_t *epDesc = epList;
   \   000007   90....       MOV     DPTR,#epList
   \   00000A   E0           MOVX    A,@DPTR
   \   00000B   F8           MOV     R0,A
   \   00000C   A3           INC     DPTR
   \   00000D   E0           MOVX    A,@DPTR
   \   00000E   F9           MOV     R1,A
   \   00000F   E8           MOV     A,R0
   \   000010   FE           MOV     R6,A
   \   000011   E9           MOV     A,R1
   \   000012   FF           MOV     R7,A
    386            byte bufLen = sizeof(osal_event_hdr_t);
   \   000013   75..02       MOV     ?V0 + 2,#0x2
    387            osal_event_hdr_t *msgPtr;
    388          
    389            ZDAppNwkAddr.addr.shortAddr = NLME_GetShortAddr();
   \   000016                ; Setup parameters for call to function NLME_GetShortAddr
   \   000016   12....       LCALL   ??NLME_GetShortAddr?relay
   \   000019   90....       MOV     DPTR,#ZDAppNwkAddr
   \   00001C   EA           MOV     A,R2
   \   00001D   F0           MOVX    @DPTR,A
   \   00001E   A3           INC     DPTR
   \   00001F   EB           MOV     A,R3
   \   000020   F0           MOVX    @DPTR,A
    390            (void)NLME_GetExtAddr();  // Load the saveExtAddr pointer.
   \   000021                ; Setup parameters for call to function NLME_GetExtAddr
   \   000021   12....       LCALL   ??NLME_GetExtAddr?relay
    391          
    392            while ( epDesc )
   \                     ??ZDO_UpdateNwkStatus_0:
   \   000024   EE           MOV     A,R6
   \   000025   6400         XRL     A,#0x0
   \   000027   7003         JNZ     ??ZDO_UpdateNwkStatus_1
   \   000029   EF           MOV     A,R7
   \   00002A   6400         XRL     A,#0x0
   \                     ??ZDO_UpdateNwkStatus_1:
   \   00002C   6071         JZ      ??ZDO_UpdateNwkStatus_2
    393            {
    394              if ( epDesc->epDesc->endPoint != ZDO_EP )
   \   00002E   8E82         MOV     DPL,R6
   \   000030   8F83         MOV     DPH,R7
   \   000032   E0           MOVX    A,@DPTR
   \   000033   F8           MOV     R0,A
   \   000034   A3           INC     DPTR
   \   000035   E0           MOVX    A,@DPTR
   \   000036   F583         MOV     DPH,A
   \   000038   8882         MOV     DPL,R0
   \   00003A   E0           MOVX    A,@DPTR
   \   00003B   6052         JZ      ??ZDO_UpdateNwkStatus_3
    395              {
    396                msgPtr = (osal_event_hdr_t *)osal_msg_allocate( bufLen );
   \   00003D                ; Setup parameters for call to function osal_msg_allocate
   \   00003D   E5..         MOV     A,?V0 + 2
   \   00003F   F5..         MOV     ?V0 + 4,A
   \   000041   AA..         MOV     R2,?V0 + 4
   \   000043   7B00         MOV     R3,#0x0
   \   000045   12....       LCALL   ??osal_msg_allocate?relay
   \   000048   8A..         MOV     ?V0 + 4,R2
   \   00004A   8B..         MOV     ?V0 + 5,R3
   \   00004C   85....       MOV     ?V0 + 0,?V0 + 4
   \   00004F   85....       MOV     ?V0 + 1,?V0 + 5
    397                if ( msgPtr )
   \   000052   E5..         MOV     A,?V0 + 0
   \   000054   6400         XRL     A,#0x0
   \   000056   7004         JNZ     ??ZDO_UpdateNwkStatus_4
   \   000058   E5..         MOV     A,?V0 + 1
   \   00005A   6400         XRL     A,#0x0
   \                     ??ZDO_UpdateNwkStatus_4:
   \   00005C   6031         JZ      ??ZDO_UpdateNwkStatus_3
    398                {
    399                  msgPtr->event = ZDO_STATE_CHANGE; // Command ID
   \   00005E   74D1         MOV     A,#-0x2f
   \   000060   85..82       MOV     DPL,?V0 + 0
   \   000063   85..83       MOV     DPH,?V0 + 1
   \   000066   F0           MOVX    @DPTR,A
    400                  msgPtr->status = (byte)state;
   \   000067   85..82       MOV     DPL,?V0 + 0
   \   00006A   85..83       MOV     DPH,?V0 + 1
   \   00006D   A3           INC     DPTR
   \   00006E   E5..         MOV     A,?V0 + 3
   \   000070   F0           MOVX    @DPTR,A
    401          
    402                  osal_msg_send( *(epDesc->epDesc->task_id), (byte *)msgPtr );
   \   000071                ; Setup parameters for call to function osal_msg_send
   \   000071   AA..         MOV     R2,?V0 + 0
   \   000073   AB..         MOV     R3,?V0 + 1
   \   000075   8E82         MOV     DPL,R6
   \   000077   8F83         MOV     DPH,R7
   \   000079   E0           MOVX    A,@DPTR
   \   00007A   F8           MOV     R0,A
   \   00007B   A3           INC     DPTR
   \   00007C   E0           MOVX    A,@DPTR
   \   00007D   F583         MOV     DPH,A
   \   00007F   8882         MOV     DPL,R0
   \   000081   A3           INC     DPTR
   \   000082   E0           MOVX    A,@DPTR
   \   000083   F8           MOV     R0,A
   \   000084   A3           INC     DPTR
   \   000085   E0           MOVX    A,@DPTR
   \   000086   F583         MOV     DPH,A
   \   000088   8882         MOV     DPL,R0
   \   00008A   E0           MOVX    A,@DPTR
   \   00008B   F9           MOV     R1,A
   \   00008C   12....       LCALL   ??osal_msg_send?relay
    403                }
    404              }
    405              epDesc = epDesc->nextDesc;
   \                     ??ZDO_UpdateNwkStatus_3:
   \   00008F   8E82         MOV     DPL,R6
   \   000091   8F83         MOV     DPH,R7
   \   000093   A3           INC     DPTR
   \   000094   A3           INC     DPTR
   \   000095   A3           INC     DPTR
   \   000096   A3           INC     DPTR
   \   000097   A3           INC     DPTR
   \   000098   E0           MOVX    A,@DPTR
   \   000099   FE           MOV     R6,A
   \   00009A   A3           INC     DPTR
   \   00009B   E0           MOVX    A,@DPTR
   \   00009C   FF           MOV     R7,A
   \   00009D   8085         SJMP    ??ZDO_UpdateNwkStatus_0
    406            }
    407          }
   \                     ??ZDO_UpdateNwkStatus_2:
   \   00009F   7F06         MOV     R7,#0x6
   \   0000A1   02....       LJMP    ?BANKED_LEAVE_XDATA
    408          
    409          #if defined ( REFLECTOR )
    410          /*********************************************************************
    411           * @fn          ZDO_RemoveEndDeviceBind
    412           *
    413           * @brief       Remove the end device bind
    414           *
    415           * @param  none
    416           *
    417           * @return      none
    418           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    419          static void ZDO_RemoveEndDeviceBind( void )
   \                     ZDO_RemoveEndDeviceBind:
    420          {
   \   000000   C082         PUSH    DPL
   \   000002   C083         PUSH    DPH
   \   000004                ; Saved register size: 2
   \   000004                ; Auto size: 0
    421            if ( ZDO_EDBind )
   \   000004   90....       MOV     DPTR,#ZDO_EDBind
   \   000007   E0           MOVX    A,@DPTR
   \   000008   6400         XRL     A,#0x0
   \   00000A   7004         JNZ     ??ZDO_RemoveEndDeviceBind_0
   \   00000C   A3           INC     DPTR
   \   00000D   E0           MOVX    A,@DPTR
   \   00000E   6400         XRL     A,#0x0
   \                     ??ZDO_RemoveEndDeviceBind_0:
   \   000010   607B         JZ      ??ZDO_RemoveEndDeviceBind_1
    422            {
    423              // Free the RAM
    424              if ( ZDO_EDBind->inClusters )
   \   000012   90....       MOV     DPTR,#ZDO_EDBind
   \   000015   E0           MOVX    A,@DPTR
   \   000016   2410         ADD     A,#0x10
   \   000018   F8           MOV     R0,A
   \   000019   A3           INC     DPTR
   \   00001A   E0           MOVX    A,@DPTR
   \   00001B   3400         ADDC    A,#0x0
   \   00001D   F9           MOV     R1,A
   \   00001E   8882         MOV     DPL,R0
   \   000020   8983         MOV     DPH,R1
   \   000022   E0           MOVX    A,@DPTR
   \   000023   6400         XRL     A,#0x0
   \   000025   7004         JNZ     ??ZDO_RemoveEndDeviceBind_2
   \   000027   A3           INC     DPTR
   \   000028   E0           MOVX    A,@DPTR
   \   000029   6400         XRL     A,#0x0
   \                     ??ZDO_RemoveEndDeviceBind_2:
   \   00002B   6018         JZ      ??ZDO_RemoveEndDeviceBind_3
    425                osal_mem_free( ZDO_EDBind->inClusters );
   \   00002D                ; Setup parameters for call to function osal_mem_free
   \   00002D   90....       MOV     DPTR,#ZDO_EDBind
   \   000030   E0           MOVX    A,@DPTR
   \   000031   2410         ADD     A,#0x10
   \   000033   F8           MOV     R0,A
   \   000034   A3           INC     DPTR
   \   000035   E0           MOVX    A,@DPTR
   \   000036   3400         ADDC    A,#0x0
   \   000038   F9           MOV     R1,A
   \   000039   8882         MOV     DPL,R0
   \   00003B   8983         MOV     DPH,R1
   \   00003D   E0           MOVX    A,@DPTR
   \   00003E   FA           MOV     R2,A
   \   00003F   A3           INC     DPTR
   \   000040   E0           MOVX    A,@DPTR
   \   000041   FB           MOV     R3,A
   \   000042   12....       LCALL   ??osal_mem_free?relay
    426              if ( ZDO_EDBind->outClusters )
   \                     ??ZDO_RemoveEndDeviceBind_3:
   \   000045   90....       MOV     DPTR,#ZDO_EDBind
   \   000048   E0           MOVX    A,@DPTR
   \   000049   2413         ADD     A,#0x13
   \   00004B   F8           MOV     R0,A
   \   00004C   A3           INC     DPTR
   \   00004D   E0           MOVX    A,@DPTR
   \   00004E   3400         ADDC    A,#0x0
   \   000050   F9           MOV     R1,A
   \   000051   8882         MOV     DPL,R0
   \   000053   8983         MOV     DPH,R1
   \   000055   E0           MOVX    A,@DPTR
   \   000056   6400         XRL     A,#0x0
   \   000058   7004         JNZ     ??ZDO_RemoveEndDeviceBind_4
   \   00005A   A3           INC     DPTR
   \   00005B   E0           MOVX    A,@DPTR
   \   00005C   6400         XRL     A,#0x0
   \                     ??ZDO_RemoveEndDeviceBind_4:
   \   00005E   6018         JZ      ??ZDO_RemoveEndDeviceBind_5
    427                osal_mem_free( ZDO_EDBind->outClusters );
   \   000060                ; Setup parameters for call to function osal_mem_free
   \   000060   90....       MOV     DPTR,#ZDO_EDBind
   \   000063   E0           MOVX    A,@DPTR
   \   000064   2413         ADD     A,#0x13
   \   000066   F8           MOV     R0,A
   \   000067   A3           INC     DPTR
   \   000068   E0           MOVX    A,@DPTR
   \   000069   3400         ADDC    A,#0x0
   \   00006B   F9           MOV     R1,A
   \   00006C   8882         MOV     DPL,R0
   \   00006E   8983         MOV     DPH,R1
   \   000070   E0           MOVX    A,@DPTR
   \   000071   FA           MOV     R2,A
   \   000072   A3           INC     DPTR
   \   000073   E0           MOVX    A,@DPTR
   \   000074   FB           MOV     R3,A
   \   000075   12....       LCALL   ??osal_mem_free?relay
    428              osal_mem_free( ZDO_EDBind );
   \                     ??ZDO_RemoveEndDeviceBind_5:
   \   000078                ; Setup parameters for call to function osal_mem_free
   \   000078   90....       MOV     DPTR,#ZDO_EDBind
   \   00007B   E0           MOVX    A,@DPTR
   \   00007C   FA           MOV     R2,A
   \   00007D   A3           INC     DPTR
   \   00007E   E0           MOVX    A,@DPTR
   \   00007F   FB           MOV     R3,A
   \   000080   12....       LCALL   ??osal_mem_free?relay
    429              ZDO_EDBind = NULL;
   \   000083   90....       MOV     DPTR,#ZDO_EDBind
   \   000086   7400         MOV     A,#0x0
   \   000088   F0           MOVX    @DPTR,A
   \   000089   A3           INC     DPTR
   \   00008A   7400         MOV     A,#0x0
   \   00008C   F0           MOVX    @DPTR,A
    430            }
    431          }
   \                     ??ZDO_RemoveEndDeviceBind_1:
   \   00008D   D083         POP     DPH
   \   00008F   D082         POP     DPL
   \   000091   02....       LJMP    ?BRET
    432          #endif // REFLECTOR
    433          
    434          #if defined ( REFLECTOR )
    435          /*********************************************************************
    436           * @fn          ZDO_RemoveEndDeviceBind
    437           *
    438           * @brief       Remove the end device bind
    439           *
    440           * @param  none
    441           *
    442           * @return      none
    443           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    444          static void ZDO_SendEDBindRsp( byte TransSeq, zAddrType_t *dstAddr, byte Status, byte secUse )
   \                     ZDO_SendEDBindRsp:
    445          {
   \   000000   74F5         MOV     A,#-0xb
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 11
   \   000005                ; Auto size: 2
   \   000005   74FE         MOV     A,#-0x2
   \   000007   12....       LCALL   ?ALLOC_XSTACK8
   \   00000A   E9           MOV     A,R1
   \   00000B   C0E0         PUSH    A
   \   00000D   7401         MOV     A,#0x1
   \   00000F   12....       LCALL   ?XSTACK_DISP0_8
   \   000012   D0E0         POP     A
   \   000014   F0           MOVX    @DPTR,A
   \   000015   EC           MOV     A,R4
   \   000016   85..82       MOV     DPL,?XSP + 0
   \   000019   85..83       MOV     DPH,?XSP + 1
   \   00001C   F0           MOVX    @DPTR,A
   \   00001D   EA           MOV     A,R2
   \   00001E   FE           MOV     R6,A
   \   00001F   EB           MOV     A,R3
   \   000020   FF           MOV     R7,A
   \   000021   8D..         MOV     ?V0 + 2,R5
    446            ZDP_EndDeviceBindRsp( TransSeq, dstAddr, Status, secUse );
   \   000023                ; Setup parameters for call to function ZDP_SendData
   \   000023   E5..         MOV     A,?V0 + 2
   \   000025   F5..         MOV     ?V0 + 0,A
   \   000027   78..         MOV     R0,#?V0 + 0
   \   000029   12....       LCALL   ?PUSH_XSTACK_I_ONE
   \   00002C   7401         MOV     A,#0x1
   \   00002E   12....       LCALL   ?XSTACK_DISP0_8
   \   000031   8582..       MOV     ?V0 + 0,DPL
   \   000034   8583..       MOV     ?V0 + 1,DPH
   \   000037   78..         MOV     R0,#?V0 + 0
   \   000039   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   00003C   75..20       MOV     ?V0 + 0,#0x20
   \   00003F   75..80       MOV     ?V0 + 1,#-0x80
   \   000042   78..         MOV     R0,#?V0 + 0
   \   000044   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   000047   7901         MOV     R1,#0x1
   \   000049   EE           MOV     A,R6
   \   00004A   FC           MOV     R4,A
   \   00004B   EF           MOV     A,R7
   \   00004C   FD           MOV     R5,A
   \   00004D   7406         MOV     A,#0x6
   \   00004F   12....       LCALL   ?XSTACK_DISP0_8
   \   000052   AA82         MOV     R2,DPL
   \   000054   AB83         MOV     R3,DPH
   \   000056   12....       LCALL   ??ZDP_SendData?relay
   \   000059   7405         MOV     A,#0x5
   \   00005B   12....       LCALL   ?DEALLOC_XSTACK8
    447          
    448          #if defined( LCD_SUPPORTED )
    449            HalLcdWriteString( "End Device Bind", HAL_LCD_LINE_1 );
    450            if ( Status == ZDP_SUCCESS )
    451              HalLcdWriteString( "Success Sent", HAL_LCD_LINE_2 );
    452            else
    453              HalLcdWriteString( "Timeout", HAL_LCD_LINE_2 );
    454          #endif
    455          
    456          }
   \   00005E   7402         MOV     A,#0x2
   \   000060   12....       LCALL   ?DEALLOC_XSTACK8
   \   000063   7F03         MOV     R7,#0x3
   \   000065   02....       LJMP    ?BANKED_LEAVE_XDATA
    457          #endif // REFLECTOR
    458          
    459          #if defined ( ZDO_COORDINATOR )
    460          /*********************************************************************
    461           * @fn          ZDO_CompareClusterLists
    462           *
    463           * @brief       Compare one list to another list
    464           *
    465           * @param       numList1 - number of items in list 1
    466           * @param       list1 - first list of cluster IDs
    467           * @param       numList2 - number of items in list 2
    468           * @param       list2 - second list of cluster IDs
    469           * @param       pMatches - buffer to put matches
    470           *
    471           * @return      number of matches
    472           */
    473          static byte ZDO_CompareClusterLists( byte numList1, uint16 *list1,
    474                                    byte numList2, uint16 *list2, uint16 *pMatches )
    475          {
    476            byte x, y;
    477            uint16 z;
    478            byte numMatches = 0;
    479          
    480            // Check the first in against the seconds out
    481            for ( x = 0; x < numList1; x++ )
    482            {
    483              for ( y = 0; y < numList2; y++ )
    484              {
    485                z = list2[y];
    486                if ( list1[x] == z )
    487                  pMatches[numMatches++] = z;
    488              }
    489            }
    490          
    491            return ( numMatches );
    492          }
    493          #endif // ZDO_COORDINATOR
    494          
    495          
    496          /*********************************************************************
    497           * Utility functions
    498           */
    499          
    500          /*********************************************************************
    501           * @fn          ZDO_CompareByteLists
    502           *
    503           * @brief       Compares two lists for matches.
    504           *
    505           * @param       ACnt  - number of entries in list A
    506           * @param       AList  - List A
    507           * @param       BCnt  - number of entries in list B
    508           * @param       BList  - List B
    509           *
    510           * @return      true if a match is found
    511           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    512          byte ZDO_AnyClusterMatches( byte ACnt, uint16 *AList, byte BCnt, uint16 *BList )
   \                     ZDO_AnyClusterMatches:
    513          {
   \   000000   74F3         MOV     A,#-0xd
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 13
   \   000005                ; Auto size: 0
   \   000005   89..         MOV     ?V0 + 0,R1
   \   000007   8C..         MOV     ?V0 + 1,R4
   \   000009   740D         MOV     A,#0xd
   \   00000B   12....       LCALL   ?XSTACK_DISP0_8
   \   00000E   E0           MOVX    A,@DPTR
   \   00000F   F8           MOV     R0,A
   \   000010   A3           INC     DPTR
   \   000011   E0           MOVX    A,@DPTR
   \   000012   F9           MOV     R1,A
   \   000013   E8           MOV     A,R0
   \   000014   FC           MOV     R4,A
   \   000015   E9           MOV     A,R1
   \   000016   FD           MOV     R5,A
    514            byte x, y;
    515          
    516            for ( x = 0; x < ACnt; x++ )
   \   000017   75..00       MOV     ?V0 + 3,#0x0
   \                     ??ZDO_AnyClusterMatches_0:
   \   00001A   E5..         MOV     A,?V0 + 3
   \   00001C   C3           CLR     C
   \   00001D   95..         SUBB    A,?V0 + 0
   \   00001F   506A         JNC     ??ZDO_AnyClusterMatches_1
    517            {
    518              for ( y = 0; y < BCnt; y++ )
   \   000021   75..00       MOV     ?V0 + 4,#0x0
   \                     ??ZDO_AnyClusterMatches_2:
   \   000024   E5..         MOV     A,?V0 + 4
   \   000026   C3           CLR     C
   \   000027   95..         SUBB    A,?V0 + 1
   \   000029   505C         JNC     ??ZDO_AnyClusterMatches_3
    519              {
    520                if ( AList[x] == BList[y] )
   \   00002B   A8..         MOV     R0,?V0 + 3
   \   00002D   7900         MOV     R1,#0x0
   \   00002F   E8           MOV     A,R0
   \   000030   75F002       MOV     B,#0x2
   \   000033   A4           MUL     AB
   \   000034   C8           XCH     A,R0
   \   000035   AEF0         MOV     R6,B
   \   000037   75F000       MOV     B,#0x0
   \   00003A   A4           MUL     AB
   \   00003B   2E           ADD     A,R6
   \   00003C   FE           MOV     R6,A
   \   00003D   75F002       MOV     B,#0x2
   \   000040   E9           MOV     A,R1
   \   000041   A4           MUL     AB
   \   000042   2E           ADD     A,R6
   \   000043   F9           MOV     R1,A
   \   000044   EA           MOV     A,R2
   \   000045   28           ADD     A,R0
   \   000046   F582         MOV     DPL,A
   \   000048   EB           MOV     A,R3
   \   000049   39           ADDC    A,R1
   \   00004A   F583         MOV     DPH,A
   \   00004C   E0           MOVX    A,@DPTR
   \   00004D   F8           MOV     R0,A
   \   00004E   A3           INC     DPTR
   \   00004F   E0           MOVX    A,@DPTR
   \   000050   F9           MOV     R1,A
   \   000051   AE..         MOV     R6,?V0 + 4
   \   000053   7F00         MOV     R7,#0x0
   \   000055   EE           MOV     A,R6
   \   000056   75F002       MOV     B,#0x2
   \   000059   A4           MUL     AB
   \   00005A   CE           XCH     A,R6
   \   00005B   85F0..       MOV     ?V0 + 2,B
   \   00005E   75F000       MOV     B,#0x0
   \   000061   A4           MUL     AB
   \   000062   25..         ADD     A,?V0 + 2
   \   000064   F5..         MOV     ?V0 + 2,A
   \   000066   75F002       MOV     B,#0x2
   \   000069   EF           MOV     A,R7
   \   00006A   A4           MUL     AB
   \   00006B   25..         ADD     A,?V0 + 2
   \   00006D   FF           MOV     R7,A
   \   00006E   EC           MOV     A,R4
   \   00006F   2E           ADD     A,R6
   \   000070   F582         MOV     DPL,A
   \   000072   ED           MOV     A,R5
   \   000073   3F           ADDC    A,R7
   \   000074   F583         MOV     DPH,A
   \   000076   E0           MOVX    A,@DPTR
   \   000077   68           XRL     A,R0
   \   000078   7003         JNZ     ??ZDO_AnyClusterMatches_4
   \   00007A   A3           INC     DPTR
   \   00007B   E0           MOVX    A,@DPTR
   \   00007C   69           XRL     A,R1
   \                     ??ZDO_AnyClusterMatches_4:
   \   00007D   7004         JNZ     ??ZDO_AnyClusterMatches_5
    521                {
    522                  return true;
   \   00007F   7901         MOV     R1,#0x1
   \   000081   800A         SJMP    ??ZDO_AnyClusterMatches_6
    523                }
    524              }
   \                     ??ZDO_AnyClusterMatches_5:
   \   000083   05..         INC     ?V0 + 4
   \   000085   809D         SJMP    ??ZDO_AnyClusterMatches_2
    525            }
   \                     ??ZDO_AnyClusterMatches_3:
   \   000087   05..         INC     ?V0 + 3
   \   000089   808F         SJMP    ??ZDO_AnyClusterMatches_0
    526          
    527            return false;
   \                     ??ZDO_AnyClusterMatches_1:
   \   00008B   7900         MOV     R1,#0x0
   \                     ??ZDO_AnyClusterMatches_6:
   \   00008D   7F05         MOV     R7,#0x5
   \   00008F   02....       LJMP    ?BANKED_LEAVE_XDATA
    528          }
    529          
    530          /*********************************************************************
    531           * Callback functions from ZDProfile
    532           */
    533          
    534          /*********************************************************************
    535           * @fn          ZDO_ProcessNodeDescReq
    536           *
    537           * @brief       This function processes and responds to the
    538           *              Node_Desc_req message.
    539           *
    540           * @param       inMsg - incoming message
    541           *
    542           * @return      none
    543           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    544          void ZDO_ProcessNodeDescReq( zdoIncomingMsg_t *inMsg )
   \                     ZDO_ProcessNodeDescReq:
    545          {
   \   000000   74F2         MOV     A,#-0xe
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 14
   \   000005                ; Auto size: 0
   \   000005   EA           MOV     A,R2
   \   000006   FE           MOV     R6,A
   \   000007   EB           MOV     A,R3
   \   000008   FF           MOV     R7,A
    546            uint16 aoi = BUILD_UINT16( inMsg->asdu[0], inMsg->asdu[1] );
   \   000009   EE           MOV     A,R6
   \   00000A   2411         ADD     A,#0x11
   \   00000C   F582         MOV     DPL,A
   \   00000E   EF           MOV     A,R7
   \   00000F   3400         ADDC    A,#0x0
   \   000011   F583         MOV     DPH,A
   \   000013   E0           MOVX    A,@DPTR
   \   000014   F8           MOV     R0,A
   \   000015   A3           INC     DPTR
   \   000016   E0           MOVX    A,@DPTR
   \   000017   F583         MOV     DPH,A
   \   000019   8882         MOV     DPL,R0
   \   00001B   E0           MOVX    A,@DPTR
   \   00001C   FA           MOV     R2,A
   \   00001D   7B00         MOV     R3,#0x0
   \   00001F   EE           MOV     A,R6
   \   000020   2411         ADD     A,#0x11
   \   000022   F582         MOV     DPL,A
   \   000024   EF           MOV     A,R7
   \   000025   3400         ADDC    A,#0x0
   \   000027   F583         MOV     DPH,A
   \   000029   E0           MOVX    A,@DPTR
   \   00002A   F8           MOV     R0,A
   \   00002B   A3           INC     DPTR
   \   00002C   E0           MOVX    A,@DPTR
   \   00002D   F583         MOV     DPH,A
   \   00002F   8882         MOV     DPL,R0
   \   000031   A3           INC     DPTR
   \   000032   E0           MOVX    A,@DPTR
   \   000033   F8           MOV     R0,A
   \   000034   E4           CLR     A
   \   000035   C8           XCH     A,R0
   \   000036   F9           MOV     R1,A
   \   000037   E8           MOV     A,R0
   \   000038   2A           ADD     A,R2
   \   000039   F8           MOV     R0,A
   \   00003A   E9           MOV     A,R1
   \   00003B   3B           ADDC    A,R3
   \   00003C   F9           MOV     R1,A
   \   00003D   88..         MOV     ?V0 + 0,R0
   \   00003F   89..         MOV     ?V0 + 1,R1
    547            NodeDescriptorFormat_t *desc = NULL;
   \   000041   75..00       MOV     ?V0 + 2,#0x0
   \   000044   75..00       MOV     ?V0 + 3,#0x0
    548          
    549            if ( aoi == ZDAppNwkAddr.addr.shortAddr )
   \   000047   90....       MOV     DPTR,#ZDAppNwkAddr
   \   00004A   E0           MOVX    A,@DPTR
   \   00004B   65..         XRL     A,?V0 + 0
   \   00004D   7004         JNZ     ??ZDO_ProcessNodeDescReq_0
   \   00004F   A3           INC     DPTR
   \   000050   E0           MOVX    A,@DPTR
   \   000051   65..         XRL     A,?V0 + 1
   \                     ??ZDO_ProcessNodeDescReq_0:
   \   000053   7006         JNZ     ??ZDO_ProcessNodeDescReq_1
    550            {
    551              desc = &ZDO_Config_Node_Descriptor;
   \   000055   75....       MOV     ?V0 + 2,#(ZDO_Config_Node_Descriptor & 0xff)
   \   000058   75....       MOV     ?V0 + 3,#((ZDO_Config_Node_Descriptor >> 8) & 0xff)
    552            }
    553          
    554            if ( desc != NULL )
   \                     ??ZDO_ProcessNodeDescReq_1:
   \   00005B   E5..         MOV     A,?V0 + 2
   \   00005D   6400         XRL     A,#0x0
   \   00005F   7004         JNZ     ??ZDO_ProcessNodeDescReq_2
   \   000061   E5..         MOV     A,?V0 + 3
   \   000063   6400         XRL     A,#0x0
   \                     ??ZDO_ProcessNodeDescReq_2:
   \   000065   6017         JZ      ??ZDO_ProcessNodeDescReq_3
    555            {
    556              ZDP_NodeDescMsg( inMsg, aoi, desc );
   \   000067                ; Setup parameters for call to function ZDP_NodeDescMsg
   \   000067   78..         MOV     R0,#?V0 + 2
   \   000069   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   00006C   AC..         MOV     R4,?V0 + 0
   \   00006E   AD..         MOV     R5,?V0 + 1
   \   000070   EE           MOV     A,R6
   \   000071   FA           MOV     R2,A
   \   000072   EF           MOV     A,R7
   \   000073   FB           MOV     R3,A
   \   000074   12....       LCALL   ??ZDP_NodeDescMsg?relay
   \   000077   7402         MOV     A,#0x2
   \   000079   12....       LCALL   ?DEALLOC_XSTACK8
   \   00007C   803A         SJMP    ??ZDO_ProcessNodeDescReq_4
    557            }
    558            else
    559            {
    560              ZDP_GenericRsp( inMsg->TransSeq, &(inMsg->srcAddr),
    561                        ZDP_INVALID_REQTYPE, aoi, Node_Desc_rsp, inMsg->SecurityUse );
   \                     ??ZDO_ProcessNodeDescReq_3:
   \   00007E                ; Setup parameters for call to function ZDP_GenericRsp
   \   00007E   75..02       MOV     ?V0 + 4,#0x2
   \   000081   75..80       MOV     ?V0 + 5,#-0x80
   \   000084   78..         MOV     R0,#?V0 + 4
   \   000086   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   000089   78..         MOV     R0,#?V0 + 0
   \   00008B   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   00008E   EE           MOV     A,R6
   \   00008F   240E         ADD     A,#0xe
   \   000091   F582         MOV     DPL,A
   \   000093   EF           MOV     A,R7
   \   000094   3400         ADDC    A,#0x0
   \   000096   F583         MOV     DPH,A
   \   000098   E0           MOVX    A,@DPTR
   \   000099   FD           MOV     R5,A
   \   00009A   7C80         MOV     R4,#-0x80
   \   00009C   EE           MOV     A,R6
   \   00009D   2402         ADD     A,#0x2
   \   00009F   FA           MOV     R2,A
   \   0000A0   EF           MOV     A,R7
   \   0000A1   3400         ADDC    A,#0x0
   \   0000A3   FB           MOV     R3,A
   \   0000A4   EE           MOV     A,R6
   \   0000A5   240F         ADD     A,#0xf
   \   0000A7   F582         MOV     DPL,A
   \   0000A9   EF           MOV     A,R7
   \   0000AA   3400         ADDC    A,#0x0
   \   0000AC   F583         MOV     DPH,A
   \   0000AE   E0           MOVX    A,@DPTR
   \   0000AF   F9           MOV     R1,A
   \   0000B0   12....       LCALL   ??ZDP_GenericRsp?relay
   \   0000B3   7404         MOV     A,#0x4
   \   0000B5   12....       LCALL   ?DEALLOC_XSTACK8
    562            }
    563          }
   \                     ??ZDO_ProcessNodeDescReq_4:
   \   0000B8   7F06         MOV     R7,#0x6
   \   0000BA   02....       LJMP    ?BANKED_LEAVE_XDATA
    564          
    565          /*********************************************************************
    566           * @fn          ZDO_ProcessPowerDescReq
    567           *
    568           * @brief       This function processes and responds to the
    569           *              Node_Power_req message.
    570           *
    571           * @param       inMsg  - incoming request
    572           *
    573           * @return      none
    574           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    575          void ZDO_ProcessPowerDescReq( zdoIncomingMsg_t *inMsg )
   \                     ZDO_ProcessPowerDescReq:
    576          {
   \   000000   74F2         MOV     A,#-0xe
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 14
   \   000005                ; Auto size: 0
   \   000005   EA           MOV     A,R2
   \   000006   FE           MOV     R6,A
   \   000007   EB           MOV     A,R3
   \   000008   FF           MOV     R7,A
    577            uint16 aoi = BUILD_UINT16( inMsg->asdu[0], inMsg->asdu[1] );
   \   000009   EE           MOV     A,R6
   \   00000A   2411         ADD     A,#0x11
   \   00000C   F582         MOV     DPL,A
   \   00000E   EF           MOV     A,R7
   \   00000F   3400         ADDC    A,#0x0
   \   000011   F583         MOV     DPH,A
   \   000013   E0           MOVX    A,@DPTR
   \   000014   F8           MOV     R0,A
   \   000015   A3           INC     DPTR
   \   000016   E0           MOVX    A,@DPTR
   \   000017   F583         MOV     DPH,A
   \   000019   8882         MOV     DPL,R0
   \   00001B   E0           MOVX    A,@DPTR
   \   00001C   FA           MOV     R2,A
   \   00001D   7B00         MOV     R3,#0x0
   \   00001F   EE           MOV     A,R6
   \   000020   2411         ADD     A,#0x11
   \   000022   F582         MOV     DPL,A
   \   000024   EF           MOV     A,R7
   \   000025   3400         ADDC    A,#0x0
   \   000027   F583         MOV     DPH,A
   \   000029   E0           MOVX    A,@DPTR
   \   00002A   F8           MOV     R0,A
   \   00002B   A3           INC     DPTR
   \   00002C   E0           MOVX    A,@DPTR
   \   00002D   F583         MOV     DPH,A
   \   00002F   8882         MOV     DPL,R0
   \   000031   A3           INC     DPTR
   \   000032   E0           MOVX    A,@DPTR
   \   000033   F8           MOV     R0,A
   \   000034   E4           CLR     A
   \   000035   C8           XCH     A,R0
   \   000036   F9           MOV     R1,A
   \   000037   E8           MOV     A,R0
   \   000038   2A           ADD     A,R2
   \   000039   F8           MOV     R0,A
   \   00003A   E9           MOV     A,R1
   \   00003B   3B           ADDC    A,R3
   \   00003C   F9           MOV     R1,A
   \   00003D   88..         MOV     ?V0 + 0,R0
   \   00003F   89..         MOV     ?V0 + 1,R1
    578            NodePowerDescriptorFormat_t *desc = NULL;
   \   000041   75..00       MOV     ?V0 + 2,#0x0
   \   000044   75..00       MOV     ?V0 + 3,#0x0
    579          
    580            if ( aoi == ZDAppNwkAddr.addr.shortAddr )
   \   000047   90....       MOV     DPTR,#ZDAppNwkAddr
   \   00004A   E0           MOVX    A,@DPTR
   \   00004B   65..         XRL     A,?V0 + 0
   \   00004D   7004         JNZ     ??ZDO_ProcessPowerDescReq_0
   \   00004F   A3           INC     DPTR
   \   000050   E0           MOVX    A,@DPTR
   \   000051   65..         XRL     A,?V0 + 1
   \                     ??ZDO_ProcessPowerDescReq_0:
   \   000053   7006         JNZ     ??ZDO_ProcessPowerDescReq_1
    581            {
    582              desc = &ZDO_Config_Power_Descriptor;
   \   000055   75....       MOV     ?V0 + 2,#(ZDO_Config_Power_Descriptor & 0xff)
   \   000058   75....       MOV     ?V0 + 3,#((ZDO_Config_Power_Descriptor >> 8) & 0xff)
    583            }
    584          
    585            if ( desc != NULL )
   \                     ??ZDO_ProcessPowerDescReq_1:
   \   00005B   E5..         MOV     A,?V0 + 2
   \   00005D   6400         XRL     A,#0x0
   \   00005F   7004         JNZ     ??ZDO_ProcessPowerDescReq_2
   \   000061   E5..         MOV     A,?V0 + 3
   \   000063   6400         XRL     A,#0x0
   \                     ??ZDO_ProcessPowerDescReq_2:
   \   000065   6017         JZ      ??ZDO_ProcessPowerDescReq_3
    586            {
    587              ZDP_PowerDescMsg( inMsg, aoi, desc );
   \   000067                ; Setup parameters for call to function ZDP_PowerDescMsg
   \   000067   78..         MOV     R0,#?V0 + 2
   \   000069   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   00006C   AC..         MOV     R4,?V0 + 0
   \   00006E   AD..         MOV     R5,?V0 + 1
   \   000070   EE           MOV     A,R6
   \   000071   FA           MOV     R2,A
   \   000072   EF           MOV     A,R7
   \   000073   FB           MOV     R3,A
   \   000074   12....       LCALL   ??ZDP_PowerDescMsg?relay
   \   000077   7402         MOV     A,#0x2
   \   000079   12....       LCALL   ?DEALLOC_XSTACK8
   \   00007C   803A         SJMP    ??ZDO_ProcessPowerDescReq_4
    588            }
    589            else
    590            {
    591              ZDP_GenericRsp( inMsg->TransSeq, &(inMsg->srcAddr),
    592                        ZDP_INVALID_REQTYPE, aoi, Power_Desc_rsp, inMsg->SecurityUse );
   \                     ??ZDO_ProcessPowerDescReq_3:
   \   00007E                ; Setup parameters for call to function ZDP_GenericRsp
   \   00007E   75..03       MOV     ?V0 + 4,#0x3
   \   000081   75..80       MOV     ?V0 + 5,#-0x80
   \   000084   78..         MOV     R0,#?V0 + 4
   \   000086   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   000089   78..         MOV     R0,#?V0 + 0
   \   00008B   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   00008E   EE           MOV     A,R6
   \   00008F   240E         ADD     A,#0xe
   \   000091   F582         MOV     DPL,A
   \   000093   EF           MOV     A,R7
   \   000094   3400         ADDC    A,#0x0
   \   000096   F583         MOV     DPH,A
   \   000098   E0           MOVX    A,@DPTR
   \   000099   FD           MOV     R5,A
   \   00009A   7C80         MOV     R4,#-0x80
   \   00009C   EE           MOV     A,R6
   \   00009D   2402         ADD     A,#0x2
   \   00009F   FA           MOV     R2,A
   \   0000A0   EF           MOV     A,R7
   \   0000A1   3400         ADDC    A,#0x0
   \   0000A3   FB           MOV     R3,A
   \   0000A4   EE           MOV     A,R6
   \   0000A5   240F         ADD     A,#0xf
   \   0000A7   F582         MOV     DPL,A
   \   0000A9   EF           MOV     A,R7
   \   0000AA   3400         ADDC    A,#0x0
   \   0000AC   F583         MOV     DPH,A
   \   0000AE   E0           MOVX    A,@DPTR
   \   0000AF   F9           MOV     R1,A
   \   0000B0   12....       LCALL   ??ZDP_GenericRsp?relay
   \   0000B3   7404         MOV     A,#0x4
   \   0000B5   12....       LCALL   ?DEALLOC_XSTACK8
    593            }
    594          }
   \                     ??ZDO_ProcessPowerDescReq_4:
   \   0000B8   7F06         MOV     R7,#0x6
   \   0000BA   02....       LJMP    ?BANKED_LEAVE_XDATA
    595          
    596          /*********************************************************************
    597           * @fn          ZDO_ProcessSimpleDescReq
    598           *
    599           * @brief       This function processes and responds to the
    600           *              Simple_Desc_req message.
    601           *
    602           * @param       inMsg - incoming message (request)
    603           *
    604           * @return      none
    605           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    606          void ZDO_ProcessSimpleDescReq( zdoIncomingMsg_t *inMsg )
   \                     ZDO_ProcessSimpleDescReq:
    607          {
   \   000000   74F2         MOV     A,#-0xe
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 14
   \   000005                ; Auto size: 2
   \   000005   74FE         MOV     A,#-0x2
   \   000007   12....       LCALL   ?ALLOC_XSTACK8
   \   00000A   8A..         MOV     ?V0 + 2,R2
   \   00000C   8B..         MOV     ?V0 + 3,R3
    608            SimpleDescriptionFormat_t *sDesc = NULL;
   \   00000E   85..82       MOV     DPL,?XSP + 0
   \   000011   85..83       MOV     DPH,?XSP + 1
   \   000014   7400         MOV     A,#0x0
   \   000016   F0           MOVX    @DPTR,A
   \   000017   A3           INC     DPTR
   \   000018   7400         MOV     A,#0x0
   \   00001A   F0           MOVX    @DPTR,A
    609            uint16 aoi = BUILD_UINT16( inMsg->asdu[0], inMsg->asdu[1] );
   \   00001B   E5..         MOV     A,?V0 + 2
   \   00001D   2411         ADD     A,#0x11
   \   00001F   F582         MOV     DPL,A
   \   000021   E5..         MOV     A,?V0 + 3
   \   000023   3400         ADDC    A,#0x0
   \   000025   F583         MOV     DPH,A
   \   000027   E0           MOVX    A,@DPTR
   \   000028   F8           MOV     R0,A
   \   000029   A3           INC     DPTR
   \   00002A   E0           MOVX    A,@DPTR
   \   00002B   F583         MOV     DPH,A
   \   00002D   8882         MOV     DPL,R0
   \   00002F   E0           MOVX    A,@DPTR
   \   000030   FA           MOV     R2,A
   \   000031   7B00         MOV     R3,#0x0
   \   000033   E5..         MOV     A,?V0 + 2
   \   000035   2411         ADD     A,#0x11
   \   000037   F582         MOV     DPL,A
   \   000039   E5..         MOV     A,?V0 + 3
   \   00003B   3400         ADDC    A,#0x0
   \   00003D   F583         MOV     DPH,A
   \   00003F   E0           MOVX    A,@DPTR
   \   000040   F8           MOV     R0,A
   \   000041   A3           INC     DPTR
   \   000042   E0           MOVX    A,@DPTR
   \   000043   F583         MOV     DPH,A
   \   000045   8882         MOV     DPL,R0
   \   000047   A3           INC     DPTR
   \   000048   E0           MOVX    A,@DPTR
   \   000049   F8           MOV     R0,A
   \   00004A   E4           CLR     A
   \   00004B   C8           XCH     A,R0
   \   00004C   F9           MOV     R1,A
   \   00004D   E8           MOV     A,R0
   \   00004E   2A           ADD     A,R2
   \   00004F   F8           MOV     R0,A
   \   000050   E9           MOV     A,R1
   \   000051   3B           ADDC    A,R3
   \   000052   F9           MOV     R1,A
   \   000053   88..         MOV     ?V0 + 4,R0
   \   000055   89..         MOV     ?V0 + 5,R1
    610            byte endPoint = inMsg->asdu[2];
   \   000057   E5..         MOV     A,?V0 + 2
   \   000059   2411         ADD     A,#0x11
   \   00005B   F582         MOV     DPL,A
   \   00005D   E5..         MOV     A,?V0 + 3
   \   00005F   3400         ADDC    A,#0x0
   \   000061   F583         MOV     DPH,A
   \   000063   E0           MOVX    A,@DPTR
   \   000064   F8           MOV     R0,A
   \   000065   A3           INC     DPTR
   \   000066   E0           MOVX    A,@DPTR
   \   000067   F583         MOV     DPH,A
   \   000069   8882         MOV     DPL,R0
   \   00006B   A3           INC     DPTR
   \   00006C   A3           INC     DPTR
   \   00006D   E0           MOVX    A,@DPTR
   \   00006E   FE           MOV     R6,A
    611            byte free = false;
   \   00006F   75..00       MOV     ?V0 + 0,#0x0
    612            byte stat = ZDP_SUCCESS;
   \   000072   7F00         MOV     R7,#0x0
    613          
    614            if ( (endPoint == ZDO_EP) || (endPoint > MAX_ENDPOINTS) )
   \   000074   EE           MOV     A,R6
   \   000075   6006         JZ      ??ZDO_ProcessSimpleDescReq_0
   \   000077   EE           MOV     A,R6
   \   000078   C3           CLR     C
   \   000079   94F1         SUBB    A,#-0xf
   \   00007B   4004         JC      ??ZDO_ProcessSimpleDescReq_1
    615            {
    616              stat = ZDP_INVALID_EP;
   \                     ??ZDO_ProcessSimpleDescReq_0:
   \   00007D   7F82         MOV     R7,#-0x7e
   \   00007F   8037         SJMP    ??ZDO_ProcessSimpleDescReq_2
    617            }
    618            else if ( aoi == ZDAppNwkAddr.addr.shortAddr )
   \                     ??ZDO_ProcessSimpleDescReq_1:
   \   000081   90....       MOV     DPTR,#ZDAppNwkAddr
   \   000084   E0           MOVX    A,@DPTR
   \   000085   65..         XRL     A,?V0 + 4
   \   000087   7004         JNZ     ??ZDO_ProcessSimpleDescReq_3
   \   000089   A3           INC     DPTR
   \   00008A   E0           MOVX    A,@DPTR
   \   00008B   65..         XRL     A,?V0 + 5
   \                     ??ZDO_ProcessSimpleDescReq_3:
   \   00008D   7027         JNZ     ??ZDO_ProcessSimpleDescReq_4
    619            {
    620              free = afFindSimpleDesc( &sDesc, endPoint );
   \   00008F                ; Setup parameters for call to function afFindSimpleDesc
   \   00008F   EE           MOV     A,R6
   \   000090   F9           MOV     R1,A
   \   000091   85..82       MOV     DPL,?XSP + 0
   \   000094   85..83       MOV     DPH,?XSP + 1
   \   000097   AA82         MOV     R2,DPL
   \   000099   AB83         MOV     R3,DPH
   \   00009B   12....       LCALL   ??afFindSimpleDesc?relay
   \   00009E   E9           MOV     A,R1
   \   00009F   F5..         MOV     ?V0 + 0,A
    621              if ( sDesc == NULL )
   \   0000A1   85..82       MOV     DPL,?XSP + 0
   \   0000A4   85..83       MOV     DPH,?XSP + 1
   \   0000A7   E0           MOVX    A,@DPTR
   \   0000A8   6400         XRL     A,#0x0
   \   0000AA   7004         JNZ     ??ZDO_ProcessSimpleDescReq_5
   \   0000AC   A3           INC     DPTR
   \   0000AD   E0           MOVX    A,@DPTR
   \   0000AE   6400         XRL     A,#0x0
   \                     ??ZDO_ProcessSimpleDescReq_5:
   \   0000B0   7006         JNZ     ??ZDO_ProcessSimpleDescReq_2
    622              {
    623                stat = ZDP_NOT_ACTIVE;
   \   0000B2   7F83         MOV     R7,#-0x7d
   \   0000B4   8002         SJMP    ??ZDO_ProcessSimpleDescReq_2
    624              }
    625            }
    626            else
    627            {
    628          #if defined ( RTR_NWK )
    629              stat = ZDP_DEVICE_NOT_FOUND;
    630          #else
    631              stat = ZDP_INVALID_REQTYPE;
   \                     ??ZDO_ProcessSimpleDescReq_4:
   \   0000B6   7F80         MOV     R7,#-0x80
    632          #endif
    633            }
    634          
    635            ZDP_SimpleDescMsg( inMsg, stat, sDesc );
   \                     ??ZDO_ProcessSimpleDescReq_2:
   \   0000B8                ; Setup parameters for call to function ZDP_SimpleDescMsg
   \   0000B8   85..82       MOV     DPL,?XSP + 0
   \   0000BB   85..83       MOV     DPH,?XSP + 1
   \   0000BE   E0           MOVX    A,@DPTR
   \   0000BF   FC           MOV     R4,A
   \   0000C0   A3           INC     DPTR
   \   0000C1   E0           MOVX    A,@DPTR
   \   0000C2   FD           MOV     R5,A
   \   0000C3   EF           MOV     A,R7
   \   0000C4   F9           MOV     R1,A
   \   0000C5   AA..         MOV     R2,?V0 + 2
   \   0000C7   AB..         MOV     R3,?V0 + 3
   \   0000C9   12....       LCALL   ??ZDP_SimpleDescMsg?relay
    636          
    637            if ( free )
   \   0000CC   E5..         MOV     A,?V0 + 0
   \   0000CE   600E         JZ      ??ZDO_ProcessSimpleDescReq_6
    638            {
    639              osal_mem_free( sDesc );
   \   0000D0                ; Setup parameters for call to function osal_mem_free
   \   0000D0   85..82       MOV     DPL,?XSP + 0
   \   0000D3   85..83       MOV     DPH,?XSP + 1
   \   0000D6   E0           MOVX    A,@DPTR
   \   0000D7   FA           MOV     R2,A
   \   0000D8   A3           INC     DPTR
   \   0000D9   E0           MOVX    A,@DPTR
   \   0000DA   FB           MOV     R3,A
   \   0000DB   12....       LCALL   ??osal_mem_free?relay
    640            }
    641          }
   \                     ??ZDO_ProcessSimpleDescReq_6:
   \   0000DE   7402         MOV     A,#0x2
   \   0000E0   12....       LCALL   ?DEALLOC_XSTACK8
   \   0000E3   7F06         MOV     R7,#0x6
   \   0000E5   02....       LJMP    ?BANKED_LEAVE_XDATA
    642          
    643          /*********************************************************************
    644           * @fn          ZDO_ProcessActiveEPReq
    645           *
    646           * @brief       This function processes and responds to the
    647           *              Active_EP_req message.
    648           *
    649           * @param       inMsg  - incoming message (request)
    650           *
    651           * @return      none
    652           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    653          void ZDO_ProcessActiveEPReq( zdoIncomingMsg_t *inMsg )
   \                     ZDO_ProcessActiveEPReq:
    654          {
   \   000000   74F2         MOV     A,#-0xe
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 14
   \   000005                ; Auto size: 0
   \   000005   8A..         MOV     ?V0 + 4,R2
   \   000007   8B..         MOV     ?V0 + 5,R3
    655            byte cnt = 0;
   \   000009   75..00       MOV     ?V0 + 1,#0x0
    656            uint16 aoi;
    657            byte stat = ZDP_SUCCESS;
   \   00000C   75..00       MOV     ?V0 + 0,#0x0
    658          
    659            aoi = BUILD_UINT16( inMsg->asdu[0], inMsg->asdu[1] );
   \   00000F   E5..         MOV     A,?V0 + 4
   \   000011   2411         ADD     A,#0x11
   \   000013   F582         MOV     DPL,A
   \   000015   E5..         MOV     A,?V0 + 5
   \   000017   3400         ADDC    A,#0x0
   \   000019   F583         MOV     DPH,A
   \   00001B   E0           MOVX    A,@DPTR
   \   00001C   F8           MOV     R0,A
   \   00001D   A3           INC     DPTR
   \   00001E   E0           MOVX    A,@DPTR
   \   00001F   F583         MOV     DPH,A
   \   000021   8882         MOV     DPL,R0
   \   000023   E0           MOVX    A,@DPTR
   \   000024   FA           MOV     R2,A
   \   000025   7B00         MOV     R3,#0x0
   \   000027   E5..         MOV     A,?V0 + 4
   \   000029   2411         ADD     A,#0x11
   \   00002B   F582         MOV     DPL,A
   \   00002D   E5..         MOV     A,?V0 + 5
   \   00002F   3400         ADDC    A,#0x0
   \   000031   F583         MOV     DPH,A
   \   000033   E0           MOVX    A,@DPTR
   \   000034   F8           MOV     R0,A
   \   000035   A3           INC     DPTR
   \   000036   E0           MOVX    A,@DPTR
   \   000037   F583         MOV     DPH,A
   \   000039   8882         MOV     DPL,R0
   \   00003B   A3           INC     DPTR
   \   00003C   E0           MOVX    A,@DPTR
   \   00003D   F8           MOV     R0,A
   \   00003E   E4           CLR     A
   \   00003F   C8           XCH     A,R0
   \   000040   F9           MOV     R1,A
   \   000041   E8           MOV     A,R0
   \   000042   2A           ADD     A,R2
   \   000043   F8           MOV     R0,A
   \   000044   E9           MOV     A,R1
   \   000045   3B           ADDC    A,R3
   \   000046   F9           MOV     R1,A
   \   000047   E8           MOV     A,R0
   \   000048   FE           MOV     R6,A
   \   000049   E9           MOV     A,R1
   \   00004A   FF           MOV     R7,A
    660          
    661            if ( aoi == NLME_GetShortAddr() )
   \   00004B                ; Setup parameters for call to function NLME_GetShortAddr
   \   00004B   12....       LCALL   ??NLME_GetShortAddr?relay
   \   00004E   8A..         MOV     ?V0 + 2,R2
   \   000050   8B..         MOV     ?V0 + 3,R3
   \   000052   E5..         MOV     A,?V0 + 2
   \   000054   6E           XRL     A,R6
   \   000055   7003         JNZ     ??ZDO_ProcessActiveEPReq_0
   \   000057   E5..         MOV     A,?V0 + 3
   \   000059   6F           XRL     A,R7
   \                     ??ZDO_ProcessActiveEPReq_0:
   \   00005A   7013         JNZ     ??ZDO_ProcessActiveEPReq_1
    662            {
    663              cnt = afNumEndPoints() - 1;  // -1 for ZDO endpoint descriptor
   \   00005C                ; Setup parameters for call to function afNumEndPoints
   \   00005C   12....       LCALL   ??afNumEndPoints?relay
   \   00005F   E9           MOV     A,R1
   \   000060   24FF         ADD     A,#-0x1
   \   000062   F5..         MOV     ?V0 + 1,A
    664              afEndPoints( (uint8 *)ZDOBuildBuf, true );
   \   000064                ; Setup parameters for call to function afEndPoints
   \   000064   7901         MOV     R1,#0x1
   \   000066   7A..         MOV     R2,#(ZDOBuildBuf & 0xff)
   \   000068   7B..         MOV     R3,#((ZDOBuildBuf >> 8) & 0xff)
   \   00006A   12....       LCALL   ??afEndPoints?relay
   \   00006D   8003         SJMP    ??ZDO_ProcessActiveEPReq_2
    665            }
    666            else
    667            {
    668              stat = ZDP_INVALID_REQTYPE;
   \                     ??ZDO_ProcessActiveEPReq_1:
   \   00006F   75..80       MOV     ?V0 + 0,#-0x80
    669            }
    670          
    671            ZDP_ActiveEPRsp( inMsg->TransSeq, &(inMsg->srcAddr), stat,
    672                            aoi, cnt, (uint8 *)ZDOBuildBuf, inMsg->SecurityUse );
   \                     ??ZDO_ProcessActiveEPReq_2:
   \   000072                ; Setup parameters for call to function ZDP_EPRsp
   \   000072   E5..         MOV     A,?V0 + 4
   \   000074   240E         ADD     A,#0xe
   \   000076   F582         MOV     DPL,A
   \   000078   E5..         MOV     A,?V0 + 5
   \   00007A   3400         ADDC    A,#0x0
   \   00007C   F583         MOV     DPH,A
   \   00007E   E0           MOVX    A,@DPTR
   \   00007F   F5..         MOV     ?V0 + 2,A
   \   000081   78..         MOV     R0,#?V0 + 2
   \   000083   12....       LCALL   ?PUSH_XSTACK_I_ONE
   \   000086   75....       MOV     ?V0 + 2,#(ZDOBuildBuf & 0xff)
   \   000089   75....       MOV     ?V0 + 3,#((ZDOBuildBuf >> 8) & 0xff)
   \   00008C   78..         MOV     R0,#?V0 + 2
   \   00008E   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   000091   E5..         MOV     A,?V0 + 1
   \   000093   F5..         MOV     ?V0 + 2,A
   \   000095   78..         MOV     R0,#?V0 + 2
   \   000097   12....       LCALL   ?PUSH_XSTACK_I_ONE
   \   00009A   8E..         MOV     ?V0 + 2,R6
   \   00009C   8F..         MOV     ?V0 + 3,R7
   \   00009E   78..         MOV     R0,#?V0 + 2
   \   0000A0   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   0000A3   E5..         MOV     A,?V0 + 0
   \   0000A5   F5..         MOV     ?V0 + 2,A
   \   0000A7   78..         MOV     R0,#?V0 + 2
   \   0000A9   12....       LCALL   ?PUSH_XSTACK_I_ONE
   \   0000AC   E5..         MOV     A,?V0 + 4
   \   0000AE   2402         ADD     A,#0x2
   \   0000B0   FC           MOV     R4,A
   \   0000B1   E5..         MOV     A,?V0 + 5
   \   0000B3   3400         ADDC    A,#0x0
   \   0000B5   FD           MOV     R5,A
   \   0000B6   E5..         MOV     A,?V0 + 4
   \   0000B8   240F         ADD     A,#0xf
   \   0000BA   F582         MOV     DPL,A
   \   0000BC   E5..         MOV     A,?V0 + 5
   \   0000BE   3400         ADDC    A,#0x0
   \   0000C0   F583         MOV     DPH,A
   \   0000C2   E0           MOVX    A,@DPTR
   \   0000C3   F9           MOV     R1,A
   \   0000C4   7A05         MOV     R2,#0x5
   \   0000C6   7B80         MOV     R3,#-0x80
   \   0000C8   12....       LCALL   ??ZDP_EPRsp?relay
   \   0000CB   7407         MOV     A,#0x7
   \   0000CD   12....       LCALL   ?DEALLOC_XSTACK8
    673          }
   \   0000D0   7F06         MOV     R7,#0x6
   \   0000D2   02....       LJMP    ?BANKED_LEAVE_XDATA
    674          
    675          /*********************************************************************
    676           * @fn          ZDO_ConvertOTAClusters
    677           *
    678           * @brief       This function will convert the over-the-air cluster list
    679           *              format to an internal format.
    680           *
    681           * @param       inMsg  - incoming message (request)
    682           *
    683           * @return      pointer to incremented inBuf
    684           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    685          uint8 *ZDO_ConvertOTAClusters( uint8 cnt, uint8 *inBuf, uint16 *outList )
   \                     ZDO_ConvertOTAClusters:
    686          {
   \   000000   74F5         MOV     A,#-0xb
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 11
   \   000005                ; Auto size: 0
   \   000005   E9           MOV     A,R1
   \   000006   FE           MOV     R6,A
    687            uint8 x;
    688            for ( x = 0; x < cnt; x++ )
   \   000007   75..00       MOV     ?V0 + 2,#0x0
   \                     ??ZDO_ConvertOTAClusters_0:
   \   00000A   E5..         MOV     A,?V0 + 2
   \   00000C   C3           CLR     C
   \   00000D   9E           SUBB    A,R6
   \   00000E   5052         JNC     ??ZDO_ConvertOTAClusters_1
    689            {
    690              // convert ota format to internal
    691              outList[x] = BUILD_UINT16( inBuf[0], inBuf[1] );
   \   000010   8A82         MOV     DPL,R2
   \   000012   8B83         MOV     DPH,R3
   \   000014   E0           MOVX    A,@DPTR
   \   000015   F5..         MOV     ?V0 + 0,A
   \   000017   75..00       MOV     ?V0 + 1,#0x0
   \   00001A   8A82         MOV     DPL,R2
   \   00001C   8B83         MOV     DPH,R3
   \   00001E   A3           INC     DPTR
   \   00001F   E0           MOVX    A,@DPTR
   \   000020   F8           MOV     R0,A
   \   000021   E4           CLR     A
   \   000022   C8           XCH     A,R0
   \   000023   F9           MOV     R1,A
   \   000024   E8           MOV     A,R0
   \   000025   25..         ADD     A,?V0 + 0
   \   000027   F5..         MOV     ?V0 + 0,A
   \   000029   E9           MOV     A,R1
   \   00002A   35..         ADDC    A,?V0 + 1
   \   00002C   F5..         MOV     ?V0 + 1,A
   \   00002E   A8..         MOV     R0,?V0 + 2
   \   000030   7900         MOV     R1,#0x0
   \   000032   E8           MOV     A,R0
   \   000033   75F002       MOV     B,#0x2
   \   000036   A4           MUL     AB
   \   000037   C8           XCH     A,R0
   \   000038   AFF0         MOV     R7,B
   \   00003A   75F000       MOV     B,#0x0
   \   00003D   A4           MUL     AB
   \   00003E   2F           ADD     A,R7
   \   00003F   FF           MOV     R7,A
   \   000040   75F002       MOV     B,#0x2
   \   000043   E9           MOV     A,R1
   \   000044   A4           MUL     AB
   \   000045   2F           ADD     A,R7
   \   000046   F9           MOV     R1,A
   \   000047   EC           MOV     A,R4
   \   000048   28           ADD     A,R0
   \   000049   F582         MOV     DPL,A
   \   00004B   ED           MOV     A,R5
   \   00004C   39           ADDC    A,R1
   \   00004D   F583         MOV     DPH,A
   \   00004F   E5..         MOV     A,?V0 + 0
   \   000051   F0           MOVX    @DPTR,A
   \   000052   A3           INC     DPTR
   \   000053   E5..         MOV     A,?V0 + 1
   \   000055   F0           MOVX    @DPTR,A
    692              inBuf += sizeof( uint16 );
   \   000056   EA           MOV     A,R2
   \   000057   2402         ADD     A,#0x2
   \   000059   FA           MOV     R2,A
   \   00005A   EB           MOV     A,R3
   \   00005B   3400         ADDC    A,#0x0
   \   00005D   FB           MOV     R3,A
    693            }
   \   00005E   05..         INC     ?V0 + 2
   \   000060   80A8         SJMP    ??ZDO_ConvertOTAClusters_0
    694            return ( inBuf );
   \                     ??ZDO_ConvertOTAClusters_1:
   \   000062   7F03         MOV     R7,#0x3
   \   000064   02....       LJMP    ?BANKED_LEAVE_XDATA
    695          }
    696          
    697          /*********************************************************************
    698           * @fn          ZDO_ProcessMatchDescReq
    699           *
    700           * @brief       This function processes and responds to the
    701           *              Match_Desc_req message.
    702           *
    703           * @param       inMsg  - incoming message (request)
    704           *
    705           * @return      none
    706           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    707          void ZDO_ProcessMatchDescReq( zdoIncomingMsg_t *inMsg )
   \                     ZDO_ProcessMatchDescReq:
    708          {
   \   000000   74F2         MOV     A,#-0xe
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 14
   \   000005                ; Auto size: 20
   \   000005   74EC         MOV     A,#-0x14
   \   000007   12....       LCALL   ?ALLOC_XSTACK8
   \   00000A   7401         MOV     A,#0x1
   \   00000C   12....       LCALL   ?XSTACK_DISP0_8
   \   00000F   EA           MOV     A,R2
   \   000010   F0           MOVX    @DPTR,A
   \   000011   A3           INC     DPTR
   \   000012   EB           MOV     A,R3
   \   000013   F0           MOVX    @DPTR,A
    709            uint8 epCnt = 0;
   \   000014   7400         MOV     A,#0x0
   \   000016   C0E0         PUSH    A
   \   000018   7407         MOV     A,#0x7
   \   00001A   12....       LCALL   ?XSTACK_DISP0_8
   \   00001D   D0E0         POP     A
   \   00001F   F0           MOVX    @DPTR,A
    710            uint8 numInClusters;
    711            uint16 *inClusters = NULL;
   \   000020   7408         MOV     A,#0x8
   \   000022   12....       LCALL   ?XSTACK_DISP0_8
   \   000025   7400         MOV     A,#0x0
   \   000027   F0           MOVX    @DPTR,A
   \   000028   A3           INC     DPTR
   \   000029   7400         MOV     A,#0x0
   \   00002B   F0           MOVX    @DPTR,A
    712            uint8 numOutClusters;
    713            uint16 *outClusters = NULL;
   \   00002C   740A         MOV     A,#0xa
   \   00002E   12....       LCALL   ?XSTACK_DISP0_8
   \   000031   7400         MOV     A,#0x0
   \   000033   F0           MOVX    @DPTR,A
   \   000034   A3           INC     DPTR
   \   000035   7400         MOV     A,#0x0
   \   000037   F0           MOVX    @DPTR,A
    714            epList_t *epDesc;
    715            SimpleDescriptionFormat_t *sDesc = NULL;
   \   000038   7405         MOV     A,#0x5
   \   00003A   12....       LCALL   ?XSTACK_DISP0_8
   \   00003D   7400         MOV     A,#0x0
   \   00003F   F0           MOVX    @DPTR,A
   \   000040   A3           INC     DPTR
   \   000041   7400         MOV     A,#0x0
   \   000043   F0           MOVX    @DPTR,A
    716            uint8 allocated;
    717            uint8 *msg;
    718            uint16 aoi;
    719            uint16 profileID;
    720          
    721            // Parse the incoming message
    722            msg = inMsg->asdu;
   \   000044   7401         MOV     A,#0x1
   \   000046   12....       LCALL   ?XSTACK_DISP0_8
   \   000049   E0           MOVX    A,@DPTR
   \   00004A   2411         ADD     A,#0x11
   \   00004C   F8           MOV     R0,A
   \   00004D   A3           INC     DPTR
   \   00004E   E0           MOVX    A,@DPTR
   \   00004F   3400         ADDC    A,#0x0
   \   000051   F9           MOV     R1,A
   \   000052   8882         MOV     DPL,R0
   \   000054   8983         MOV     DPH,R1
   \   000056   E0           MOVX    A,@DPTR
   \   000057   F8           MOV     R0,A
   \   000058   A3           INC     DPTR
   \   000059   E0           MOVX    A,@DPTR
   \   00005A   F9           MOV     R1,A
   \   00005B   E8           MOV     A,R0
   \   00005C   FE           MOV     R6,A
   \   00005D   E9           MOV     A,R1
   \   00005E   FF           MOV     R7,A
    723            aoi = BUILD_UINT16( msg[0], msg[1] );
   \   00005F   8E82         MOV     DPL,R6
   \   000061   8F83         MOV     DPH,R7
   \   000063   E0           MOVX    A,@DPTR
   \   000064   FA           MOV     R2,A
   \   000065   7B00         MOV     R3,#0x0
   \   000067   8E82         MOV     DPL,R6
   \   000069   8F83         MOV     DPH,R7
   \   00006B   A3           INC     DPTR
   \   00006C   E0           MOVX    A,@DPTR
   \   00006D   F8           MOV     R0,A
   \   00006E   E4           CLR     A
   \   00006F   C8           XCH     A,R0
   \   000070   F9           MOV     R1,A
   \   000071   E8           MOV     A,R0
   \   000072   2A           ADD     A,R2
   \   000073   F8           MOV     R0,A
   \   000074   E9           MOV     A,R1
   \   000075   3B           ADDC    A,R3
   \   000076   F9           MOV     R1,A
   \   000077   740E         MOV     A,#0xe
   \   000079   12....       LCALL   ?XSTACK_DISP0_8
   \   00007C   E8           MOV     A,R0
   \   00007D   F0           MOVX    @DPTR,A
   \   00007E   A3           INC     DPTR
   \   00007F   E9           MOV     A,R1
   \   000080   F0           MOVX    @DPTR,A
    724            profileID = BUILD_UINT16( msg[2], msg[3] );
   \   000081   8E82         MOV     DPL,R6
   \   000083   8F83         MOV     DPH,R7
   \   000085   A3           INC     DPTR
   \   000086   A3           INC     DPTR
   \   000087   E0           MOVX    A,@DPTR
   \   000088   FA           MOV     R2,A
   \   000089   7B00         MOV     R3,#0x0
   \   00008B   8E82         MOV     DPL,R6
   \   00008D   8F83         MOV     DPH,R7
   \   00008F   A3           INC     DPTR
   \   000090   A3           INC     DPTR
   \   000091   A3           INC     DPTR
   \   000092   E0           MOVX    A,@DPTR
   \   000093   F8           MOV     R0,A
   \   000094   E4           CLR     A
   \   000095   C8           XCH     A,R0
   \   000096   F9           MOV     R1,A
   \   000097   E8           MOV     A,R0
   \   000098   2A           ADD     A,R2
   \   000099   F8           MOV     R0,A
   \   00009A   E9           MOV     A,R1
   \   00009B   3B           ADDC    A,R3
   \   00009C   F9           MOV     R1,A
   \   00009D   7412         MOV     A,#0x12
   \   00009F   12....       LCALL   ?XSTACK_DISP0_8
   \   0000A2   E8           MOV     A,R0
   \   0000A3   F0           MOVX    @DPTR,A
   \   0000A4   A3           INC     DPTR
   \   0000A5   E9           MOV     A,R1
   \   0000A6   F0           MOVX    @DPTR,A
    725            msg += 4;
   \   0000A7   EE           MOV     A,R6
   \   0000A8   2404         ADD     A,#0x4
   \   0000AA   FE           MOV     R6,A
   \   0000AB   EF           MOV     A,R7
   \   0000AC   3400         ADDC    A,#0x0
   \   0000AE   FF           MOV     R7,A
    726            
    727            if ( ADDR_BCAST_NOT_ME == NLME_IsAddressBroadcast(aoi) )
   \   0000AF                ; Setup parameters for call to function NLME_IsAddressBroadcast
   \   0000AF   740E         MOV     A,#0xe
   \   0000B1   12....       LCALL   ?XSTACK_DISP0_8
   \   0000B4   E0           MOVX    A,@DPTR
   \   0000B5   FA           MOV     R2,A
   \   0000B6   A3           INC     DPTR
   \   0000B7   E0           MOVX    A,@DPTR
   \   0000B8   FB           MOV     R3,A
   \   0000B9   12....       LCALL   ??NLME_IsAddressBroadcast?relay
   \   0000BC   E9           MOV     A,R1
   \   0000BD   6401         XRL     A,#0x1
   \   0000BF   706C         JNZ     ??ZDO_ProcessMatchDescReq_0
    728            {
    729              ZDP_MatchDescRsp( inMsg->TransSeq, &(inMsg->srcAddr), ZDP_INVALID_REQTYPE,
    730                                    ZDAppNwkAddr.addr.shortAddr, 0, NULL, inMsg->SecurityUse );
   \   0000C1                ; Setup parameters for call to function ZDP_EPRsp
   \   0000C1   7401         MOV     A,#0x1
   \   0000C3   12....       LCALL   ?XSTACK_DISP0_8
   \   0000C6   E0           MOVX    A,@DPTR
   \   0000C7   240E         ADD     A,#0xe
   \   0000C9   F8           MOV     R0,A
   \   0000CA   A3           INC     DPTR
   \   0000CB   E0           MOVX    A,@DPTR
   \   0000CC   3400         ADDC    A,#0x0
   \   0000CE   F9           MOV     R1,A
   \   0000CF   8882         MOV     DPL,R0
   \   0000D1   8983         MOV     DPH,R1
   \   0000D3   E0           MOVX    A,@DPTR
   \   0000D4   F5..         MOV     ?V0 + 0,A
   \   0000D6   78..         MOV     R0,#?V0 + 0
   \   0000D8   12....       LCALL   ?PUSH_XSTACK_I_ONE
   \   0000DB   75..00       MOV     ?V0 + 0,#0x0
   \   0000DE   75..00       MOV     ?V0 + 1,#0x0
   \   0000E1   78..         MOV     R0,#?V0 + 0
   \   0000E3   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   0000E6   75..00       MOV     ?V0 + 0,#0x0
   \   0000E9   78..         MOV     R0,#?V0 + 0
   \   0000EB   12....       LCALL   ?PUSH_XSTACK_I_ONE
   \   0000EE   90....       MOV     DPTR,#ZDAppNwkAddr
   \   0000F1   12....       LCALL   ?PUSH_XSTACK8_X_TWO
   \   0000F4   75..80       MOV     ?V0 + 0,#-0x80
   \   0000F7   78..         MOV     R0,#?V0 + 0
   \   0000F9   12....       LCALL   ?PUSH_XSTACK_I_ONE
   \   0000FC   7408         MOV     A,#0x8
   \   0000FE   12....       LCALL   ?XSTACK_DISP0_8
   \   000101   E0           MOVX    A,@DPTR
   \   000102   2402         ADD     A,#0x2
   \   000104   FC           MOV     R4,A
   \   000105   A3           INC     DPTR
   \   000106   E0           MOVX    A,@DPTR
   \   000107   3400         ADDC    A,#0x0
   \   000109   FD           MOV     R5,A
   \   00010A   7408         MOV     A,#0x8
   \   00010C   12....       LCALL   ?XSTACK_DISP0_8
   \   00010F   E0           MOVX    A,@DPTR
   \   000110   240F         ADD     A,#0xf
   \   000112   F8           MOV     R0,A
   \   000113   A3           INC     DPTR
   \   000114   E0           MOVX    A,@DPTR
   \   000115   3400         ADDC    A,#0x0
   \   000117   F9           MOV     R1,A
   \   000118   8882         MOV     DPL,R0
   \   00011A   8983         MOV     DPH,R1
   \   00011C   E0           MOVX    A,@DPTR
   \   00011D   F9           MOV     R1,A
   \   00011E   7A06         MOV     R2,#0x6
   \   000120   7B80         MOV     R3,#-0x80
   \   000122   12....       LCALL   ??ZDP_EPRsp?relay
   \   000125   7407         MOV     A,#0x7
   \   000127   12....       LCALL   ?DEALLOC_XSTACK8
    731              return;
   \   00012A   02....       LJMP    ??ZDO_ProcessMatchDescReq_1 & 0xFFFF
    732            }
    733            else if ( (ADDR_NOT_BCAST == NLME_IsAddressBroadcast(aoi)) && (aoi != ZDAppNwkAddr.addr.shortAddr) )
   \                     ??ZDO_ProcessMatchDescReq_0:
   \   00012D                ; Setup parameters for call to function NLME_IsAddressBroadcast
   \   00012D   740E         MOV     A,#0xe
   \   00012F   12....       LCALL   ?XSTACK_DISP0_8
   \   000132   E0           MOVX    A,@DPTR
   \   000133   FA           MOV     R2,A
   \   000134   A3           INC     DPTR
   \   000135   E0           MOVX    A,@DPTR
   \   000136   FB           MOV     R3,A
   \   000137   12....       LCALL   ??NLME_IsAddressBroadcast?relay
   \   00013A   E9           MOV     A,R1
   \   00013B   6003         JZ      $+5
   \   00013D   02....       LJMP    ??ZDO_ProcessMatchDescReq_2 & 0xFFFF
   \   000140   740E         MOV     A,#0xe
   \   000142   12....       LCALL   ?XSTACK_DISP0_8
   \   000145   E0           MOVX    A,@DPTR
   \   000146   F8           MOV     R0,A
   \   000147   A3           INC     DPTR
   \   000148   E0           MOVX    A,@DPTR
   \   000149   F9           MOV     R1,A
   \   00014A   90....       MOV     DPTR,#ZDAppNwkAddr
   \   00014D   E0           MOVX    A,@DPTR
   \   00014E   68           XRL     A,R0
   \   00014F   7003         JNZ     ??ZDO_ProcessMatchDescReq_3
   \   000151   A3           INC     DPTR
   \   000152   E0           MOVX    A,@DPTR
   \   000153   69           XRL     A,R1
   \                     ??ZDO_ProcessMatchDescReq_3:
   \   000154   606C         JZ      ??ZDO_ProcessMatchDescReq_2
    734            {
    735              ZDP_MatchDescRsp( inMsg->TransSeq, &(inMsg->srcAddr), ZDP_INVALID_REQTYPE,
    736                                       ZDAppNwkAddr.addr.shortAddr, 0, NULL, inMsg->SecurityUse );
   \   000156                ; Setup parameters for call to function ZDP_EPRsp
   \   000156   7401         MOV     A,#0x1
   \   000158   12....       LCALL   ?XSTACK_DISP0_8
   \   00015B   E0           MOVX    A,@DPTR
   \   00015C   240E         ADD     A,#0xe
   \   00015E   F8           MOV     R0,A
   \   00015F   A3           INC     DPTR
   \   000160   E0           MOVX    A,@DPTR
   \   000161   3400         ADDC    A,#0x0
   \   000163   F9           MOV     R1,A
   \   000164   8882         MOV     DPL,R0
   \   000166   8983         MOV     DPH,R1
   \   000168   E0           MOVX    A,@DPTR
   \   000169   F5..         MOV     ?V0 + 0,A
   \   00016B   78..         MOV     R0,#?V0 + 0
   \   00016D   12....       LCALL   ?PUSH_XSTACK_I_ONE
   \   000170   75..00       MOV     ?V0 + 0,#0x0
   \   000173   75..00       MOV     ?V0 + 1,#0x0
   \   000176   78..         MOV     R0,#?V0 + 0
   \   000178   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   00017B   75..00       MOV     ?V0 + 0,#0x0
   \   00017E   78..         MOV     R0,#?V0 + 0
   \   000180   12....       LCALL   ?PUSH_XSTACK_I_ONE
   \   000183   90....       MOV     DPTR,#ZDAppNwkAddr
   \   000186   12....       LCALL   ?PUSH_XSTACK8_X_TWO
   \   000189   75..80       MOV     ?V0 + 0,#-0x80
   \   00018C   78..         MOV     R0,#?V0 + 0
   \   00018E   12....       LCALL   ?PUSH_XSTACK_I_ONE
   \   000191   7408         MOV     A,#0x8
   \   000193   12....       LCALL   ?XSTACK_DISP0_8
   \   000196   E0           MOVX    A,@DPTR
   \   000197   2402         ADD     A,#0x2
   \   000199   FC           MOV     R4,A
   \   00019A   A3           INC     DPTR
   \   00019B   E0           MOVX    A,@DPTR
   \   00019C   3400         ADDC    A,#0x0
   \   00019E   FD           MOV     R5,A
   \   00019F   7408         MOV     A,#0x8
   \   0001A1   12....       LCALL   ?XSTACK_DISP0_8
   \   0001A4   E0           MOVX    A,@DPTR
   \   0001A5   240F         ADD     A,#0xf
   \   0001A7   F8           MOV     R0,A
   \   0001A8   A3           INC     DPTR
   \   0001A9   E0           MOVX    A,@DPTR
   \   0001AA   3400         ADDC    A,#0x0
   \   0001AC   F9           MOV     R1,A
   \   0001AD   8882         MOV     DPL,R0
   \   0001AF   8983         MOV     DPH,R1
   \   0001B1   E0           MOVX    A,@DPTR
   \   0001B2   F9           MOV     R1,A
   \   0001B3   7A06         MOV     R2,#0x6
   \   0001B5   7B80         MOV     R3,#-0x80
   \   0001B7   12....       LCALL   ??ZDP_EPRsp?relay
   \   0001BA   7407         MOV     A,#0x7
   \   0001BC   12....       LCALL   ?DEALLOC_XSTACK8
    737              return;
   \   0001BF   02....       LJMP    ??ZDO_ProcessMatchDescReq_1 & 0xFFFF
    738            }
    739          
    740            numInClusters = *msg++;
   \                     ??ZDO_ProcessMatchDescReq_2:
   \   0001C2   8E82         MOV     DPL,R6
   \   0001C4   8F83         MOV     DPH,R7
   \   0001C6   E0           MOVX    A,@DPTR
   \   0001C7   F5..         MOV     ?V0 + 3,A
   \   0001C9   8E82         MOV     DPL,R6
   \   0001CB   8F83         MOV     DPH,R7
   \   0001CD   A3           INC     DPTR
   \   0001CE   AE82         MOV     R6,DPL
   \   0001D0   AF83         MOV     R7,DPH
    741            if ( numInClusters )
   \   0001D2   E5..         MOV     A,?V0 + 3
   \   0001D4   6041         JZ      ??ZDO_ProcessMatchDescReq_4
    742            {
    743              inClusters = (uint16*)osal_mem_alloc( numInClusters * sizeof( uint16 ) );
   \   0001D6                ; Setup parameters for call to function osal_mem_alloc
   \   0001D6   AA..         MOV     R2,?V0 + 3
   \   0001D8   7B00         MOV     R3,#0x0
   \   0001DA   EA           MOV     A,R2
   \   0001DB   75F002       MOV     B,#0x2
   \   0001DE   A4           MUL     AB
   \   0001DF   CA           XCH     A,R2
   \   0001E0   ACF0         MOV     R4,B
   \   0001E2   75F000       MOV     B,#0x0
   \   0001E5   A4           MUL     AB
   \   0001E6   2C           ADD     A,R4
   \   0001E7   FC           MOV     R4,A
   \   0001E8   75F002       MOV     B,#0x2
   \   0001EB   EB           MOV     A,R3
   \   0001EC   A4           MUL     AB
   \   0001ED   2C           ADD     A,R4
   \   0001EE   FB           MOV     R3,A
   \   0001EF   12....       LCALL   ??osal_mem_alloc?relay
   \   0001F2   7408         MOV     A,#0x8
   \   0001F4   12....       LCALL   ?XSTACK_DISP0_8
   \   0001F7   EA           MOV     A,R2
   \   0001F8   F0           MOVX    @DPTR,A
   \   0001F9   A3           INC     DPTR
   \   0001FA   EB           MOV     A,R3
   \   0001FB   F0           MOVX    @DPTR,A
    744              msg = ZDO_ConvertOTAClusters( numInClusters, msg, inClusters );
   \   0001FC                ; Setup parameters for call to function ZDO_ConvertOTAClusters
   \   0001FC   7408         MOV     A,#0x8
   \   0001FE   12....       LCALL   ?XSTACK_DISP0_8
   \   000201   E0           MOVX    A,@DPTR
   \   000202   FC           MOV     R4,A
   \   000203   A3           INC     DPTR
   \   000204   E0           MOVX    A,@DPTR
   \   000205   FD           MOV     R5,A
   \   000206   EE           MOV     A,R6
   \   000207   FA           MOV     R2,A
   \   000208   EF           MOV     A,R7
   \   000209   FB           MOV     R3,A
   \   00020A   A9..         MOV     R1,?V0 + 3
   \   00020C   12....       LCALL   ??ZDO_ConvertOTAClusters?relay
   \   00020F   8A..         MOV     ?V0 + 0,R2
   \   000211   8B..         MOV     ?V0 + 1,R3
   \   000213   AE..         MOV     R6,?V0 + 0
   \   000215   AF..         MOV     R7,?V0 + 1
    745            }
    746            numOutClusters = *msg++;
   \                     ??ZDO_ProcessMatchDescReq_4:
   \   000217   8E82         MOV     DPL,R6
   \   000219   8F83         MOV     DPH,R7
   \   00021B   E0           MOVX    A,@DPTR
   \   00021C   85..82       MOV     DPL,?XSP + 0
   \   00021F   85..83       MOV     DPH,?XSP + 1
   \   000222   F0           MOVX    @DPTR,A
   \   000223   8E82         MOV     DPL,R6
   \   000225   8F83         MOV     DPH,R7
   \   000227   A3           INC     DPTR
   \   000228   AE82         MOV     R6,DPL
   \   00022A   AF83         MOV     R7,DPH
    747            if ( numOutClusters )
   \   00022C   85..82       MOV     DPL,?XSP + 0
   \   00022F   85..83       MOV     DPH,?XSP + 1
   \   000232   E0           MOVX    A,@DPTR
   \   000233   6045         JZ      ??ZDO_ProcessMatchDescReq_5
    748            {
    749              outClusters = (uint16 *)osal_mem_alloc( numOutClusters * sizeof( uint16 ) );
   \   000235                ; Setup parameters for call to function osal_mem_alloc
   \   000235   85..82       MOV     DPL,?XSP + 0
   \   000238   85..83       MOV     DPH,?XSP + 1
   \   00023B   E0           MOVX    A,@DPTR
   \   00023C   FA           MOV     R2,A
   \   00023D   7B00         MOV     R3,#0x0
   \   00023F   EA           MOV     A,R2
   \   000240   75F002       MOV     B,#0x2
   \   000243   A4           MUL     AB
   \   000244   CA           XCH     A,R2
   \   000245   ACF0         MOV     R4,B
   \   000247   75F000       MOV     B,#0x0
   \   00024A   A4           MUL     AB
   \   00024B   2C           ADD     A,R4
   \   00024C   FC           MOV     R4,A
   \   00024D   75F002       MOV     B,#0x2
   \   000250   EB           MOV     A,R3
   \   000251   A4           MUL     AB
   \   000252   2C           ADD     A,R4
   \   000253   FB           MOV     R3,A
   \   000254   12....       LCALL   ??osal_mem_alloc?relay
   \   000257   740A         MOV     A,#0xa
   \   000259   12....       LCALL   ?XSTACK_DISP0_8
   \   00025C   EA           MOV     A,R2
   \   00025D   F0           MOVX    @DPTR,A
   \   00025E   A3           INC     DPTR
   \   00025F   EB           MOV     A,R3
   \   000260   F0           MOVX    @DPTR,A
    750              msg = ZDO_ConvertOTAClusters( numOutClusters, msg, outClusters );
   \   000261                ; Setup parameters for call to function ZDO_ConvertOTAClusters
   \   000261   740A         MOV     A,#0xa
   \   000263   12....       LCALL   ?XSTACK_DISP0_8
   \   000266   E0           MOVX    A,@DPTR
   \   000267   FC           MOV     R4,A
   \   000268   A3           INC     DPTR
   \   000269   E0           MOVX    A,@DPTR
   \   00026A   FD           MOV     R5,A
   \   00026B   EE           MOV     A,R6
   \   00026C   FA           MOV     R2,A
   \   00026D   EF           MOV     A,R7
   \   00026E   FB           MOV     R3,A
   \   00026F   85..82       MOV     DPL,?XSP + 0
   \   000272   85..83       MOV     DPH,?XSP + 1
   \   000275   E0           MOVX    A,@DPTR
   \   000276   F9           MOV     R1,A
   \   000277   12....       LCALL   ??ZDO_ConvertOTAClusters?relay
    751            }
    752          
    753            // First count the number of endpoints that match.
    754            epDesc = epList;
   \                     ??ZDO_ProcessMatchDescReq_5:
   \   00027A   90....       MOV     DPTR,#epList
   \   00027D   E0           MOVX    A,@DPTR
   \   00027E   F8           MOV     R0,A
   \   00027F   A3           INC     DPTR
   \   000280   E0           MOVX    A,@DPTR
   \   000281   F9           MOV     R1,A
   \   000282   7403         MOV     A,#0x3
   \   000284   12....       LCALL   ?XSTACK_DISP0_8
   \   000287   E8           MOV     A,R0
   \   000288   F0           MOVX    @DPTR,A
   \   000289   A3           INC     DPTR
   \   00028A   E9           MOV     A,R1
   \   00028B   F0           MOVX    @DPTR,A
    755            while ( epDesc )
   \                     ??ZDO_ProcessMatchDescReq_6:
   \   00028C   7403         MOV     A,#0x3
   \   00028E   12....       LCALL   ?XSTACK_DISP0_8
   \   000291   E0           MOVX    A,@DPTR
   \   000292   6400         XRL     A,#0x0
   \   000294   7004         JNZ     ??ZDO_ProcessMatchDescReq_7
   \   000296   A3           INC     DPTR
   \   000297   E0           MOVX    A,@DPTR
   \   000298   6400         XRL     A,#0x0
   \                     ??ZDO_ProcessMatchDescReq_7:
   \   00029A   7003         JNZ     $+5
   \   00029C   02....       LJMP    ??ZDO_ProcessMatchDescReq_8 & 0xFFFF
    756            {
    757              // Don't search endpoint 0 and check if response is allowed
    758              if ( epDesc->epDesc->endPoint != ZDO_EP && (epDesc->flags&eEP_AllowMatch) )
   \   00029F   7403         MOV     A,#0x3
   \   0002A1   12....       LCALL   ?XSTACK_DISP0_8
   \   0002A4   E0           MOVX    A,@DPTR
   \   0002A5   F8           MOV     R0,A
   \   0002A6   A3           INC     DPTR
   \   0002A7   E0           MOVX    A,@DPTR
   \   0002A8   F583         MOV     DPH,A
   \   0002AA   8882         MOV     DPL,R0
   \   0002AC   E0           MOVX    A,@DPTR
   \   0002AD   F8           MOV     R0,A
   \   0002AE   A3           INC     DPTR
   \   0002AF   E0           MOVX    A,@DPTR
   \   0002B0   F583         MOV     DPH,A
   \   0002B2   8882         MOV     DPL,R0
   \   0002B4   E0           MOVX    A,@DPTR
   \   0002B5   7003         JNZ     $+5
   \   0002B7   02....       LJMP    ??ZDO_ProcessMatchDescReq_9 & 0xFFFF
   \   0002BA   7403         MOV     A,#0x3
   \   0002BC   12....       LCALL   ?XSTACK_DISP0_8
   \   0002BF   E0           MOVX    A,@DPTR
   \   0002C0   F8           MOV     R0,A
   \   0002C1   A3           INC     DPTR
   \   0002C2   E0           MOVX    A,@DPTR
   \   0002C3   F583         MOV     DPH,A
   \   0002C5   8882         MOV     DPL,R0
   \   0002C7   A3           INC     DPTR
   \   0002C8   A3           INC     DPTR
   \   0002C9   E0           MOVX    A,@DPTR
   \   0002CA   A2E0         MOV     C,0xE0 /* A   */.0
   \   0002CC   4003         JC      $+5
   \   0002CE   02....       LJMP    ??ZDO_ProcessMatchDescReq_9 & 0xFFFF
    759              {
    760                if ( epDesc->pfnDescCB )
   \   0002D1   7403         MOV     A,#0x3
   \   0002D3   12....       LCALL   ?XSTACK_DISP0_8
   \   0002D6   E0           MOVX    A,@DPTR
   \   0002D7   F8           MOV     R0,A
   \   0002D8   A3           INC     DPTR
   \   0002D9   E0           MOVX    A,@DPTR
   \   0002DA   F583         MOV     DPH,A
   \   0002DC   8882         MOV     DPL,R0
   \   0002DE   A3           INC     DPTR
   \   0002DF   A3           INC     DPTR
   \   0002E0   A3           INC     DPTR
   \   0002E1   E0           MOVX    A,@DPTR
   \   0002E2   6400         XRL     A,#0x0
   \   0002E4   7004         JNZ     ??ZDO_ProcessMatchDescReq_10
   \   0002E6   A3           INC     DPTR
   \   0002E7   E0           MOVX    A,@DPTR
   \   0002E8   6400         XRL     A,#0x0
   \                     ??ZDO_ProcessMatchDescReq_10:
   \   0002EA   604C         JZ      ??ZDO_ProcessMatchDescReq_11
    761                {
    762                  sDesc = (SimpleDescriptionFormat_t *)epDesc->pfnDescCB( AF_DESCRIPTOR_SIMPLE, epDesc->epDesc->endPoint );
   \   0002EC                ; Setup parameters for indirect call
   \   0002EC   7403         MOV     A,#0x3
   \   0002EE   12....       LCALL   ?XSTACK_DISP0_8
   \   0002F1   E0           MOVX    A,@DPTR
   \   0002F2   F8           MOV     R0,A
   \   0002F3   A3           INC     DPTR
   \   0002F4   E0           MOVX    A,@DPTR
   \   0002F5   F583         MOV     DPH,A
   \   0002F7   8882         MOV     DPL,R0
   \   0002F9   E0           MOVX    A,@DPTR
   \   0002FA   F8           MOV     R0,A
   \   0002FB   A3           INC     DPTR
   \   0002FC   E0           MOVX    A,@DPTR
   \   0002FD   F583         MOV     DPH,A
   \   0002FF   8882         MOV     DPL,R0
   \   000301   E0           MOVX    A,@DPTR
   \   000302   FA           MOV     R2,A
   \   000303   7901         MOV     R1,#0x1
   \   000305   7403         MOV     A,#0x3
   \   000307   12....       LCALL   ?XSTACK_DISP0_8
   \   00030A   E0           MOVX    A,@DPTR
   \   00030B   F8           MOV     R0,A
   \   00030C   A3           INC     DPTR
   \   00030D   E0           MOVX    A,@DPTR
   \   00030E   F583         MOV     DPH,A
   \   000310   8882         MOV     DPL,R0
   \   000312   A3           INC     DPTR
   \   000313   A3           INC     DPTR
   \   000314   A3           INC     DPTR
   \   000315   E0           MOVX    A,@DPTR
   \   000316   F8           MOV     R0,A
   \   000317   A3           INC     DPTR
   \   000318   E0           MOVX    A,@DPTR
   \   000319   F583         MOV     DPH,A
   \   00031B   8882         MOV     DPL,R0
   \   00031D   12....       LCALL   ?CALL_IND
   \   000320   7405         MOV     A,#0x5
   \   000322   12....       LCALL   ?XSTACK_DISP0_8
   \   000325   EA           MOV     A,R2
   \   000326   F0           MOVX    @DPTR,A
   \   000327   A3           INC     DPTR
   \   000328   EB           MOV     A,R3
   \   000329   F0           MOVX    @DPTR,A
    763                  allocated = TRUE;
   \   00032A   7401         MOV     A,#0x1
   \   00032C   C0E0         PUSH    A
   \   00032E   740C         MOV     A,#0xc
   \   000330   12....       LCALL   ?XSTACK_DISP0_8
   \   000333   D0E0         POP     A
   \   000335   F0           MOVX    @DPTR,A
   \   000336   8033         SJMP    ??ZDO_ProcessMatchDescReq_12
    764                }
    765                else
    766                {
    767                  sDesc = epDesc->epDesc->simpleDesc;
   \                     ??ZDO_ProcessMatchDescReq_11:
   \   000338   7403         MOV     A,#0x3
   \   00033A   12....       LCALL   ?XSTACK_DISP0_8
   \   00033D   E0           MOVX    A,@DPTR
   \   00033E   F8           MOV     R0,A
   \   00033F   A3           INC     DPTR
   \   000340   E0           MOVX    A,@DPTR
   \   000341   F583         MOV     DPH,A
   \   000343   8882         MOV     DPL,R0
   \   000345   E0           MOVX    A,@DPTR
   \   000346   F8           MOV     R0,A
   \   000347   A3           INC     DPTR
   \   000348   E0           MOVX    A,@DPTR
   \   000349   F583         MOV     DPH,A
   \   00034B   8882         MOV     DPL,R0
   \   00034D   A3           INC     DPTR
   \   00034E   A3           INC     DPTR
   \   00034F   A3           INC     DPTR
   \   000350   E0           MOVX    A,@DPTR
   \   000351   F8           MOV     R0,A
   \   000352   A3           INC     DPTR
   \   000353   E0           MOVX    A,@DPTR
   \   000354   F9           MOV     R1,A
   \   000355   7405         MOV     A,#0x5
   \   000357   12....       LCALL   ?XSTACK_DISP0_8
   \   00035A   E8           MOV     A,R0
   \   00035B   F0           MOVX    @DPTR,A
   \   00035C   A3           INC     DPTR
   \   00035D   E9           MOV     A,R1
   \   00035E   F0           MOVX    @DPTR,A
    768                  allocated = FALSE;
   \   00035F   7400         MOV     A,#0x0
   \   000361   C0E0         PUSH    A
   \   000363   740C         MOV     A,#0xc
   \   000365   12....       LCALL   ?XSTACK_DISP0_8
   \   000368   D0E0         POP     A
   \   00036A   F0           MOVX    @DPTR,A
    769                }
    770          
    771                if ( sDesc && sDesc->AppProfId == profileID )
   \                     ??ZDO_ProcessMatchDescReq_12:
   \   00036B   7405         MOV     A,#0x5
   \   00036D   12....       LCALL   ?XSTACK_DISP0_8
   \   000370   E0           MOVX    A,@DPTR
   \   000371   6400         XRL     A,#0x0
   \   000373   7004         JNZ     ??ZDO_ProcessMatchDescReq_13
   \   000375   A3           INC     DPTR
   \   000376   E0           MOVX    A,@DPTR
   \   000377   6400         XRL     A,#0x0
   \                     ??ZDO_ProcessMatchDescReq_13:
   \   000379   7003         JNZ     $+5
   \   00037B   02....       LJMP    ??ZDO_ProcessMatchDescReq_14 & 0xFFFF
   \   00037E   7405         MOV     A,#0x5
   \   000380   12....       LCALL   ?XSTACK_DISP0_8
   \   000383   E0           MOVX    A,@DPTR
   \   000384   F8           MOV     R0,A
   \   000385   A3           INC     DPTR
   \   000386   E0           MOVX    A,@DPTR
   \   000387   F583         MOV     DPH,A
   \   000389   8882         MOV     DPL,R0
   \   00038B   A3           INC     DPTR
   \   00038C   E0           MOVX    A,@DPTR
   \   00038D   F8           MOV     R0,A
   \   00038E   A3           INC     DPTR
   \   00038F   E0           MOVX    A,@DPTR
   \   000390   F9           MOV     R1,A
   \   000391   7412         MOV     A,#0x12
   \   000393   12....       LCALL   ?XSTACK_DISP0_8
   \   000396   E0           MOVX    A,@DPTR
   \   000397   68           XRL     A,R0
   \   000398   7003         JNZ     ??ZDO_ProcessMatchDescReq_15
   \   00039A   A3           INC     DPTR
   \   00039B   E0           MOVX    A,@DPTR
   \   00039C   69           XRL     A,R1
   \                     ??ZDO_ProcessMatchDescReq_15:
   \   00039D   6003         JZ      $+5
   \   00039F   02....       LJMP    ??ZDO_ProcessMatchDescReq_14 & 0xFFFF
    772                {
    773                  uint8 *uint8Buf = (uint8 *)ZDOBuildBuf;
   \   0003A2   7410         MOV     A,#0x10
   \   0003A4   12....       LCALL   ?XSTACK_DISP0_8
   \   0003A7   74..         MOV     A,#(ZDOBuildBuf & 0xff)
   \   0003A9   F0           MOVX    @DPTR,A
   \   0003AA   A3           INC     DPTR
   \   0003AB   74..         MOV     A,#((ZDOBuildBuf >> 8) & 0xff)
   \   0003AD   F0           MOVX    @DPTR,A
    774          
    775                  // If there are no search input/ouput clusters - respond
    776                  if ( ((numInClusters == 0) && (numOutClusters == 0))
    777                      // Are there matching input clusters?
    778                       || (ZDO_AnyClusterMatches( numInClusters, inClusters,
    779                            sDesc->AppNumInClusters, sDesc->pAppInClusterList ))
    780                      // Are there matching output clusters?
    781                       || (ZDO_AnyClusterMatches( numOutClusters, outClusters,
    782                            sDesc->AppNumOutClusters, sDesc->pAppOutClusterList ))     )
   \   0003AE   E5..         MOV     A,?V0 + 3
   \   0003B0   700C         JNZ     ??ZDO_ProcessMatchDescReq_16
   \   0003B2   85..82       MOV     DPL,?XSP + 0
   \   0003B5   85..83       MOV     DPH,?XSP + 1
   \   0003B8   E0           MOVX    A,@DPTR
   \   0003B9   7003         JNZ     $+5
   \   0003BB   02....       LJMP    ??ZDO_ProcessMatchDescReq_17 & 0xFFFF
   \                     ??ZDO_ProcessMatchDescReq_16:
   \   0003BE                ; Setup parameters for call to function ZDO_AnyClusterMatches
   \   0003BE   7405         MOV     A,#0x5
   \   0003C0   12....       LCALL   ?XSTACK_DISP0_8
   \   0003C3   E0           MOVX    A,@DPTR
   \   0003C4   F8           MOV     R0,A
   \   0003C5   A3           INC     DPTR
   \   0003C6   E0           MOVX    A,@DPTR
   \   0003C7   F583         MOV     DPH,A
   \   0003C9   8882         MOV     DPL,R0
   \   0003CB   A3           INC     DPTR
   \   0003CC   A3           INC     DPTR
   \   0003CD   A3           INC     DPTR
   \   0003CE   A3           INC     DPTR
   \   0003CF   A3           INC     DPTR
   \   0003D0   A3           INC     DPTR
   \   0003D1   A3           INC     DPTR
   \   0003D2   12....       LCALL   ?PUSH_XSTACK8_X_TWO
   \   0003D5   7407         MOV     A,#0x7
   \   0003D7   12....       LCALL   ?XSTACK_DISP0_8
   \   0003DA   E0           MOVX    A,@DPTR
   \   0003DB   F8           MOV     R0,A
   \   0003DC   A3           INC     DPTR
   \   0003DD   E0           MOVX    A,@DPTR
   \   0003DE   F583         MOV     DPH,A
   \   0003E0   8882         MOV     DPL,R0
   \   0003E2   A3           INC     DPTR
   \   0003E3   A3           INC     DPTR
   \   0003E4   A3           INC     DPTR
   \   0003E5   A3           INC     DPTR
   \   0003E6   A3           INC     DPTR
   \   0003E7   A3           INC     DPTR
   \   0003E8   E0           MOVX    A,@DPTR
   \   0003E9   FC           MOV     R4,A
   \   0003EA   740A         MOV     A,#0xa
   \   0003EC   12....       LCALL   ?XSTACK_DISP0_8
   \   0003EF   E0           MOVX    A,@DPTR
   \   0003F0   FA           MOV     R2,A
   \   0003F1   A3           INC     DPTR
   \   0003F2   E0           MOVX    A,@DPTR
   \   0003F3   FB           MOV     R3,A
   \   0003F4   A9..         MOV     R1,?V0 + 3
   \   0003F6   12....       LCALL   ??ZDO_AnyClusterMatches?relay
   \   0003F9   7402         MOV     A,#0x2
   \   0003FB   12....       LCALL   ?DEALLOC_XSTACK8
   \   0003FE   E9           MOV     A,R1
   \   0003FF   7051         JNZ     ??ZDO_ProcessMatchDescReq_17
   \   000401                ; Setup parameters for call to function ZDO_AnyClusterMatches
   \   000401   7405         MOV     A,#0x5
   \   000403   12....       LCALL   ?XSTACK_DISP0_8
   \   000406   E0           MOVX    A,@DPTR
   \   000407   F8           MOV     R0,A
   \   000408   A3           INC     DPTR
   \   000409   E0           MOVX    A,@DPTR
   \   00040A   F583         MOV     DPH,A
   \   00040C   8882         MOV     DPL,R0
   \   00040E   A3           INC     DPTR
   \   00040F   A3           INC     DPTR
   \   000410   A3           INC     DPTR
   \   000411   A3           INC     DPTR
   \   000412   A3           INC     DPTR
   \   000413   A3           INC     DPTR
   \   000414   A3           INC     DPTR
   \   000415   A3           INC     DPTR
   \   000416   A3           INC     DPTR
   \   000417   A3           INC     DPTR
   \   000418   12....       LCALL   ?PUSH_XSTACK8_X_TWO
   \   00041B   7407         MOV     A,#0x7
   \   00041D   12....       LCALL   ?XSTACK_DISP0_8
   \   000420   E0           MOVX    A,@DPTR
   \   000421   F8           MOV     R0,A
   \   000422   A3           INC     DPTR
   \   000423   E0           MOVX    A,@DPTR
   \   000424   F583         MOV     DPH,A
   \   000426   8882         MOV     DPL,R0
   \   000428   A3           INC     DPTR
   \   000429   A3           INC     DPTR
   \   00042A   A3           INC     DPTR
   \   00042B   A3           INC     DPTR
   \   00042C   A3           INC     DPTR
   \   00042D   A3           INC     DPTR
   \   00042E   A3           INC     DPTR
   \   00042F   A3           INC     DPTR
   \   000430   A3           INC     DPTR
   \   000431   E0           MOVX    A,@DPTR
   \   000432   FC           MOV     R4,A
   \   000433   740C         MOV     A,#0xc
   \   000435   12....       LCALL   ?XSTACK_DISP0_8
   \   000438   E0           MOVX    A,@DPTR
   \   000439   FA           MOV     R2,A
   \   00043A   A3           INC     DPTR
   \   00043B   E0           MOVX    A,@DPTR
   \   00043C   FB           MOV     R3,A
   \   00043D   7402         MOV     A,#0x2
   \   00043F   12....       LCALL   ?XSTACK_DISP0_8
   \   000442   E0           MOVX    A,@DPTR
   \   000443   F9           MOV     R1,A
   \   000444   12....       LCALL   ??ZDO_AnyClusterMatches?relay
   \   000447   7402         MOV     A,#0x2
   \   000449   12....       LCALL   ?DEALLOC_XSTACK8
   \   00044C   E9           MOV     A,R1
   \   00044D   7003         JNZ     $+5
   \   00044F   02....       LJMP    ??ZDO_ProcessMatchDescReq_14 & 0xFFFF
    783                  {
    784                    // Notify the endpoint of the match.
    785                    uint8 bufLen = sizeof( ZDO_MatchDescRspSent_t ) + (numOutClusters + numInClusters) * sizeof(uint16);
   \                     ??ZDO_ProcessMatchDescReq_17:
   \   000452   75F002       MOV     B,#0x2
   \   000455   85..82       MOV     DPL,?XSP + 0
   \   000458   85..83       MOV     DPH,?XSP + 1
   \   00045B   E0           MOVX    A,@DPTR
   \   00045C   F8           MOV     R0,A
   \   00045D   85....       MOV     ?V0 + 0,?V0 + 3
   \   000460   E5..         MOV     A,?V0 + 0
   \   000462   28           ADD     A,R0
   \   000463   A4           MUL     AB
   \   000464   240A         ADD     A,#0xa
   \   000466   C0E0         PUSH    A
   \   000468   740D         MOV     A,#0xd
   \   00046A   12....       LCALL   ?XSTACK_DISP0_8
   \   00046D   D0E0         POP     A
   \   00046F   F0           MOVX    @DPTR,A
    786                    ZDO_MatchDescRspSent_t *pRspSent = (ZDO_MatchDescRspSent_t *) osal_msg_allocate( bufLen );
   \   000470                ; Setup parameters for call to function osal_msg_allocate
   \   000470   740D         MOV     A,#0xd
   \   000472   12....       LCALL   ?XSTACK_DISP0_8
   \   000475   E0           MOVX    A,@DPTR
   \   000476   F5..         MOV     ?V0 + 0,A
   \   000478   AA..         MOV     R2,?V0 + 0
   \   00047A   7B00         MOV     R3,#0x0
   \   00047C   12....       LCALL   ??osal_msg_allocate?relay
   \   00047F   8A..         MOV     ?V0 + 0,R2
   \   000481   8B..         MOV     ?V0 + 1,R3
   \   000483   85....       MOV     ?V0 + 4,?V0 + 0
   \   000486   85....       MOV     ?V0 + 5,?V0 + 1
    787          
    788                    if (pRspSent)
   \   000489   E5..         MOV     A,?V0 + 4
   \   00048B   6400         XRL     A,#0x0
   \   00048D   7004         JNZ     ??ZDO_ProcessMatchDescReq_18
   \   00048F   E5..         MOV     A,?V0 + 5
   \   000491   6400         XRL     A,#0x0
   \                     ??ZDO_ProcessMatchDescReq_18:
   \   000493   7003         JNZ     $+5
   \   000495   02....       LJMP    ??ZDO_ProcessMatchDescReq_19 & 0xFFFF
    789                    {
    790                      pRspSent->hdr.event = ZDO_MATCH_DESC_RSP_SENT;
   \   000498   74D2         MOV     A,#-0x2e
   \   00049A   85..82       MOV     DPL,?V0 + 4
   \   00049D   85..83       MOV     DPH,?V0 + 5
   \   0004A0   F0           MOVX    @DPTR,A
    791                      pRspSent->nwkAddr = inMsg->srcAddr.addr.shortAddr;
   \   0004A1   7401         MOV     A,#0x1
   \   0004A3   12....       LCALL   ?XSTACK_DISP0_8
   \   0004A6   E0           MOVX    A,@DPTR
   \   0004A7   F8           MOV     R0,A
   \   0004A8   A3           INC     DPTR
   \   0004A9   E0           MOVX    A,@DPTR
   \   0004AA   F583         MOV     DPH,A
   \   0004AC   8882         MOV     DPL,R0
   \   0004AE   A3           INC     DPTR
   \   0004AF   A3           INC     DPTR
   \   0004B0   E0           MOVX    A,@DPTR
   \   0004B1   F8           MOV     R0,A
   \   0004B2   A3           INC     DPTR
   \   0004B3   E0           MOVX    A,@DPTR
   \   0004B4   F9           MOV     R1,A
   \   0004B5   85..82       MOV     DPL,?V0 + 4
   \   0004B8   85..83       MOV     DPH,?V0 + 5
   \   0004BB   A3           INC     DPTR
   \   0004BC   A3           INC     DPTR
   \   0004BD   E8           MOV     A,R0
   \   0004BE   F0           MOVX    @DPTR,A
   \   0004BF   A3           INC     DPTR
   \   0004C0   E9           MOV     A,R1
   \   0004C1   F0           MOVX    @DPTR,A
    792                      pRspSent->numInClusters = numInClusters;
   \   0004C2   85..82       MOV     DPL,?V0 + 4
   \   0004C5   85..83       MOV     DPH,?V0 + 5
   \   0004C8   A3           INC     DPTR
   \   0004C9   A3           INC     DPTR
   \   0004CA   A3           INC     DPTR
   \   0004CB   A3           INC     DPTR
   \   0004CC   E5..         MOV     A,?V0 + 3
   \   0004CE   F0           MOVX    @DPTR,A
    793                      pRspSent->numOutClusters = numOutClusters;
   \   0004CF   85..82       MOV     DPL,?XSP + 0
   \   0004D2   85..83       MOV     DPH,?XSP + 1
   \   0004D5   E0           MOVX    A,@DPTR
   \   0004D6   85..82       MOV     DPL,?V0 + 4
   \   0004D9   85..83       MOV     DPH,?V0 + 5
   \   0004DC   A3           INC     DPTR
   \   0004DD   A3           INC     DPTR
   \   0004DE   A3           INC     DPTR
   \   0004DF   A3           INC     DPTR
   \   0004E0   A3           INC     DPTR
   \   0004E1   A3           INC     DPTR
   \   0004E2   A3           INC     DPTR
   \   0004E3   F0           MOVX    @DPTR,A
    794          
    795                      if (numInClusters)
   \   0004E4   E5..         MOV     A,?V0 + 3
   \   0004E6   6061         JZ      ??ZDO_ProcessMatchDescReq_20
    796                      {
    797                        pRspSent->pInClusters = (uint16*) (pRspSent + 1);
   \   0004E8   E5..         MOV     A,?V0 + 4
   \   0004EA   240A         ADD     A,#0xa
   \   0004EC   F8           MOV     R0,A
   \   0004ED   E5..         MOV     A,?V0 + 5
   \   0004EF   3400         ADDC    A,#0x0
   \   0004F1   F9           MOV     R1,A
   \   0004F2   85..82       MOV     DPL,?V0 + 4
   \   0004F5   85..83       MOV     DPH,?V0 + 5
   \   0004F8   A3           INC     DPTR
   \   0004F9   A3           INC     DPTR
   \   0004FA   A3           INC     DPTR
   \   0004FB   A3           INC     DPTR
   \   0004FC   A3           INC     DPTR
   \   0004FD   E8           MOV     A,R0
   \   0004FE   F0           MOVX    @DPTR,A
   \   0004FF   A3           INC     DPTR
   \   000500   E9           MOV     A,R1
   \   000501   F0           MOVX    @DPTR,A
    798                        osal_memcpy(pRspSent->pInClusters, inClusters, numInClusters * sizeof(uint16));
   \   000502                ; Setup parameters for call to function osal_memcpy
   \   000502   7408         MOV     A,#0x8
   \   000504   12....       LCALL   ?XSTACK_DISP0_8
   \   000507   E0           MOVX    A,@DPTR
   \   000508   F5..         MOV     ?V0 + 0,A
   \   00050A   A3           INC     DPTR
   \   00050B   E0           MOVX    A,@DPTR
   \   00050C   F5..         MOV     ?V0 + 1,A
   \   00050E   75..00       MOV     ?V0 + 2,#0x0
   \   000511   78..         MOV     R0,#?V0 + 0
   \   000513   12....       LCALL   ?PUSH_XSTACK_I_THREE
   \   000516   AC..         MOV     R4,?V0 + 3
   \   000518   7D00         MOV     R5,#0x0
   \   00051A   EC           MOV     A,R4
   \   00051B   75F002       MOV     B,#0x2
   \   00051E   A4           MUL     AB
   \   00051F   CC           XCH     A,R4
   \   000520   AAF0         MOV     R2,B
   \   000522   75F000       MOV     B,#0x0
   \   000525   A4           MUL     AB
   \   000526   2A           ADD     A,R2
   \   000527   FA           MOV     R2,A
   \   000528   75F002       MOV     B,#0x2
   \   00052B   ED           MOV     A,R5
   \   00052C   A4           MUL     AB
   \   00052D   2A           ADD     A,R2
   \   00052E   FD           MOV     R5,A
   \   00052F   85..82       MOV     DPL,?V0 + 4
   \   000532   85..83       MOV     DPH,?V0 + 5
   \   000535   A3           INC     DPTR
   \   000536   A3           INC     DPTR
   \   000537   A3           INC     DPTR
   \   000538   A3           INC     DPTR
   \   000539   A3           INC     DPTR
   \   00053A   E0           MOVX    A,@DPTR
   \   00053B   FA           MOV     R2,A
   \   00053C   A3           INC     DPTR
   \   00053D   E0           MOVX    A,@DPTR
   \   00053E   FB           MOV     R3,A
   \   00053F   12....       LCALL   ??osal_memcpy?relay
   \   000542   7403         MOV     A,#0x3
   \   000544   12....       LCALL   ?DEALLOC_XSTACK8
   \   000547   8012         SJMP    ??ZDO_ProcessMatchDescReq_21
    799                      }
    800                      else
    801                      {
    802                        pRspSent->pInClusters = NULL;
   \                     ??ZDO_ProcessMatchDescReq_20:
   \   000549   85..82       MOV     DPL,?V0 + 4
   \   00054C   85..83       MOV     DPH,?V0 + 5
   \   00054F   A3           INC     DPTR
   \   000550   A3           INC     DPTR
   \   000551   A3           INC     DPTR
   \   000552   A3           INC     DPTR
   \   000553   A3           INC     DPTR
   \   000554   7400         MOV     A,#0x0
   \   000556   F0           MOVX    @DPTR,A
   \   000557   A3           INC     DPTR
   \   000558   7400         MOV     A,#0x0
   \   00055A   F0           MOVX    @DPTR,A
    803                      }
    804          
    805                      if (numOutClusters)
   \                     ??ZDO_ProcessMatchDescReq_21:
   \   00055B   85..82       MOV     DPL,?XSP + 0
   \   00055E   85..83       MOV     DPH,?XSP + 1
   \   000561   E0           MOVX    A,@DPTR
   \   000562   7003         JNZ     $+5
   \   000564   02....       LJMP    ??ZDO_ProcessMatchDescReq_22 & 0xFFFF
    806                      {
    807                        pRspSent->pOutClusters = (uint16*)(pRspSent + 1) + numInClusters;
   \   000567   A8..         MOV     R0,?V0 + 3
   \   000569   7900         MOV     R1,#0x0
   \   00056B   E8           MOV     A,R0
   \   00056C   75F002       MOV     B,#0x2
   \   00056F   A4           MUL     AB
   \   000570   C8           XCH     A,R0
   \   000571   AAF0         MOV     R2,B
   \   000573   75F000       MOV     B,#0x0
   \   000576   A4           MUL     AB
   \   000577   2A           ADD     A,R2
   \   000578   FA           MOV     R2,A
   \   000579   75F002       MOV     B,#0x2
   \   00057C   E9           MOV     A,R1
   \   00057D   A4           MUL     AB
   \   00057E   2A           ADD     A,R2
   \   00057F   F9           MOV     R1,A
   \   000580   E5..         MOV     A,?V0 + 4
   \   000582   28           ADD     A,R0
   \   000583   F8           MOV     R0,A
   \   000584   E5..         MOV     A,?V0 + 5
   \   000586   39           ADDC    A,R1
   \   000587   F9           MOV     R1,A
   \   000588   740A         MOV     A,#0xa
   \   00058A   28           ADD     A,R0
   \   00058B   F8           MOV     R0,A
   \   00058C   7400         MOV     A,#0x0
   \   00058E   39           ADDC    A,R1
   \   00058F   F9           MOV     R1,A
   \   000590   85..82       MOV     DPL,?V0 + 4
   \   000593   85..83       MOV     DPH,?V0 + 5
   \   000596   A3           INC     DPTR
   \   000597   A3           INC     DPTR
   \   000598   A3           INC     DPTR
   \   000599   A3           INC     DPTR
   \   00059A   A3           INC     DPTR
   \   00059B   A3           INC     DPTR
   \   00059C   A3           INC     DPTR
   \   00059D   A3           INC     DPTR
   \   00059E   E8           MOV     A,R0
   \   00059F   F0           MOVX    @DPTR,A
   \   0005A0   A3           INC     DPTR
   \   0005A1   E9           MOV     A,R1
   \   0005A2   F0           MOVX    @DPTR,A
    808                        osal_memcpy(pRspSent->pOutClusters, outClusters, numOutClusters * sizeof(uint16));
   \   0005A3                ; Setup parameters for call to function osal_memcpy
   \   0005A3   740A         MOV     A,#0xa
   \   0005A5   12....       LCALL   ?XSTACK_DISP0_8
   \   0005A8   E0           MOVX    A,@DPTR
   \   0005A9   F5..         MOV     ?V0 + 0,A
   \   0005AB   A3           INC     DPTR
   \   0005AC   E0           MOVX    A,@DPTR
   \   0005AD   F5..         MOV     ?V0 + 1,A
   \   0005AF   75..00       MOV     ?V0 + 2,#0x0
   \   0005B2   78..         MOV     R0,#?V0 + 0
   \   0005B4   12....       LCALL   ?PUSH_XSTACK_I_THREE
   \   0005B7   7403         MOV     A,#0x3
   \   0005B9   12....       LCALL   ?XSTACK_DISP0_8
   \   0005BC   E0           MOVX    A,@DPTR
   \   0005BD   FC           MOV     R4,A
   \   0005BE   7D00         MOV     R5,#0x0
   \   0005C0   EC           MOV     A,R4
   \   0005C1   75F002       MOV     B,#0x2
   \   0005C4   A4           MUL     AB
   \   0005C5   CC           XCH     A,R4
   \   0005C6   AAF0         MOV     R2,B
   \   0005C8   75F000       MOV     B,#0x0
   \   0005CB   A4           MUL     AB
   \   0005CC   2A           ADD     A,R2
   \   0005CD   FA           MOV     R2,A
   \   0005CE   75F002       MOV     B,#0x2
   \   0005D1   ED           MOV     A,R5
   \   0005D2   A4           MUL     AB
   \   0005D3   2A           ADD     A,R2
   \   0005D4   FD           MOV     R5,A
   \   0005D5   85..82       MOV     DPL,?V0 + 4
   \   0005D8   85..83       MOV     DPH,?V0 + 5
   \   0005DB   A3           INC     DPTR
   \   0005DC   A3           INC     DPTR
   \   0005DD   A3           INC     DPTR
   \   0005DE   A3           INC     DPTR
   \   0005DF   A3           INC     DPTR
   \   0005E0   A3           INC     DPTR
   \   0005E1   A3           INC     DPTR
   \   0005E2   A3           INC     DPTR
   \   0005E3   E0           MOVX    A,@DPTR
   \   0005E4   FA           MOV     R2,A
   \   0005E5   A3           INC     DPTR
   \   0005E6   E0           MOVX    A,@DPTR
   \   0005E7   FB           MOV     R3,A
   \   0005E8   12....       LCALL   ??osal_memcpy?relay
   \   0005EB   7403         MOV     A,#0x3
   \   0005ED   12....       LCALL   ?DEALLOC_XSTACK8
   \   0005F0   8015         SJMP    ??ZDO_ProcessMatchDescReq_23
    809                      }
    810                      else
    811                      {
    812                        pRspSent->pOutClusters = NULL;
   \                     ??ZDO_ProcessMatchDescReq_22:
   \   0005F2   85..82       MOV     DPL,?V0 + 4
   \   0005F5   85..83       MOV     DPH,?V0 + 5
   \   0005F8   A3           INC     DPTR
   \   0005F9   A3           INC     DPTR
   \   0005FA   A3           INC     DPTR
   \   0005FB   A3           INC     DPTR
   \   0005FC   A3           INC     DPTR
   \   0005FD   A3           INC     DPTR
   \   0005FE   A3           INC     DPTR
   \   0005FF   A3           INC     DPTR
   \   000600   7400         MOV     A,#0x0
   \   000602   F0           MOVX    @DPTR,A
   \   000603   A3           INC     DPTR
   \   000604   7400         MOV     A,#0x0
   \   000606   F0           MOVX    @DPTR,A
    813                      }
    814          
    815                      osal_msg_send( *epDesc->epDesc->task_id, (uint8 *)pRspSent );
   \                     ??ZDO_ProcessMatchDescReq_23:
   \   000607                ; Setup parameters for call to function osal_msg_send
   \   000607   AA..         MOV     R2,?V0 + 4
   \   000609   AB..         MOV     R3,?V0 + 5
   \   00060B   7403         MOV     A,#0x3
   \   00060D   12....       LCALL   ?XSTACK_DISP0_8
   \   000610   E0           MOVX    A,@DPTR
   \   000611   F8           MOV     R0,A
   \   000612   A3           INC     DPTR
   \   000613   E0           MOVX    A,@DPTR
   \   000614   F583         MOV     DPH,A
   \   000616   8882         MOV     DPL,R0
   \   000618   E0           MOVX    A,@DPTR
   \   000619   F8           MOV     R0,A
   \   00061A   A3           INC     DPTR
   \   00061B   E0           MOVX    A,@DPTR
   \   00061C   F583         MOV     DPH,A
   \   00061E   8882         MOV     DPL,R0
   \   000620   A3           INC     DPTR
   \   000621   E0           MOVX    A,@DPTR
   \   000622   F8           MOV     R0,A
   \   000623   A3           INC     DPTR
   \   000624   E0           MOVX    A,@DPTR
   \   000625   F583         MOV     DPH,A
   \   000627   8882         MOV     DPL,R0
   \   000629   E0           MOVX    A,@DPTR
   \   00062A   F9           MOV     R1,A
   \   00062B   12....       LCALL   ??osal_msg_send?relay
    816                    }
    817          
    818                    uint8Buf[epCnt++] = sDesc->EndPoint;
   \                     ??ZDO_ProcessMatchDescReq_19:
   \   00062E   7405         MOV     A,#0x5
   \   000630   12....       LCALL   ?XSTACK_DISP0_8
   \   000633   E0           MOVX    A,@DPTR
   \   000634   F8           MOV     R0,A
   \   000635   A3           INC     DPTR
   \   000636   E0           MOVX    A,@DPTR
   \   000637   F583         MOV     DPH,A
   \   000639   8882         MOV     DPL,R0
   \   00063B   E0           MOVX    A,@DPTR
   \   00063C   C0E0         PUSH    A
   \   00063E   7407         MOV     A,#0x7
   \   000640   12....       LCALL   ?XSTACK_DISP0_8
   \   000643   E0           MOVX    A,@DPTR
   \   000644   F8           MOV     R0,A
   \   000645   7900         MOV     R1,#0x0
   \   000647   7410         MOV     A,#0x10
   \   000649   12....       LCALL   ?XSTACK_DISP0_8
   \   00064C   E0           MOVX    A,@DPTR
   \   00064D   28           ADD     A,R0
   \   00064E   FA           MOV     R2,A
   \   00064F   A3           INC     DPTR
   \   000650   E0           MOVX    A,@DPTR
   \   000651   39           ADDC    A,R1
   \   000652   8A82         MOV     DPL,R2
   \   000654   F583         MOV     DPH,A
   \   000656   D0E0         POP     A
   \   000658   F0           MOVX    @DPTR,A
   \   000659   7407         MOV     A,#0x7
   \   00065B   12....       LCALL   ?XSTACK_DISP0_8
   \   00065E   E0           MOVX    A,@DPTR
   \   00065F   2401         ADD     A,#0x1
   \   000661   F0           MOVX    @DPTR,A
    819                  }
    820                }
    821          
    822                if ( allocated )
   \                     ??ZDO_ProcessMatchDescReq_14:
   \   000662   740C         MOV     A,#0xc
   \   000664   12....       LCALL   ?XSTACK_DISP0_8
   \   000667   E0           MOVX    A,@DPTR
   \   000668   600D         JZ      ??ZDO_ProcessMatchDescReq_9
    823                  osal_mem_free( sDesc );
   \   00066A                ; Setup parameters for call to function osal_mem_free
   \   00066A   7405         MOV     A,#0x5
   \   00066C   12....       LCALL   ?XSTACK_DISP0_8
   \   00066F   E0           MOVX    A,@DPTR
   \   000670   FA           MOV     R2,A
   \   000671   A3           INC     DPTR
   \   000672   E0           MOVX    A,@DPTR
   \   000673   FB           MOV     R3,A
   \   000674   12....       LCALL   ??osal_mem_free?relay
    824              }
    825              epDesc = epDesc->nextDesc;
   \                     ??ZDO_ProcessMatchDescReq_9:
   \   000677   7403         MOV     A,#0x3
   \   000679   12....       LCALL   ?XSTACK_DISP0_8
   \   00067C   E0           MOVX    A,@DPTR
   \   00067D   F8           MOV     R0,A
   \   00067E   A3           INC     DPTR
   \   00067F   E0           MOVX    A,@DPTR
   \   000680   F583         MOV     DPH,A
   \   000682   8882         MOV     DPL,R0
   \   000684   A3           INC     DPTR
   \   000685   A3           INC     DPTR
   \   000686   A3           INC     DPTR
   \   000687   A3           INC     DPTR
   \   000688   A3           INC     DPTR
   \   000689   E0           MOVX    A,@DPTR
   \   00068A   F8           MOV     R0,A
   \   00068B   A3           INC     DPTR
   \   00068C   E0           MOVX    A,@DPTR
   \   00068D   F9           MOV     R1,A
   \   00068E   7403         MOV     A,#0x3
   \   000690   12....       LCALL   ?XSTACK_DISP0_8
   \   000693   E8           MOV     A,R0
   \   000694   F0           MOVX    @DPTR,A
   \   000695   A3           INC     DPTR
   \   000696   E9           MOV     A,R1
   \   000697   F0           MOVX    @DPTR,A
   \   000698   02....       LJMP    ??ZDO_ProcessMatchDescReq_6 & 0xFFFF
    826            }
    827          
    828            // Send the message only if at least one match found.
    829            if ( epCnt )
   \                     ??ZDO_ProcessMatchDescReq_8:
   \   00069B   7407         MOV     A,#0x7
   \   00069D   12....       LCALL   ?XSTACK_DISP0_8
   \   0006A0   E0           MOVX    A,@DPTR
   \   0006A1   606E         JZ      ??ZDO_ProcessMatchDescReq_24
    830            {
    831              if ( ZSuccess == ZDP_MatchDescRsp( inMsg->TransSeq, &(inMsg->srcAddr), ZDP_SUCCESS,
    832                        ZDAppNwkAddr.addr.shortAddr, epCnt, (uint8 *)ZDOBuildBuf, inMsg->SecurityUse ) )
   \   0006A3                ; Setup parameters for call to function ZDP_EPRsp
   \   0006A3   7401         MOV     A,#0x1
   \   0006A5   12....       LCALL   ?XSTACK_DISP0_8
   \   0006A8   E0           MOVX    A,@DPTR
   \   0006A9   240E         ADD     A,#0xe
   \   0006AB   F8           MOV     R0,A
   \   0006AC   A3           INC     DPTR
   \   0006AD   E0           MOVX    A,@DPTR
   \   0006AE   3400         ADDC    A,#0x0
   \   0006B0   F9           MOV     R1,A
   \   0006B1   8882         MOV     DPL,R0
   \   0006B3   8983         MOV     DPH,R1
   \   0006B5   E0           MOVX    A,@DPTR
   \   0006B6   F5..         MOV     ?V0 + 0,A
   \   0006B8   78..         MOV     R0,#?V0 + 0
   \   0006BA   12....       LCALL   ?PUSH_XSTACK_I_ONE
   \   0006BD   75....       MOV     ?V0 + 0,#(ZDOBuildBuf & 0xff)
   \   0006C0   75....       MOV     ?V0 + 1,#((ZDOBuildBuf >> 8) & 0xff)
   \   0006C3   78..         MOV     R0,#?V0 + 0
   \   0006C5   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   0006C8   740A         MOV     A,#0xa
   \   0006CA   12....       LCALL   ?XSTACK_DISP0_8
   \   0006CD   E0           MOVX    A,@DPTR
   \   0006CE   F5..         MOV     ?V0 + 0,A
   \   0006D0   78..         MOV     R0,#?V0 + 0
   \   0006D2   12....       LCALL   ?PUSH_XSTACK_I_ONE
   \   0006D5   90....       MOV     DPTR,#ZDAppNwkAddr
   \   0006D8   12....       LCALL   ?PUSH_XSTACK8_X_TWO
   \   0006DB   75..00       MOV     ?V0 + 0,#0x0
   \   0006DE   78..         MOV     R0,#?V0 + 0
   \   0006E0   12....       LCALL   ?PUSH_XSTACK_I_ONE
   \   0006E3   7408         MOV     A,#0x8
   \   0006E5   12....       LCALL   ?XSTACK_DISP0_8
   \   0006E8   E0           MOVX    A,@DPTR
   \   0006E9   2402         ADD     A,#0x2
   \   0006EB   FC           MOV     R4,A
   \   0006EC   A3           INC     DPTR
   \   0006ED   E0           MOVX    A,@DPTR
   \   0006EE   3400         ADDC    A,#0x0
   \   0006F0   FD           MOV     R5,A
   \   0006F1   7408         MOV     A,#0x8
   \   0006F3   12....       LCALL   ?XSTACK_DISP0_8
   \   0006F6   E0           MOVX    A,@DPTR
   \   0006F7   240F         ADD     A,#0xf
   \   0006F9   F8           MOV     R0,A
   \   0006FA   A3           INC     DPTR
   \   0006FB   E0           MOVX    A,@DPTR
   \   0006FC   3400         ADDC    A,#0x0
   \   0006FE   F9           MOV     R1,A
   \   0006FF   8882         MOV     DPL,R0
   \   000701   8983         MOV     DPH,R1
   \   000703   E0           MOVX    A,@DPTR
   \   000704   F9           MOV     R1,A
   \   000705   7A06         MOV     R2,#0x6
   \   000707   7B80         MOV     R3,#-0x80
   \   000709   12....       LCALL   ??ZDP_EPRsp?relay
   \   00070C   7407         MOV     A,#0x7
   \   00070E   12....       LCALL   ?DEALLOC_XSTACK8
    833              {
    834          #if defined( LCD_SUPPORTED )
    835                HalLcdWriteScreen( "Match Desc Req", "Rsp Sent" );
    836          #endif
    837              }
    838            }
    839            else
    840            {
    841          #if defined( LCD_SUPPORTED )
    842              HalLcdWriteScreen( "Match Desc Req", "Non Matched" );
    843          #endif
    844            }
    845            
    846            if ( inClusters )
   \                     ??ZDO_ProcessMatchDescReq_24:
   \   000711   7408         MOV     A,#0x8
   \   000713   12....       LCALL   ?XSTACK_DISP0_8
   \   000716   E0           MOVX    A,@DPTR
   \   000717   6400         XRL     A,#0x0
   \   000719   7004         JNZ     ??ZDO_ProcessMatchDescReq_25
   \   00071B   A3           INC     DPTR
   \   00071C   E0           MOVX    A,@DPTR
   \   00071D   6400         XRL     A,#0x0
   \                     ??ZDO_ProcessMatchDescReq_25:
   \   00071F   600D         JZ      ??ZDO_ProcessMatchDescReq_26
    847              osal_mem_free( inClusters );
   \   000721                ; Setup parameters for call to function osal_mem_free
   \   000721   7408         MOV     A,#0x8
   \   000723   12....       LCALL   ?XSTACK_DISP0_8
   \   000726   E0           MOVX    A,@DPTR
   \   000727   FA           MOV     R2,A
   \   000728   A3           INC     DPTR
   \   000729   E0           MOVX    A,@DPTR
   \   00072A   FB           MOV     R3,A
   \   00072B   12....       LCALL   ??osal_mem_free?relay
    848            if ( outClusters )
   \                     ??ZDO_ProcessMatchDescReq_26:
   \   00072E   740A         MOV     A,#0xa
   \   000730   12....       LCALL   ?XSTACK_DISP0_8
   \   000733   E0           MOVX    A,@DPTR
   \   000734   6400         XRL     A,#0x0
   \   000736   7004         JNZ     ??ZDO_ProcessMatchDescReq_27
   \   000738   A3           INC     DPTR
   \   000739   E0           MOVX    A,@DPTR
   \   00073A   6400         XRL     A,#0x0
   \                     ??ZDO_ProcessMatchDescReq_27:
   \   00073C   600D         JZ      ??ZDO_ProcessMatchDescReq_1
    849              osal_mem_free( outClusters );
   \   00073E                ; Setup parameters for call to function osal_mem_free
   \   00073E   740A         MOV     A,#0xa
   \   000740   12....       LCALL   ?XSTACK_DISP0_8
   \   000743   E0           MOVX    A,@DPTR
   \   000744   FA           MOV     R2,A
   \   000745   A3           INC     DPTR
   \   000746   E0           MOVX    A,@DPTR
   \   000747   FB           MOV     R3,A
   \   000748   12....       LCALL   ??osal_mem_free?relay
   \                     ??ZDO_ProcessMatchDescReq_1:
   \   00074B   7414         MOV     A,#0x14
   \   00074D   12....       LCALL   ?DEALLOC_XSTACK8
   \   000750   7F06         MOV     R7,#0x6
   \   000752   02....       LJMP    ?BANKED_LEAVE_XDATA
    850          }
    851          
    852          /*********************************************************************
    853           * @fn      ZDO_ProcessBindUnbindReq()
    854           *
    855           * @brief   Called to process a Bind or Unbind Request message.
    856           *
    857           * @param   inMsg  - incoming message (request)
    858           * @param   pReq - place to put parsed information
    859           *
    860           * @return  none
    861           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    862          void ZDO_ProcessBindUnbindReq( zdoIncomingMsg_t *inMsg, ZDO_BindUnbindReq_t *pReq )
   \                     ZDO_ProcessBindUnbindReq:
    863          {
   \   000000   74F4         MOV     A,#-0xc
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 12
   \   000005                ; Auto size: 12
   \   000005   74F4         MOV     A,#-0xc
   \   000007   12....       LCALL   ?ALLOC_XSTACK8
   \   00000A   8A..         MOV     ?V0 + 0,R2
   \   00000C   8B..         MOV     ?V0 + 1,R3
   \   00000E   EC           MOV     A,R4
   \   00000F   FE           MOV     R6,A
   \   000010   ED           MOV     A,R5
   \   000011   FF           MOV     R7,A
    864            zAddrType_t SourceAddr;       // Binding Source addres
    865            byte bindStat;
    866          
    867            SourceAddr.addrMode = Addr64Bit;
   \   000012   7403         MOV     A,#0x3
   \   000014   C0E0         PUSH    A
   \   000016   740B         MOV     A,#0xb
   \   000018   12....       LCALL   ?XSTACK_DISP0_8
   \   00001B   D0E0         POP     A
   \   00001D   F0           MOVX    @DPTR,A
    868            osal_cpyExtAddr( SourceAddr.addr.extAddr, pReq->srcAddress );
   \   00001E                ; Setup parameters for call to function osal_cpyExtAddr
   \   00001E   EE           MOV     A,R6
   \   00001F   FC           MOV     R4,A
   \   000020   EF           MOV     A,R7
   \   000021   FD           MOV     R5,A
   \   000022   7403         MOV     A,#0x3
   \   000024   12....       LCALL   ?XSTACK_DISP0_8
   \   000027   AA82         MOV     R2,DPL
   \   000029   AB83         MOV     R3,DPH
   \   00002B   12....       LCALL   ??osal_cpyExtAddr?relay
    869          
    870          
    871            // If the local device is not the primary binding cache
    872            // check the src address of the bind request.
    873            // If it is not the local device's extended address
    874            // discard the request.
    875            if ( !osal_ExtAddrEqual( SourceAddr.addr.extAddr, NLME_GetExtAddr()) ||
    876                  (pReq->dstAddress.addrMode != Addr64Bit &&
    877                   pReq->dstAddress.addrMode != AddrGroup) )
   \   00002E                ; Setup parameters for call to function osal_ExtAddrEqual
   \   00002E                ; Setup parameters for call to function NLME_GetExtAddr
   \   00002E   12....       LCALL   ??NLME_GetExtAddr?relay
   \   000031   EA           MOV     A,R2
   \   000032   FC           MOV     R4,A
   \   000033   EB           MOV     A,R3
   \   000034   FD           MOV     R5,A
   \   000035   7403         MOV     A,#0x3
   \   000037   12....       LCALL   ?XSTACK_DISP0_8
   \   00003A   AA82         MOV     R2,DPL
   \   00003C   AB83         MOV     R3,DPH
   \   00003E   12....       LCALL   ??osal_ExtAddrEqual?relay
   \   000041   E9           MOV     A,R1
   \   000042   601E         JZ      ??ZDO_ProcessBindUnbindReq_0
   \   000044   EE           MOV     A,R6
   \   000045   2413         ADD     A,#0x13
   \   000047   F582         MOV     DPL,A
   \   000049   EF           MOV     A,R7
   \   00004A   3400         ADDC    A,#0x0
   \   00004C   F583         MOV     DPH,A
   \   00004E   E0           MOVX    A,@DPTR
   \   00004F   6403         XRL     A,#0x3
   \   000051   601B         JZ      ??ZDO_ProcessBindUnbindReq_1
   \   000053   EE           MOV     A,R6
   \   000054   2413         ADD     A,#0x13
   \   000056   F582         MOV     DPL,A
   \   000058   EF           MOV     A,R7
   \   000059   3400         ADDC    A,#0x0
   \   00005B   F583         MOV     DPH,A
   \   00005D   E0           MOVX    A,@DPTR
   \   00005E   6401         XRL     A,#0x1
   \   000060   600C         JZ      ??ZDO_ProcessBindUnbindReq_1
    878            {
    879              bindStat = ZDP_NOT_SUPPORTED;
   \                     ??ZDO_ProcessBindUnbindReq_0:
   \   000062   7484         MOV     A,#-0x7c
   \   000064   85..82       MOV     DPL,?XSP + 0
   \   000067   85..83       MOV     DPH,?XSP + 1
   \   00006A   F0           MOVX    @DPTR,A
   \   00006B   02....       LJMP    ??ZDO_ProcessBindUnbindReq_2 & 0xFFFF
    880            }
    881            else
    882            {
    883              // Check source & destination endpoints
    884              if ( (pReq->srcEndpoint == 0 || pReq->srcEndpoint > MAX_ENDPOINTS)
    885                  || (( pReq->dstAddress.addrMode == Addr64Bit ) &&
    886                      (pReq->dstEndpoint == 0 || pReq->dstEndpoint > MAX_ENDPOINTS)) )
   \                     ??ZDO_ProcessBindUnbindReq_1:
   \   00006E   8E82         MOV     DPL,R6
   \   000070   8F83         MOV     DPH,R7
   \   000072   A3           INC     DPTR
   \   000073   A3           INC     DPTR
   \   000074   A3           INC     DPTR
   \   000075   A3           INC     DPTR
   \   000076   A3           INC     DPTR
   \   000077   A3           INC     DPTR
   \   000078   A3           INC     DPTR
   \   000079   A3           INC     DPTR
   \   00007A   E0           MOVX    A,@DPTR
   \   00007B   603E         JZ      ??ZDO_ProcessBindUnbindReq_3
   \   00007D   8E82         MOV     DPL,R6
   \   00007F   8F83         MOV     DPH,R7
   \   000081   A3           INC     DPTR
   \   000082   A3           INC     DPTR
   \   000083   A3           INC     DPTR
   \   000084   A3           INC     DPTR
   \   000085   A3           INC     DPTR
   \   000086   A3           INC     DPTR
   \   000087   A3           INC     DPTR
   \   000088   A3           INC     DPTR
   \   000089   E0           MOVX    A,@DPTR
   \   00008A   C3           CLR     C
   \   00008B   94F1         SUBB    A,#-0xf
   \   00008D   502C         JNC     ??ZDO_ProcessBindUnbindReq_3
   \   00008F   EE           MOV     A,R6
   \   000090   2413         ADD     A,#0x13
   \   000092   F582         MOV     DPL,A
   \   000094   EF           MOV     A,R7
   \   000095   3400         ADDC    A,#0x0
   \   000097   F583         MOV     DPH,A
   \   000099   E0           MOVX    A,@DPTR
   \   00009A   6403         XRL     A,#0x3
   \   00009C   7029         JNZ     ??ZDO_ProcessBindUnbindReq_4
   \   00009E   EE           MOV     A,R6
   \   00009F   2414         ADD     A,#0x14
   \   0000A1   F582         MOV     DPL,A
   \   0000A3   EF           MOV     A,R7
   \   0000A4   3400         ADDC    A,#0x0
   \   0000A6   F583         MOV     DPH,A
   \   0000A8   E0           MOVX    A,@DPTR
   \   0000A9   6010         JZ      ??ZDO_ProcessBindUnbindReq_3
   \   0000AB   EE           MOV     A,R6
   \   0000AC   2414         ADD     A,#0x14
   \   0000AE   F582         MOV     DPL,A
   \   0000B0   EF           MOV     A,R7
   \   0000B1   3400         ADDC    A,#0x0
   \   0000B3   F583         MOV     DPH,A
   \   0000B5   E0           MOVX    A,@DPTR
   \   0000B6   C3           CLR     C
   \   0000B7   94F1         SUBB    A,#-0xf
   \   0000B9   400C         JC      ??ZDO_ProcessBindUnbindReq_4
    887              {
    888                bindStat = ZDP_INVALID_EP;
   \                     ??ZDO_ProcessBindUnbindReq_3:
   \   0000BB   7482         MOV     A,#-0x7e
   \   0000BD   85..82       MOV     DPL,?XSP + 0
   \   0000C0   85..83       MOV     DPH,?XSP + 1
   \   0000C3   F0           MOVX    @DPTR,A
   \   0000C4   02....       LJMP    ??ZDO_ProcessBindUnbindReq_2 & 0xFFFF
    889              }
    890              else
    891              {
    892                if ( inMsg->clusterID == Bind_req )
   \                     ??ZDO_ProcessBindUnbindReq_4:
   \   0000C7   E5..         MOV     A,?V0 + 0
   \   0000C9   240C         ADD     A,#0xc
   \   0000CB   F582         MOV     DPL,A
   \   0000CD   E5..         MOV     A,?V0 + 1
   \   0000CF   3400         ADDC    A,#0x0
   \   0000D1   F583         MOV     DPH,A
   \   0000D3   E0           MOVX    A,@DPTR
   \   0000D4   6421         XRL     A,#0x21
   \   0000D6   7004         JNZ     ??ZDO_ProcessBindUnbindReq_5
   \   0000D8   A3           INC     DPTR
   \   0000D9   E0           MOVX    A,@DPTR
   \   0000DA   6400         XRL     A,#0x0
   \                     ??ZDO_ProcessBindUnbindReq_5:
   \   0000DC   7037         JNZ     ??ZDO_ProcessBindUnbindReq_6
    893                {
    894                  uint16 nwkAddr;
    895          
    896                  // Check for the destination address
    897                  if ( pReq->dstAddress.addrMode == Addr64Bit )
   \   0000DE   EE           MOV     A,R6
   \   0000DF   2413         ADD     A,#0x13
   \   0000E1   F582         MOV     DPL,A
   \   0000E3   EF           MOV     A,R7
   \   0000E4   3400         ADDC    A,#0x0
   \   0000E6   F583         MOV     DPH,A
   \   0000E8   E0           MOVX    A,@DPTR
   \   0000E9   6403         XRL     A,#0x3
   \   0000EB   7028         JNZ     ??ZDO_ProcessBindUnbindReq_6
    898                  {
    899                    if ( APSME_LookupNwkAddr( pReq->dstAddress.addr.extAddr, &nwkAddr ) == FALSE )
   \   0000ED                ; Setup parameters for call to function APSME_LookupNwkAddr
   \   0000ED   7401         MOV     A,#0x1
   \   0000EF   12....       LCALL   ?XSTACK_DISP0_8
   \   0000F2   AC82         MOV     R4,DPL
   \   0000F4   AD83         MOV     R5,DPH
   \   0000F6   EE           MOV     A,R6
   \   0000F7   240B         ADD     A,#0xb
   \   0000F9   FA           MOV     R2,A
   \   0000FA   EF           MOV     A,R7
   \   0000FB   3400         ADDC    A,#0x0
   \   0000FD   FB           MOV     R3,A
   \   0000FE   12....       LCALL   ??APSME_LookupNwkAddr?relay
   \   000101   E9           MOV     A,R1
   \   000102   7011         JNZ     ??ZDO_ProcessBindUnbindReq_6
    900                    {
    901                      ZDP_NwkAddrReq( pReq->dstAddress.addr.extAddr, ZDP_ADDR_REQTYPE_SINGLE, 0, 0 );
   \   000104                ; Setup parameters for call to function ZDP_NwkAddrReq
   \   000104   7D00         MOV     R5,#0x0
   \   000106   7C00         MOV     R4,#0x0
   \   000108   7900         MOV     R1,#0x0
   \   00010A   EE           MOV     A,R6
   \   00010B   240B         ADD     A,#0xb
   \   00010D   FA           MOV     R2,A
   \   00010E   EF           MOV     A,R7
   \   00010F   3400         ADDC    A,#0x0
   \   000111   FB           MOV     R3,A
   \   000112   12....       LCALL   ??ZDP_NwkAddrReq?relay
    902                    }
    903                  }
    904                }
    905          
    906                if ( inMsg->clusterID == Bind_req )
   \                     ??ZDO_ProcessBindUnbindReq_6:
   \   000115   E5..         MOV     A,?V0 + 0
   \   000117   240C         ADD     A,#0xc
   \   000119   F582         MOV     DPL,A
   \   00011B   E5..         MOV     A,?V0 + 1
   \   00011D   3400         ADDC    A,#0x0
   \   00011F   F583         MOV     DPH,A
   \   000121   E0           MOVX    A,@DPTR
   \   000122   6421         XRL     A,#0x21
   \   000124   7004         JNZ     ??ZDO_ProcessBindUnbindReq_7
   \   000126   A3           INC     DPTR
   \   000127   E0           MOVX    A,@DPTR
   \   000128   6400         XRL     A,#0x0
   \                     ??ZDO_ProcessBindUnbindReq_7:
   \   00012A   705E         JNZ     ??ZDO_ProcessBindUnbindReq_8
    907                {
    908                  if ( APSME_BindRequest( pReq->srcEndpoint, pReq->clusterID,
    909                                 &(pReq->dstAddress), pReq->dstEndpoint ) == ZSuccess )
   \   00012C                ; Setup parameters for call to function APSME_BindRequest
   \   00012C   EE           MOV     A,R6
   \   00012D   2414         ADD     A,#0x14
   \   00012F   F582         MOV     DPL,A
   \   000131   EF           MOV     A,R7
   \   000132   3400         ADDC    A,#0x0
   \   000134   F583         MOV     DPH,A
   \   000136   E0           MOVX    A,@DPTR
   \   000137   F5..         MOV     ?V0 + 2,A
   \   000139   78..         MOV     R0,#?V0 + 2
   \   00013B   12....       LCALL   ?PUSH_XSTACK_I_ONE
   \   00013E   EE           MOV     A,R6
   \   00013F   240B         ADD     A,#0xb
   \   000141   FC           MOV     R4,A
   \   000142   EF           MOV     A,R7
   \   000143   3400         ADDC    A,#0x0
   \   000145   FD           MOV     R5,A
   \   000146   8E82         MOV     DPL,R6
   \   000148   8F83         MOV     DPH,R7
   \   00014A   A3           INC     DPTR
   \   00014B   A3           INC     DPTR
   \   00014C   A3           INC     DPTR
   \   00014D   A3           INC     DPTR
   \   00014E   A3           INC     DPTR
   \   00014F   A3           INC     DPTR
   \   000150   A3           INC     DPTR
   \   000151   A3           INC     DPTR
   \   000152   A3           INC     DPTR
   \   000153   E0           MOVX    A,@DPTR
   \   000154   FA           MOV     R2,A
   \   000155   A3           INC     DPTR
   \   000156   E0           MOVX    A,@DPTR
   \   000157   FB           MOV     R3,A
   \   000158   8E82         MOV     DPL,R6
   \   00015A   8F83         MOV     DPH,R7
   \   00015C   A3           INC     DPTR
   \   00015D   A3           INC     DPTR
   \   00015E   A3           INC     DPTR
   \   00015F   A3           INC     DPTR
   \   000160   A3           INC     DPTR
   \   000161   A3           INC     DPTR
   \   000162   A3           INC     DPTR
   \   000163   A3           INC     DPTR
   \   000164   E0           MOVX    A,@DPTR
   \   000165   F9           MOV     R1,A
   \   000166   12....       LCALL   ??APSME_BindRequest?relay
   \   000169   7401         MOV     A,#0x1
   \   00016B   12....       LCALL   ?DEALLOC_XSTACK8
   \   00016E   E9           MOV     A,R1
   \   00016F   700E         JNZ     ??ZDO_ProcessBindUnbindReq_9
    910                  {
    911                    bindStat = ZDP_SUCCESS;
   \   000171   7400         MOV     A,#0x0
   \   000173   85..82       MOV     DPL,?XSP + 0
   \   000176   85..83       MOV     DPH,?XSP + 1
   \   000179   F0           MOVX    @DPTR,A
    912                    // Notify to save info into NV
    913                    ZDApp_NVUpdate();
   \   00017A                ; Setup parameters for call to function ZDApp_NVUpdate
   \   00017A   12....       LCALL   ??ZDApp_NVUpdate?relay
   \   00017D   8067         SJMP    ??ZDO_ProcessBindUnbindReq_2
    914                  }
    915                  else
    916                    bindStat = ZDP_TABLE_FULL;
   \                     ??ZDO_ProcessBindUnbindReq_9:
   \   00017F   7487         MOV     A,#-0x79
   \   000181   85..82       MOV     DPL,?XSP + 0
   \   000184   85..83       MOV     DPH,?XSP + 1
   \   000187   F0           MOVX    @DPTR,A
   \   000188   805C         SJMP    ??ZDO_ProcessBindUnbindReq_2
    917                }
    918                else // Unbind_req
    919                {
    920                  if ( APSME_UnBindRequest( pReq->srcEndpoint, pReq->clusterID,
    921                                 &(pReq->dstAddress), pReq->dstEndpoint ) == ZSuccess )
   \                     ??ZDO_ProcessBindUnbindReq_8:
   \   00018A                ; Setup parameters for call to function APSME_UnBindRequest
   \   00018A   EE           MOV     A,R6
   \   00018B   2414         ADD     A,#0x14
   \   00018D   F582         MOV     DPL,A
   \   00018F   EF           MOV     A,R7
   \   000190   3400         ADDC    A,#0x0
   \   000192   F583         MOV     DPH,A
   \   000194   E0           MOVX    A,@DPTR
   \   000195   F5..         MOV     ?V0 + 2,A
   \   000197   78..         MOV     R0,#?V0 + 2
   \   000199   12....       LCALL   ?PUSH_XSTACK_I_ONE
   \   00019C   EE           MOV     A,R6
   \   00019D   240B         ADD     A,#0xb
   \   00019F   FC           MOV     R4,A
   \   0001A0   EF           MOV     A,R7
   \   0001A1   3400         ADDC    A,#0x0
   \   0001A3   FD           MOV     R5,A
   \   0001A4   8E82         MOV     DPL,R6
   \   0001A6   8F83         MOV     DPH,R7
   \   0001A8   A3           INC     DPTR
   \   0001A9   A3           INC     DPTR
   \   0001AA   A3           INC     DPTR
   \   0001AB   A3           INC     DPTR
   \   0001AC   A3           INC     DPTR
   \   0001AD   A3           INC     DPTR
   \   0001AE   A3           INC     DPTR
   \   0001AF   A3           INC     DPTR
   \   0001B0   A3           INC     DPTR
   \   0001B1   E0           MOVX    A,@DPTR
   \   0001B2   FA           MOV     R2,A
   \   0001B3   A3           INC     DPTR
   \   0001B4   E0           MOVX    A,@DPTR
   \   0001B5   FB           MOV     R3,A
   \   0001B6   8E82         MOV     DPL,R6
   \   0001B8   8F83         MOV     DPH,R7
   \   0001BA   A3           INC     DPTR
   \   0001BB   A3           INC     DPTR
   \   0001BC   A3           INC     DPTR
   \   0001BD   A3           INC     DPTR
   \   0001BE   A3           INC     DPTR
   \   0001BF   A3           INC     DPTR
   \   0001C0   A3           INC     DPTR
   \   0001C1   A3           INC     DPTR
   \   0001C2   E0           MOVX    A,@DPTR
   \   0001C3   F9           MOV     R1,A
   \   0001C4   12....       LCALL   ??APSME_UnBindRequest?relay
   \   0001C7   7401         MOV     A,#0x1
   \   0001C9   12....       LCALL   ?DEALLOC_XSTACK8
   \   0001CC   E9           MOV     A,R1
   \   0001CD   700E         JNZ     ??ZDO_ProcessBindUnbindReq_10
    922                  {
    923                    bindStat = ZDP_SUCCESS;
   \   0001CF   7400         MOV     A,#0x0
   \   0001D1   85..82       MOV     DPL,?XSP + 0
   \   0001D4   85..83       MOV     DPH,?XSP + 1
   \   0001D7   F0           MOVX    @DPTR,A
    924          
    925                    // Notify to save info into NV
    926                    ZDApp_NVUpdate();
   \   0001D8                ; Setup parameters for call to function ZDApp_NVUpdate
   \   0001D8   12....       LCALL   ??ZDApp_NVUpdate?relay
   \   0001DB   8009         SJMP    ??ZDO_ProcessBindUnbindReq_2
    927                  }
    928                  else
    929                    bindStat = ZDP_NO_ENTRY;
   \                     ??ZDO_ProcessBindUnbindReq_10:
   \   0001DD   7488         MOV     A,#-0x78
   \   0001DF   85..82       MOV     DPL,?XSP + 0
   \   0001E2   85..83       MOV     DPH,?XSP + 1
   \   0001E5   F0           MOVX    @DPTR,A
    930                }
    931              }
    932            }
    933          
    934            // Send back a response message
    935            ZDP_SendData( &(inMsg->TransSeq), &(inMsg->srcAddr),
    936                         (inMsg->clusterID | ZDO_RESPONSE_BIT), 1, &bindStat,
    937                         inMsg->SecurityUse );
   \                     ??ZDO_ProcessBindUnbindReq_2:
   \   0001E6                ; Setup parameters for call to function ZDP_SendData
   \   0001E6   E5..         MOV     A,?V0 + 0
   \   0001E8   240E         ADD     A,#0xe
   \   0001EA   F582         MOV     DPL,A
   \   0001EC   E5..         MOV     A,?V0 + 1
   \   0001EE   3400         ADDC    A,#0x0
   \   0001F0   F583         MOV     DPH,A
   \   0001F2   E0           MOVX    A,@DPTR
   \   0001F3   F5..         MOV     ?V0 + 2,A
   \   0001F5   78..         MOV     R0,#?V0 + 2
   \   0001F7   12....       LCALL   ?PUSH_XSTACK_I_ONE
   \   0001FA   7401         MOV     A,#0x1
   \   0001FC   12....       LCALL   ?XSTACK_DISP0_8
   \   0001FF   8582..       MOV     ?V0 + 2,DPL
   \   000202   8583..       MOV     ?V0 + 3,DPH
   \   000205   78..         MOV     R0,#?V0 + 2
   \   000207   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   00020A   E5..         MOV     A,?V0 + 0
   \   00020C   240C         ADD     A,#0xc
   \   00020E   F582         MOV     DPL,A
   \   000210   E5..         MOV     A,?V0 + 1
   \   000212   3400         ADDC    A,#0x0
   \   000214   F583         MOV     DPH,A
   \   000216   E0           MOVX    A,@DPTR
   \   000217   4400         ORL     A,#0x0
   \   000219   F5..         MOV     ?V0 + 2,A
   \   00021B   A3           INC     DPTR
   \   00021C   E0           MOVX    A,@DPTR
   \   00021D   4480         ORL     A,#0x80
   \   00021F   F5..         MOV     ?V0 + 3,A
   \   000221   78..         MOV     R0,#?V0 + 2
   \   000223   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   000226   7901         MOV     R1,#0x1
   \   000228   E5..         MOV     A,?V0 + 0
   \   00022A   2402         ADD     A,#0x2
   \   00022C   FC           MOV     R4,A
   \   00022D   E5..         MOV     A,?V0 + 1
   \   00022F   3400         ADDC    A,#0x0
   \   000231   FD           MOV     R5,A
   \   000232   E5..         MOV     A,?V0 + 0
   \   000234   240F         ADD     A,#0xf
   \   000236   FA           MOV     R2,A
   \   000237   E5..         MOV     A,?V0 + 1
   \   000239   3400         ADDC    A,#0x0
   \   00023B   FB           MOV     R3,A
   \   00023C   12....       LCALL   ??ZDP_SendData?relay
   \   00023F   7405         MOV     A,#0x5
   \   000241   12....       LCALL   ?DEALLOC_XSTACK8
    938          }
   \   000244   740C         MOV     A,#0xc
   \   000246   12....       LCALL   ?DEALLOC_XSTACK8
   \   000249   7F04         MOV     R7,#0x4
   \   00024B   02....       LJMP    ?BANKED_LEAVE_XDATA
    939          
    940          /*********************************************************************
    941           * @fn      ZDO_UpdateAddrManager
    942           *
    943           * @brief   Update the Address Manager.
    944           *
    945           * @param   nwkAddr - network address
    946           * @param   extAddr - extended address
    947           *
    948           * @return  none
    949           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    950          void ZDO_UpdateAddrManager( uint16 nwkAddr, uint8 *extAddr )
   \                     ZDO_UpdateAddrManager:
    951          {
   \   000000   74F6         MOV     A,#-0xa
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 10
   \   000005                ; Auto size: 13
   \   000005   74F3         MOV     A,#-0xd
   \   000007   12....       LCALL   ?ALLOC_XSTACK8
   \   00000A   EA           MOV     A,R2
   \   00000B   FE           MOV     R6,A
   \   00000C   EB           MOV     A,R3
   \   00000D   FF           MOV     R7,A
   \   00000E   8C..         MOV     ?V0 + 0,R4
   \   000010   8D..         MOV     ?V0 + 1,R5
    952            AddrMgrEntry_t addrEntry;
    953          
    954            // Update the address manager
    955            addrEntry.user = ADDRMGR_USER_DEFAULT;
   \   000012   7400         MOV     A,#0x0
   \   000014   85..82       MOV     DPL,?XSP + 0
   \   000017   85..83       MOV     DPH,?XSP + 1
   \   00001A   F0           MOVX    @DPTR,A
    956            addrEntry.nwkAddr = nwkAddr;
   \   00001B   7401         MOV     A,#0x1
   \   00001D   12....       LCALL   ?XSTACK_DISP0_8
   \   000020   EE           MOV     A,R6
   \   000021   F0           MOVX    @DPTR,A
   \   000022   A3           INC     DPTR
   \   000023   EF           MOV     A,R7
   \   000024   F0           MOVX    @DPTR,A
    957            AddrMgrExtAddrSet( addrEntry.extAddr, extAddr );
   \   000025                ; Setup parameters for call to function AddrMgrExtAddrSet
   \   000025   AC..         MOV     R4,?V0 + 0
   \   000027   AD..         MOV     R5,?V0 + 1
   \   000029   7403         MOV     A,#0x3
   \   00002B   12....       LCALL   ?XSTACK_DISP0_8
   \   00002E   AA82         MOV     R2,DPL
   \   000030   AB83         MOV     R3,DPH
   \   000032   12....       LCALL   ??AddrMgrExtAddrSet?relay
    958            AddrMgrEntryUpdate( &addrEntry );
   \   000035                ; Setup parameters for call to function AddrMgrEntryUpdate
   \   000035   85..82       MOV     DPL,?XSP + 0
   \   000038   85..83       MOV     DPH,?XSP + 1
   \   00003B   AA82         MOV     R2,DPL
   \   00003D   AB83         MOV     R3,DPH
   \   00003F   12....       LCALL   ??AddrMgrEntryUpdate?relay
    959          }
   \   000042   740D         MOV     A,#0xd
   \   000044   12....       LCALL   ?DEALLOC_XSTACK8
   \   000047   7F02         MOV     R7,#0x2
   \   000049   02....       LJMP    ?BANKED_LEAVE_XDATA
    960          
    961          #if defined ( ZDO_SERVERDISC_RESPONSE )
    962          /*********************************************************************
    963           * @fn          ZDO_ProcessServerDiscReq
    964           *
    965           * @brief       Process the Server_Discovery_req message.
    966           *
    967           * @param   inMsg  - incoming message (request)
    968           *
    969           * @return      none
    970           */
    971          void ZDO_ProcessServerDiscReq( zdoIncomingMsg_t *inMsg )
    972          {
    973            uint16 serverMask = BUILD_UINT16( inMsg->asdu[0], inMsg->asdu[1] );
    974            uint16 matchMask = serverMask & ZDO_Config_Node_Descriptor.ServerMask;
    975          
    976            if ( matchMask )
    977            {
    978              ZDP_ServerDiscRsp( inMsg->TransSeq, &(inMsg->srcAddr), ZSUCCESS,
    979                          ZDAppNwkAddr.addr.shortAddr, matchMask, inMsg->SecurityUse );
    980            }
    981          }
    982          #endif
    983          
    984          /*********************************************************************
    985           * Call Back Functions from APS  - API
    986           */
    987          
    988          /*********************************************************************
    989           * @fn          ZDO_EndDeviceTimeoutCB
    990           *
    991           * @brief       This function handles the binding timer for the End
    992           *              Device Bind command.
    993           *
    994           * @param       none
    995           *
    996           * @return      none
    997           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    998          void ZDO_EndDeviceTimeoutCB( void )
   \                     ZDO_EndDeviceTimeoutCB:
    999          {
   \   000000   74F7         MOV     A,#-0x9
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 9
   \   000005                ; Auto size: 0
   1000          #if defined ( REFLECTOR )
   1001            byte stat;
   1002            if ( ZDO_EDBind )
   \   000005   90....       MOV     DPTR,#ZDO_EDBind
   \   000008   E0           MOVX    A,@DPTR
   \   000009   6400         XRL     A,#0x0
   \   00000B   7004         JNZ     ??ZDO_EndDeviceTimeoutCB_0
   \   00000D   A3           INC     DPTR
   \   00000E   E0           MOVX    A,@DPTR
   \   00000F   6400         XRL     A,#0x0
   \                     ??ZDO_EndDeviceTimeoutCB_0:
   \   000011   6045         JZ      ??ZDO_EndDeviceTimeoutCB_1
   1003            {
   1004              stat = ZDO_EDBind->status;
   \   000013   90....       MOV     DPTR,#ZDO_EDBind
   \   000016   E0           MOVX    A,@DPTR
   \   000017   2416         ADD     A,#0x16
   \   000019   F8           MOV     R0,A
   \   00001A   A3           INC     DPTR
   \   00001B   E0           MOVX    A,@DPTR
   \   00001C   3400         ADDC    A,#0x0
   \   00001E   F9           MOV     R1,A
   \   00001F   8882         MOV     DPL,R0
   \   000021   8983         MOV     DPH,R1
   \   000023   E0           MOVX    A,@DPTR
   \   000024   FE           MOV     R6,A
   1005          
   1006              // Send the response message to the first sent
   1007              ZDO_SendEDBindRsp( ZDO_EDBind->SrcTransSeq, &(ZDO_EDBind->SrcAddr),
   1008                                  stat, ZDO_EDBind->SecurityUse );
   \   000025                ; Setup parameters for call to function ZDO_SendEDBindRsp
   \   000025   90....       MOV     DPTR,#ZDO_EDBind
   \   000028   E0           MOVX    A,@DPTR
   \   000029   2415         ADD     A,#0x15
   \   00002B   F8           MOV     R0,A
   \   00002C   A3           INC     DPTR
   \   00002D   E0           MOVX    A,@DPTR
   \   00002E   3400         ADDC    A,#0x0
   \   000030   F9           MOV     R1,A
   \   000031   8882         MOV     DPL,R0
   \   000033   8983         MOV     DPH,R1
   \   000035   E0           MOVX    A,@DPTR
   \   000036   FD           MOV     R5,A
   \   000037   EE           MOV     A,R6
   \   000038   FC           MOV     R4,A
   \   000039   90....       MOV     DPTR,#ZDO_EDBind
   \   00003C   E0           MOVX    A,@DPTR
   \   00003D   2401         ADD     A,#0x1
   \   00003F   FA           MOV     R2,A
   \   000040   A3           INC     DPTR
   \   000041   E0           MOVX    A,@DPTR
   \   000042   3400         ADDC    A,#0x0
   \   000044   FB           MOV     R3,A
   \   000045   90....       MOV     DPTR,#ZDO_EDBind
   \   000048   E0           MOVX    A,@DPTR
   \   000049   F8           MOV     R0,A
   \   00004A   A3           INC     DPTR
   \   00004B   E0           MOVX    A,@DPTR
   \   00004C   F583         MOV     DPH,A
   \   00004E   8882         MOV     DPL,R0
   \   000050   E0           MOVX    A,@DPTR
   \   000051   F9           MOV     R1,A
   \   000052   12....       LCALL   ??ZDO_SendEDBindRsp?relay
   1009          
   1010              ZDO_RemoveEndDeviceBind();
   \   000055                ; Setup parameters for call to function ZDO_RemoveEndDeviceBind
   \   000055   12....       LCALL   ??ZDO_RemoveEndDeviceBind?relay
   1011            }
   1012          #endif  // REFLECTOR
   1013          }
   \                     ??ZDO_EndDeviceTimeoutCB_1:
   \   000058   7F01         MOV     R7,#0x1
   \   00005A   02....       LJMP    ?BANKED_LEAVE_XDATA
   1014          
   1015          /*********************************************************************
   1016           * Optional Management Messages
   1017           */
   1018          
   1019          #if defined( ZDO_MGMT_LQI_RESPONSE ) && defined ( RTR_NWK )
   1020          /*********************************************************************
   1021           * @fn          ZDO_ProcessMgmtLqiReq
   1022           *
   1023           * @brief       This function handles parsing the incoming Management
   1024           *              LQI request and generate the response.
   1025           *
   1026           *   Note:      This function will limit the number of items returned
   1027           *              to ZDO_MAX_LQI_ITEMS items.
   1028           *
   1029           * @param       inMsg - incoming message (request)
   1030           *
   1031           * @return      none
   1032           */
   1033          void ZDO_ProcessMgmtLqiReq( zdoIncomingMsg_t *inMsg )
   1034          {
   1035            byte x;
   1036            byte index;
   1037            byte numItems;
   1038            byte maxItems;
   1039            ZDP_MgmtLqiItem_t* table;
   1040            ZDP_MgmtLqiItem_t* item;
   1041            neighborEntry_t    entry;
   1042            byte aItems;
   1043            associated_devices_t *aDevice;
   1044            uint8 StartIndex = inMsg->asdu[0];
   1045          
   1046            // Get the number of neighbor items
   1047            NLME_GetRequest( nwkNumNeighborTableEntries, 0, &maxItems );
   1048          
   1049            // Get the number of associated items
   1050            aItems = (uint8)AssocCount( PARENT, CHILD_FFD_RX_IDLE );
   1051            // Total number of items
   1052            maxItems += aItems;
   1053          
   1054            // Start with the supplied index
   1055            numItems = maxItems - StartIndex;
   1056          
   1057            // limit the size of the list
   1058            if ( numItems > ZDO_MAX_LQI_ITEMS )
   1059              numItems = ZDO_MAX_LQI_ITEMS;
   1060          
   1061            // Allocate the memory to build the table
   1062            table = (ZDP_MgmtLqiItem_t*)osal_mem_alloc( (short)
   1063                      ( numItems * sizeof( ZDP_MgmtLqiItem_t ) ) );
   1064          
   1065            if ( table != NULL )
   1066            {
   1067              x = 0;
   1068              item = table;
   1069              index = StartIndex;
   1070          
   1071              // Loop through associated items and build list
   1072              for ( ; x < numItems; x++ )
   1073              {
   1074                if ( index < aItems )
   1075                {
   1076                  // get next associated device
   1077                  aDevice = AssocFindDevice( index++ );
   1078          
   1079                  // set basic fields
   1080                  item->panID   = _NIB.nwkPanId;
   1081                  osal_cpyExtAddr( item->extPanID, _NIB.extendedPANID );
   1082                  item->nwkAddr = aDevice->shortAddr;
   1083                  item->permit  = ZDP_MGMT_BOOL_UNKNOWN;
   1084                  item->depth   = 0xFF;
   1085                  item->lqi     = aDevice->linkInfo.rxCost;
   1086          
   1087                  osal_memset( item->extAddr, 0x00, Z_EXTADDR_LEN );
   1088          
   1089                  // use association info to set other fields
   1090                  if ( aDevice->nodeRelation == PARENT )
   1091                  {
   1092                    if (  aDevice->shortAddr == 0 )
   1093                    {
   1094                      item->devType = ZDP_MGMT_DT_COORD;
   1095                    }
   1096                    else
   1097                    {
   1098                      item->devType = ZDP_MGMT_DT_ROUTER;
   1099                    }
   1100          
   1101                    item->rxOnIdle = ZDP_MGMT_BOOL_UNKNOWN;
   1102                    item->relation = ZDP_MGMT_REL_PARENT;
   1103                  }
   1104                  else
   1105                  {
   1106                    if ( aDevice->nodeRelation < CHILD_FFD )
   1107                    {
   1108                      item->devType = ZDP_MGMT_DT_ENDDEV;
   1109          
   1110                      if ( aDevice->nodeRelation == CHILD_RFD )
   1111                      {
   1112                        item->rxOnIdle = FALSE;
   1113                      }
   1114                      else
   1115                      {
   1116                        item->rxOnIdle = TRUE;
   1117                      }
   1118                    }
   1119                    else
   1120                    {
   1121                      item->devType = ZDP_MGMT_DT_ROUTER;
   1122          
   1123                      if ( aDevice->nodeRelation == CHILD_FFD )
   1124                      {
   1125                        item->rxOnIdle = FALSE;
   1126                      }
   1127                      else
   1128                      {
   1129                        item->rxOnIdle = TRUE;
   1130                      }
   1131                    }
   1132          
   1133                    item->relation = ZDP_MGMT_REL_CHILD;
   1134                  }
   1135          
   1136                  item++;
   1137                }
   1138                else
   1139                {
   1140                  if ( StartIndex <= aItems )
   1141                    // Start with 1st neighbor
   1142                    index = 0;
   1143                  else
   1144                    // Start with >1st neighbor
   1145                    index = StartIndex - aItems;
   1146                  break;
   1147                }
   1148              }
   1149          
   1150              // Loop through neighbor items and finish list
   1151              for ( ; x < numItems; x++ )
   1152              {
   1153                // Add next neighbor table item
   1154                NLME_GetRequest( nwkNeighborTable, index++, &entry );
   1155          
   1156                // set ZDP_MgmtLqiItem_t fields
   1157                item->panID    = entry.panId;
   1158                osal_memset( item->extPanID, 0x00, Z_EXTADDR_LEN);
   1159                osal_memset( item->extAddr, 0x00, Z_EXTADDR_LEN );
   1160                item->nwkAddr  = entry.neighborAddress;
   1161                item->rxOnIdle = ZDP_MGMT_BOOL_UNKNOWN;
   1162                item->relation = ZDP_MGMT_REL_UNKNOWN;
   1163                item->permit   = ZDP_MGMT_BOOL_UNKNOWN;
   1164                item->depth    = 0xFF;
   1165                item->lqi      = entry.linkInfo.rxCost;
   1166          
   1167                if ( item->nwkAddr == 0 )
   1168                {
   1169                  item->devType = ZDP_MGMT_DT_COORD;
   1170                }
   1171                else
   1172                {
   1173                  item->devType = ZDP_MGMT_DT_ROUTER;
   1174                }
   1175          
   1176                item++;
   1177              }
   1178          
   1179              // Send response
   1180              ZDP_MgmtLqiRsp( inMsg->TransSeq, &(inMsg->srcAddr), ZSuccess, maxItems,
   1181                              StartIndex, numItems, table, false );
   1182          
   1183              osal_mem_free( table );
   1184            }
   1185          }
   1186          #endif // ZDO_MGMT_LQI_RESPONSE && RTR_NWK
   1187          
   1188          #if defined( ZDO_MGMT_NWKDISC_RESPONSE )
   1189          /*********************************************************************
   1190           * @fn          ZDO_ProcessMgmtNwkDiscReq
   1191           *
   1192           * @brief       This function handles parsing the incoming Management
   1193           *              Network Discover request and starts the request.
   1194           *
   1195           * @param       inMsg - incoming message (request)
   1196           *
   1197           * @return      none
   1198           */
   1199          void ZDO_ProcessMgmtNwkDiscReq( zdoIncomingMsg_t *inMsg )
   1200          {
   1201            NLME_ScanFields_t scan;
   1202            uint8             index;
   1203            uint8             *msg;
   1204          
   1205            msg = inMsg->asdu;
   1206            scan.channels = BUILD_UINT32( msg[0], msg[1], msg[2], msg[3] );
   1207            msg += 4;
   1208            scan.duration = *msg++;
   1209            index         = *msg;
   1210          
   1211            // Save off the information to be used for the response
   1212            zdappMgmtNwkDiscReqInProgress          = true;
   1213            zdappMgmtNwkDiscRspAddr.addrMode       = Addr16Bit;
   1214            zdappMgmtNwkDiscRspAddr.addr.shortAddr = inMsg->srcAddr.addr.shortAddr;
   1215            zdappMgmtNwkDiscStartIndex             = index;
   1216            zdappMgmtNwkDiscRspTransSeq            = inMsg->TransSeq;
   1217          
   1218            if ( NLME_NwkDiscReq2( &scan ) != ZSuccess )
   1219            {
   1220              NLME_NwkDiscTerm();
   1221          
   1222              // zdappMgmtNwkDiscReqInProgress will be reset in the confirm callback
   1223            }
   1224          }
   1225          #endif // ZDO_MGMT_NWKDISC_RESPONSE
   1226          
   1227          #if defined ( ZDO_MGMT_NWKDISC_RESPONSE )
   1228          /*********************************************************************
   1229           * @fn          ZDO_FinishProcessingMgmtNwkDiscReq
   1230           *
   1231           * @brief       This function finishes the processing of the Management
   1232           *              Network Discover Request and generates the response.
   1233           *
   1234           *   Note:      This function will limit the number of items returned
   1235           *              to ZDO_MAX_NWKDISC_ITEMS items.
   1236           *
   1237           * @param       ResultCountSrcAddr - source of the request
   1238           * @param       msg - pointer to incoming message
   1239           * @param       SecurityUse -
   1240           *
   1241           * @return      none
   1242           */
   1243          void ZDO_FinishProcessingMgmtNwkDiscReq( byte ResultCount,
   1244                                                   networkDesc_t *NetworkList )
   1245          {
   1246            byte count;
   1247          
   1248          #if defined ( RTR_NWK )
   1249            networkDesc_t *newDesc, *pList = NetworkList;
   1250          
   1251            // Look for my PanID.
   1252            while ( pList )
   1253            {
   1254              if ( pList->panId == _NIB.nwkPanId )
   1255              {
   1256                break;
   1257              }
   1258          
   1259              if ( !pList->nextDesc )
   1260              {
   1261                break;
   1262              }
   1263              pList = pList->nextDesc;
   1264            }
   1265          
   1266            // If my Pan not present (query to a star network ZC or an isolated ZR?),
   1267            // prepend it.
   1268            if ( !pList || (pList->panId != _NIB.nwkPanId) )
   1269            {
   1270              newDesc = (networkDesc_t *)osal_mem_alloc( sizeof( networkDesc_t ) );
   1271              if ( newDesc )
   1272              {
   1273                byte pJoin;
   1274          
   1275                newDesc->panId = _NIB.nwkPanId;
   1276                newDesc->logicalChannel = _NIB.nwkLogicalChannel;
   1277                newDesc->beaconOrder = _NIB.beaconOrder;
   1278                newDesc->superFrameOrder = _NIB.superFrameOrder;
   1279                newDesc->version = NLME_GetProtocolVersion();
   1280                newDesc->stackProfile = zgStackProfile;
   1281                //Extended PanID
   1282                osal_cpyExtAddr( newDesc->extendedPANID, _NIB.extendedPANID);
   1283          
   1284                ZMacGetReq( ZMacAssociationPermit, &pJoin );
   1285                newDesc->chosenRouter = ((pJoin) ? ZDAppNwkAddr.addr.shortAddr :
   1286                                                   INVALID_NODE_ADDR);
   1287          
   1288                newDesc->nextDesc = NetworkList;
   1289                NetworkList = newDesc;
   1290                ResultCount++;
   1291              }
   1292            }
   1293          #endif
   1294          
   1295            // Calc the count and apply a max count.
   1296            if ( zdappMgmtNwkDiscStartIndex > ResultCount )
   1297            {
   1298              count = 0;
   1299            }
   1300            else
   1301            {
   1302              count = ResultCount - zdappMgmtNwkDiscStartIndex;
   1303              if ( count > ZDO_MAX_NWKDISC_ITEMS )
   1304              {
   1305                count = ZDO_MAX_NWKDISC_ITEMS;
   1306              }
   1307          
   1308              // Move the list pointer up to the start index.
   1309              NetworkList += zdappMgmtNwkDiscStartIndex;
   1310            }
   1311          
   1312            ZDP_MgmtNwkDiscRsp( zdappMgmtNwkDiscRspTransSeq,
   1313                               &zdappMgmtNwkDiscRspAddr, ZSuccess, ResultCount,
   1314                                zdappMgmtNwkDiscStartIndex,
   1315                                count,
   1316                                NetworkList,
   1317                                false );
   1318          
   1319          #if defined ( RTR_NWK )
   1320            if ( newDesc )
   1321            {
   1322              osal_mem_free( newDesc );
   1323            }
   1324          #endif
   1325          
   1326            NLME_NwkDiscTerm();
   1327          }
   1328          #endif
   1329          
   1330          #if defined ( ZDO_MGMT_RTG_RESPONSE ) && defined ( RTR_NWK )
   1331          /*********************************************************************
   1332           * @fn          ZDO_ProcessMgmtRtgReq
   1333           *
   1334           * @brief       This function finishes the processing of the Management
   1335           *              Routing Request and generates the response.
   1336           *
   1337           *   Note:      This function will limit the number of items returned
   1338           *              to ZDO_MAX_RTG_ITEMS items.
   1339           *
   1340           * @param       ResultCountSrcAddr - source of the request
   1341           * @param       msg - pointer to incoming message
   1342           * @param       SecurityUse -
   1343           *
   1344           * @return      none
   1345           */
   1346          void ZDO_ProcessMgmtRtgReq( zdoIncomingMsg_t *inMsg )
   1347          {
   1348            byte x;
   1349            byte maxNumItems;
   1350            byte numItems;
   1351            byte *pBuf;
   1352            rtgItem_t *pList;
   1353            uint8 StartIndex = inMsg->asdu[0];
   1354          
   1355            // Get the number of table items
   1356            NLME_GetRequest( nwkNumRoutingTableEntries, 0, &maxNumItems );
   1357          
   1358            numItems = maxNumItems - StartIndex;    // Start at the passed in index
   1359          
   1360            // limit the size of the list
   1361            if ( numItems > ZDO_MAX_RTG_ITEMS )
   1362              numItems = ZDO_MAX_RTG_ITEMS;
   1363          
   1364            // Allocate the memory to build the table
   1365            pBuf = osal_mem_alloc( (short)(sizeof( rtgItem_t ) * numItems) );
   1366          
   1367            if ( pBuf )
   1368            {
   1369              // Convert buffer to list
   1370              pList = (rtgItem_t *)pBuf;
   1371          
   1372              // Loop through items and build list
   1373              for ( x = 0; x < numItems; x++ )
   1374              {
   1375                NLME_GetRequest( nwkRoutingTable, (uint16)(x + StartIndex), (void*)pList );
   1376          
   1377                // Remap the status to the RoutingTableList Record Format defined in the ZigBee spec
   1378                switch( pList->status )
   1379                {
   1380                  case RT_ACTIVE:
   1381                    pList->status = ZDO_MGMT_RTG_ENTRY_ACTIVE;
   1382                    break;
   1383          
   1384                  case RT_DISC:
   1385                    pList->status = ZDO_MGMT_RTG_ENTRY_DISCOVERY_UNDERWAY;
   1386                    break;
   1387          
   1388                  case RT_LINK_FAIL:
   1389                    pList->status = ZDO_MGMT_RTG_ENTRY_DISCOVERY_FAILED;
   1390          
   1391                  case RT_INIT:
   1392                  case RT_REPAIR:
   1393                  default:
   1394                    pList->status = ZDO_MGMT_RTG_ENTRY_INACTIVE;
   1395                    break;
   1396                }
   1397          
   1398                // Increment pointer to next record
   1399                pList++;
   1400              }
   1401          
   1402              // Send response
   1403              ZDP_MgmtRtgRsp( inMsg->TransSeq, &(inMsg->srcAddr), ZSuccess, maxNumItems, StartIndex, numItems,
   1404                                    (rtgItem_t *)pBuf, false );
   1405          
   1406              osal_mem_free( pBuf );
   1407            }
   1408          }
   1409          #endif // defined(ZDO_MGMT_RTG_RESPONSE)  && defined(RTR_NWK)
   1410          
   1411          #if defined ( ZDO_MGMT_BIND_RESPONSE )
   1412          /*********************************************************************
   1413           * @fn          ZDO_ProcessMgmtBindReq
   1414           *
   1415           * @brief       This function finishes the processing of the Management
   1416           *              Bind Request and generates the response.
   1417           *
   1418           *   Note:      This function will limit the number of items returned
   1419           *              to ZDO_MAX_BIND_ITEMS items.
   1420           *
   1421           * @param       ResultCountSrcAddr - source of the request
   1422           * @param       msg - pointer to incoming message
   1423           * @param       SecurityUse -
   1424           *
   1425           * @return      none
   1426           */
   1427          void ZDO_ProcessMgmtBindReq( zdoIncomingMsg_t *inMsg )
   1428          {
   1429          #if defined ( REFLECTOR )
   1430            byte x;
   1431            uint16 maxNumItems;
   1432            uint16 numItems;
   1433            byte *pBuf = NULL;
   1434            apsBindingItem_t *pList;
   1435            uint8 StartIndex = inMsg->asdu[0];
   1436          
   1437            // Get the number of table items
   1438            APSME_GetRequest( apsNumBindingTableEntries, 0, (byte*)(&maxNumItems) );
   1439          
   1440            if ( maxNumItems > StartIndex )
   1441              numItems = maxNumItems - StartIndex;    // Start at the passed in index
   1442            else
   1443              numItems = 0;
   1444          
   1445            // limit the size of the list
   1446            if ( numItems > ZDO_MAX_BIND_ITEMS )
   1447              numItems = ZDO_MAX_BIND_ITEMS;
   1448          
   1449            // Allocate the memory to build the table
   1450            if ( numItems )
   1451              pBuf = osal_mem_alloc( sizeof( apsBindingItem_t ) * numItems );
   1452          
   1453            if ( pBuf )
   1454            {
   1455              // Convert buffer to list
   1456              pList = (apsBindingItem_t *)pBuf;
   1457          
   1458              // Loop through items and build list
   1459              for ( x = 0; x < numItems; x++ )
   1460              {
   1461                APSME_GetRequest( apsBindingTable, (x + StartIndex), (void*)pList );
   1462                pList++;
   1463              }
   1464            }
   1465          
   1466            // Send response
   1467            ZDP_MgmtBindRsp( inMsg->TransSeq, &(inMsg->srcAddr), ZSuccess, (byte)maxNumItems, StartIndex, (byte)numItems,
   1468                                  (apsBindingItem_t *)pBuf, false );
   1469          
   1470            if ( pBuf )
   1471            {
   1472              osal_mem_free( pBuf );
   1473            }
   1474          #endif
   1475          }
   1476          #endif // ZDO_MGMT_BIND_RESPONSE
   1477          
   1478          #if defined ( ZDO_MGMT_JOINDIRECT_RESPONSE ) && defined ( RTR_NWK )
   1479          /*********************************************************************
   1480           * @fn          ZDO_ProcessMgmtDirectJoinReq
   1481           *
   1482           * @brief       This function finishes the processing of the Management
   1483           *              Direct Join Request and generates the response.
   1484           *
   1485           * @param       inMsg - incoming message (request)
   1486           *
   1487           * @return      none
   1488           */
   1489          void ZDO_ProcessMgmtDirectJoinReq( zdoIncomingMsg_t *inMsg )
   1490          {
   1491            uint8 *deviceAddr;
   1492            uint8 capInfo;
   1493            uint8 stat;
   1494          
   1495            // Parse the message
   1496            deviceAddr = inMsg->asdu;
   1497            capInfo = inMsg->asdu[Z_EXTADDR_LEN];
   1498          
   1499            stat = (byte) NLME_DirectJoinRequest( deviceAddr, capInfo );
   1500          
   1501            ZDP_MgmtDirectJoinRsp( inMsg->TransSeq, &(inMsg->srcAddr), stat, false );
   1502          }
   1503          #endif // ZDO_MGMT_JOINDIRECT_RESPONSE && RTR_NWK
   1504          
   1505          #if defined ( ZDO_MGMT_LEAVE_RESPONSE )
   1506          /*********************************************************************
   1507           * @fn          ZDO_ProcessMgmtLeaveReq
   1508           *
   1509           * @brief       This function processes a Management Leave Request
   1510           *              and generates the response.
   1511           *
   1512           * @param       inMsg - incoming message (request)
   1513           *
   1514           * @return      none
   1515           */
   1516          void ZDO_ProcessMgmtLeaveReq( zdoIncomingMsg_t *inMsg )
   1517          {
   1518            NLME_LeaveReq_t req;
   1519            ZStatus_t       status;
   1520            uint8 *msg = inMsg->asdu;
   1521          
   1522          
   1523            if ( ( AddrMgrExtAddrValid( msg ) == FALSE                 ) ||
   1524                 ( osal_ExtAddrEqual( msg, NLME_GetExtAddr() ) == TRUE )    )
   1525            {
   1526              // Remove this device
   1527              req.extAddr = NULL;
   1528            }
   1529            else
   1530            {
   1531              // Remove child device
   1532              req.extAddr = msg;
   1533            }
   1534          
   1535            req.removeChildren = FALSE;
   1536            req.rejoin         = FALSE;
   1537            req.silent         = FALSE;
   1538          
   1539            status = NLME_LeaveReq( &req );
   1540          
   1541            ZDP_MgmtLeaveRsp( inMsg->TransSeq, &(inMsg->srcAddr), status, FALSE );
   1542          }
   1543          #endif // ZDO_MGMT_LEAVE_RESPONSE
   1544          
   1545          #if defined( ZDO_MGMT_PERMIT_JOIN_RESPONSE ) && defined( RTR_NWK )
   1546          /*********************************************************************
   1547           * @fn          ZDO_ProcessMgmtPermitJoinReq
   1548           *
   1549           * @brief       This function processes a Management Permit Join Request
   1550           *              and generates the response.
   1551           *
   1552           * @param       inMsg - incoming message (request)
   1553           *
   1554           * @return      none
   1555           */
   1556          void ZDO_ProcessMgmtPermitJoinReq( zdoIncomingMsg_t *inMsg )
   1557          {
   1558            uint8 stat;
   1559            uint8 duration;
   1560            uint8 tcsig;
   1561          
   1562            duration = inMsg->asdu[ZDP_MGMT_PERMIT_JOIN_REQ_DURATION];
   1563            tcsig    = inMsg->asdu[ZDP_MGMT_PERMIT_JOIN_REQ_TC_SIG];
   1564          
   1565            // Set the network layer permit join duration
   1566            stat = (byte) NLME_PermitJoiningRequest( duration );
   1567          
   1568            // Handle the Trust Center Significance
   1569            if ( tcsig == TRUE )
   1570            {
   1571              ZDSecMgrPermitJoining( duration );
   1572            }
   1573          
   1574            // Send a response if unicast
   1575            if (inMsg->srcAddr.addr.shortAddr != NWK_BROADCAST_SHORTADDR)
   1576            {
   1577              ZDP_MgmtPermitJoinRsp( inMsg->TransSeq, &(inMsg->srcAddr), stat, false );
   1578            }
   1579          }
   1580          #endif // ZDO_MGMT_PERMIT_JOIN_RESPONSE && defined( RTR_NWK )
   1581          
   1582          /*
   1583           * This function stub allows the next higher layer to be notified of
   1584           * a permit joining timeout.
   1585           */
   1586          #if defined( RTR_NWK )
   1587          /*********************************************************************
   1588           * @fn          ZDO_ProcessMgmtPermitJoinTimeout
   1589           *
   1590           * @brief       This function stub allows the next higher layer to be
   1591           *              notified of a permit joining timeout. Currently, this
   1592           *              directly bypasses the APS layer.
   1593           *
   1594           * @param       none
   1595           *
   1596           * @return      none
   1597           */
   1598          void ZDO_ProcessMgmtPermitJoinTimeout( void )
   1599          {
   1600            #if defined( ZDO_MGMT_PERMIT_JOIN_RESPONSE )
   1601            {
   1602              // Currently, only the ZDSecMgr needs to be notified
   1603              ZDSecMgrPermitJoiningTimeout();
   1604            }
   1605            #endif
   1606          }
   1607          #endif // defined( RTR_NWK )
   1608          
   1609          #if defined ( ZDO_USERDESC_RESPONSE )
   1610          /*********************************************************************
   1611           * @fn          ZDO_ProcessUserDescReq
   1612           *
   1613           * @brief       This function finishes the processing of the User
   1614           *              Descriptor Request and generates the response.
   1615           *
   1616           * @param       inMsg - incoming message (request)
   1617           *
   1618           * @return      none
   1619           */
   1620          void ZDO_ProcessUserDescReq( zdoIncomingMsg_t *inMsg )
   1621          {
   1622            uint16 aoi = BUILD_UINT16( inMsg->asdu[0], inMsg->asdu[1] );
   1623            UserDescriptorFormat_t userDesc;
   1624          
   1625            if ( (aoi == ZDAppNwkAddr.addr.shortAddr) && (ZSUCCESS == osal_nv_read(
   1626                       ZCD_NV_USERDESC, 0, sizeof(UserDescriptorFormat_t), &userDesc )) )
   1627            {
   1628              ZDP_UserDescRsp( inMsg->TransSeq, &(inMsg->srcAddr), aoi, &userDesc, false );
   1629            }
   1630            else
   1631            {
   1632              ZDP_GenericRsp(inMsg->TransSeq, &(inMsg->srcAddr),
   1633                     ZDP_NOT_SUPPORTED, aoi, User_Desc_rsp, inMsg->SecurityUse );
   1634            }
   1635          }
   1636          #endif // ZDO_USERDESC_RESPONSE
   1637          
   1638          #if defined ( ZDO_USERDESCSET_RESPONSE )
   1639          /*********************************************************************
   1640           * @fn          ZDO_ProcessUserDescSet
   1641           *
   1642           * @brief       This function finishes the processing of the User
   1643           *              Descriptor Set and generates the response.
   1644           *
   1645           * @param       inMsg - incoming message (request)
   1646           *
   1647           * @return      none
   1648           */
   1649          void ZDO_ProcessUserDescSet( zdoIncomingMsg_t *inMsg )
   1650          {
   1651            uint8 *msg;
   1652            uint16 aoi;
   1653            UserDescriptorFormat_t userDesc;
   1654            uint8 outMsg[3];
   1655            uint8 status;
   1656          
   1657            msg = inMsg->asdu;
   1658            aoi = BUILD_UINT16( msg[0], msg[1] );
   1659          
   1660            if ( aoi == ZDAppNwkAddr.addr.shortAddr )
   1661            {
   1662              userDesc.len = (msg[2] < AF_MAX_USER_DESCRIPTOR_LEN) ? msg[2] : AF_MAX_USER_DESCRIPTOR_LEN;
   1663              msg ++;  // increment one for the length field
   1664          
   1665              osal_memcpy( userDesc.desc, &msg[2], userDesc.len );
   1666              osal_nv_write( ZCD_NV_USERDESC, 0, sizeof(UserDescriptorFormat_t), &userDesc );
   1667              if ( userDesc.len != 0 )
   1668              {
   1669                ZDO_Config_Node_Descriptor.UserDescAvail = TRUE;
   1670              }
   1671              else
   1672              {
   1673                ZDO_Config_Node_Descriptor.UserDescAvail = FALSE;
   1674              }
   1675          
   1676              status = ZDP_SUCCESS;
   1677            }
   1678            else
   1679            {
   1680              status =  ZDP_NOT_SUPPORTED;
   1681            }
   1682          
   1683            outMsg[0] = status;
   1684            outMsg[1] = LO_UINT16( aoi );
   1685            outMsg[2] = LO_UINT16( aoi );
   1686          
   1687            ZDP_SendData( &(inMsg->TransSeq), &(inMsg->srcAddr), User_Desc_conf, 3, outMsg,
   1688                         inMsg->SecurityUse );
   1689          }
   1690          #endif // ZDO_USERDESCSET_RESPONSE
   1691          
   1692          #if defined ( ZDO_ENDDEVICE_ANNCE ) && defined(RTR_NWK)
   1693          /*********************************************************************
   1694           * @fn          ZDO_ProcessEndDeviceAnnce
   1695           *
   1696           * @brief       This function processes an end device annouce message.
   1697           *
   1698           * @param       inMsg - incoming message
   1699           *
   1700           * @return      none
   1701           */
   1702          void ZDO_ProcessEndDeviceAnnce( zdoIncomingMsg_t *inMsg )
   1703          {
   1704            ZDO_DeviceAnnce_t Annce;
   1705            associated_devices_t *dev;
   1706            AddrMgrEntry_t addrEntry;
   1707          
   1708            // Parse incoming message
   1709            ZDO_ParseDeviceAnnce( inMsg, &Annce );
   1710          
   1711            addrEntry.user = ADDRMGR_USER_DEFAULT;
   1712            addrEntry.nwkAddr = Annce.nwkAddr;
   1713            AddrMgrExtAddrSet( addrEntry.extAddr, Annce.extAddr );
   1714            AddrMgrEntryUpdate( &addrEntry );
   1715          
   1716            // find device in device list
   1717            dev = AssocGetWithExt( Annce.extAddr );
   1718            if ( dev != NULL )
   1719            {
   1720              // if found and address is different
   1721              if ( dev->shortAddr != Annce.nwkAddr )
   1722              {
   1723                // update device list if device is (was) not our child
   1724                if ( dev->nodeRelation == NEIGHBOR || dev->nodeRelation == OTHER )
   1725                {
   1726                  dev->shortAddr = Annce.nwkAddr;
   1727                }
   1728              }
   1729            }
   1730          }
   1731          #endif // ZDO_ENDDEVICE_ANNCE
   1732          
   1733          /*********************************************************************
   1734           * @fn          ZDO_BuildSimpleDescBuf
   1735           *
   1736           * @brief       Build a byte sequence representation of a Simple Descriptor.
   1737           *
   1738           * @param       buf  - pointer to a byte array big enough for data.
   1739           * @param       desc - SimpleDescriptionFormat_t *
   1740           *
   1741           * @return      none
   1742           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   1743          void ZDO_BuildSimpleDescBuf( byte *buf, SimpleDescriptionFormat_t *desc )
   \                     ZDO_BuildSimpleDescBuf:
   1744          {
   \   000000   74F7         MOV     A,#-0x9
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 9
   \   000005                ; Auto size: 0
   1745            byte cnt;
   1746            uint16 *ptr;
   1747          
   1748            *buf++ = desc->EndPoint;
   \   000005   8C82         MOV     DPL,R4
   \   000007   8D83         MOV     DPH,R5
   \   000009   E0           MOVX    A,@DPTR
   \   00000A   8A82         MOV     DPL,R2
   \   00000C   8B83         MOV     DPH,R3
   \   00000E   F0           MOVX    @DPTR,A
   \   00000F   8A82         MOV     DPL,R2
   \   000011   8B83         MOV     DPH,R3
   \   000013   A3           INC     DPTR
   \   000014   AA82         MOV     R2,DPL
   \   000016   AB83         MOV     R3,DPH
   1749            *buf++ = HI_UINT16( desc->AppProfId );
   \   000018   8C82         MOV     DPL,R4
   \   00001A   8D83         MOV     DPH,R5
   \   00001C   A3           INC     DPTR
   \   00001D   A3           INC     DPTR
   \   00001E   E0           MOVX    A,@DPTR
   \   00001F   FF           MOV     R7,A
   \   000020   EF           MOV     A,R7
   \   000021   8A82         MOV     DPL,R2
   \   000023   8B83         MOV     DPH,R3
   \   000025   F0           MOVX    @DPTR,A
   \   000026   8A82         MOV     DPL,R2
   \   000028   8B83         MOV     DPH,R3
   \   00002A   A3           INC     DPTR
   \   00002B   AA82         MOV     R2,DPL
   \   00002D   AB83         MOV     R3,DPH
   1750            *buf++ = LO_UINT16( desc->AppProfId );
   \   00002F   8C82         MOV     DPL,R4
   \   000031   8D83         MOV     DPH,R5
   \   000033   A3           INC     DPTR
   \   000034   E0           MOVX    A,@DPTR
   \   000035   8A82         MOV     DPL,R2
   \   000037   8B83         MOV     DPH,R3
   \   000039   F0           MOVX    @DPTR,A
   \   00003A   8A82         MOV     DPL,R2
   \   00003C   8B83         MOV     DPH,R3
   \   00003E   A3           INC     DPTR
   \   00003F   AA82         MOV     R2,DPL
   \   000041   AB83         MOV     R3,DPH
   1751            *buf++ = HI_UINT16( desc->AppDeviceId );
   \   000043   8C82         MOV     DPL,R4
   \   000045   8D83         MOV     DPH,R5
   \   000047   A3           INC     DPTR
   \   000048   A3           INC     DPTR
   \   000049   A3           INC     DPTR
   \   00004A   A3           INC     DPTR
   \   00004B   E0           MOVX    A,@DPTR
   \   00004C   FF           MOV     R7,A
   \   00004D   EF           MOV     A,R7
   \   00004E   8A82         MOV     DPL,R2
   \   000050   8B83         MOV     DPH,R3
   \   000052   F0           MOVX    @DPTR,A
   \   000053   8A82         MOV     DPL,R2
   \   000055   8B83         MOV     DPH,R3
   \   000057   A3           INC     DPTR
   \   000058   AA82         MOV     R2,DPL
   \   00005A   AB83         MOV     R3,DPH
   1752            *buf++ = LO_UINT16( desc->AppDeviceId );
   \   00005C   8C82         MOV     DPL,R4
   \   00005E   8D83         MOV     DPH,R5
   \   000060   A3           INC     DPTR
   \   000061   A3           INC     DPTR
   \   000062   A3           INC     DPTR
   \   000063   E0           MOVX    A,@DPTR
   \   000064   8A82         MOV     DPL,R2
   \   000066   8B83         MOV     DPH,R3
   \   000068   F0           MOVX    @DPTR,A
   \   000069   8A82         MOV     DPL,R2
   \   00006B   8B83         MOV     DPH,R3
   \   00006D   A3           INC     DPTR
   \   00006E   AA82         MOV     R2,DPL
   \   000070   AB83         MOV     R3,DPH
   1753          
   1754            *buf++ = (byte)(desc->AppDevVer << 4);
   \   000072   8C82         MOV     DPL,R4
   \   000074   8D83         MOV     DPH,R5
   \   000076   A3           INC     DPTR
   \   000077   A3           INC     DPTR
   \   000078   A3           INC     DPTR
   \   000079   A3           INC     DPTR
   \   00007A   A3           INC     DPTR
   \   00007B   E0           MOVX    A,@DPTR
   \   00007C   C4           SWAP    A
   \   00007D   54F0         ANL     A,#0xf0
   \   00007F   8A82         MOV     DPL,R2
   \   000081   8B83         MOV     DPH,R3
   \   000083   F0           MOVX    @DPTR,A
   \   000084   8A82         MOV     DPL,R2
   \   000086   8B83         MOV     DPH,R3
   \   000088   A3           INC     DPTR
   \   000089   AA82         MOV     R2,DPL
   \   00008B   AB83         MOV     R3,DPH
   1755          
   1756            *buf++ = desc->AppNumInClusters;
   \   00008D   8C82         MOV     DPL,R4
   \   00008F   8D83         MOV     DPH,R5
   \   000091   A3           INC     DPTR
   \   000092   A3           INC     DPTR
   \   000093   A3           INC     DPTR
   \   000094   A3           INC     DPTR
   \   000095   A3           INC     DPTR
   \   000096   A3           INC     DPTR
   \   000097   E0           MOVX    A,@DPTR
   \   000098   8A82         MOV     DPL,R2
   \   00009A   8B83         MOV     DPH,R3
   \   00009C   F0           MOVX    @DPTR,A
   \   00009D   8A82         MOV     DPL,R2
   \   00009F   8B83         MOV     DPH,R3
   \   0000A1   A3           INC     DPTR
   \   0000A2   AA82         MOV     R2,DPL
   \   0000A4   AB83         MOV     R3,DPH
   1757            ptr = desc->pAppInClusterList;
   \   0000A6   8C82         MOV     DPL,R4
   \   0000A8   8D83         MOV     DPH,R5
   \   0000AA   A3           INC     DPTR
   \   0000AB   A3           INC     DPTR
   \   0000AC   A3           INC     DPTR
   \   0000AD   A3           INC     DPTR
   \   0000AE   A3           INC     DPTR
   \   0000AF   A3           INC     DPTR
   \   0000B0   A3           INC     DPTR
   \   0000B1   E0           MOVX    A,@DPTR
   \   0000B2   FE           MOV     R6,A
   \   0000B3   A3           INC     DPTR
   \   0000B4   E0           MOVX    A,@DPTR
   \   0000B5   FF           MOV     R7,A
   \   0000B6   EE           MOV     A,R6
   \   0000B7   F8           MOV     R0,A
   \   0000B8   EF           MOV     A,R7
   \   0000B9   F9           MOV     R1,A
   1758            for ( cnt = 0; cnt < desc->AppNumInClusters; ptr++, cnt++ )
   \   0000BA   75..00       MOV     ?V0 + 0,#0x0
   \                     ??ZDO_BuildSimpleDescBuf_0:
   \   0000BD   8C82         MOV     DPL,R4
   \   0000BF   8D83         MOV     DPH,R5
   \   0000C1   A3           INC     DPTR
   \   0000C2   A3           INC     DPTR
   \   0000C3   A3           INC     DPTR
   \   0000C4   A3           INC     DPTR
   \   0000C5   A3           INC     DPTR
   \   0000C6   A3           INC     DPTR
   \   0000C7   E0           MOVX    A,@DPTR
   \   0000C8   FE           MOV     R6,A
   \   0000C9   E5..         MOV     A,?V0 + 0
   \   0000CB   C3           CLR     C
   \   0000CC   9E           SUBB    A,R6
   \   0000CD   5035         JNC     ??ZDO_BuildSimpleDescBuf_1
   1759            {
   1760              *buf++ = HI_UINT16( *ptr );
   \   0000CF   8882         MOV     DPL,R0
   \   0000D1   8983         MOV     DPH,R1
   \   0000D3   A3           INC     DPTR
   \   0000D4   E0           MOVX    A,@DPTR
   \   0000D5   FF           MOV     R7,A
   \   0000D6   EF           MOV     A,R7
   \   0000D7   8A82         MOV     DPL,R2
   \   0000D9   8B83         MOV     DPH,R3
   \   0000DB   F0           MOVX    @DPTR,A
   \   0000DC   8A82         MOV     DPL,R2
   \   0000DE   8B83         MOV     DPH,R3
   \   0000E0   A3           INC     DPTR
   \   0000E1   AA82         MOV     R2,DPL
   \   0000E3   AB83         MOV     R3,DPH
   1761              *buf++ = LO_UINT16( *ptr );
   \   0000E5   8882         MOV     DPL,R0
   \   0000E7   8983         MOV     DPH,R1
   \   0000E9   E0           MOVX    A,@DPTR
   \   0000EA   8A82         MOV     DPL,R2
   \   0000EC   8B83         MOV     DPH,R3
   \   0000EE   F0           MOVX    @DPTR,A
   \   0000EF   8A82         MOV     DPL,R2
   \   0000F1   8B83         MOV     DPH,R3
   \   0000F3   A3           INC     DPTR
   \   0000F4   AA82         MOV     R2,DPL
   \   0000F6   AB83         MOV     R3,DPH
   1762            }
   \   0000F8   E8           MOV     A,R0
   \   0000F9   2402         ADD     A,#0x2
   \   0000FB   F8           MOV     R0,A
   \   0000FC   E9           MOV     A,R1
   \   0000FD   3400         ADDC    A,#0x0
   \   0000FF   F9           MOV     R1,A
   \   000100   05..         INC     ?V0 + 0
   \   000102   80B9         SJMP    ??ZDO_BuildSimpleDescBuf_0
   1763          
   1764            *buf++ = desc->AppNumOutClusters;
   \                     ??ZDO_BuildSimpleDescBuf_1:
   \   000104   8C82         MOV     DPL,R4
   \   000106   8D83         MOV     DPH,R5
   \   000108   A3           INC     DPTR
   \   000109   A3           INC     DPTR
   \   00010A   A3           INC     DPTR
   \   00010B   A3           INC     DPTR
   \   00010C   A3           INC     DPTR
   \   00010D   A3           INC     DPTR
   \   00010E   A3           INC     DPTR
   \   00010F   A3           INC     DPTR
   \   000110   A3           INC     DPTR
   \   000111   E0           MOVX    A,@DPTR
   \   000112   8A82         MOV     DPL,R2
   \   000114   8B83         MOV     DPH,R3
   \   000116   F0           MOVX    @DPTR,A
   \   000117   8A82         MOV     DPL,R2
   \   000119   8B83         MOV     DPH,R3
   \   00011B   A3           INC     DPTR
   \   00011C   AA82         MOV     R2,DPL
   \   00011E   AB83         MOV     R3,DPH
   1765            ptr = desc->pAppOutClusterList;
   \   000120   8C82         MOV     DPL,R4
   \   000122   8D83         MOV     DPH,R5
   \   000124   A3           INC     DPTR
   \   000125   A3           INC     DPTR
   \   000126   A3           INC     DPTR
   \   000127   A3           INC     DPTR
   \   000128   A3           INC     DPTR
   \   000129   A3           INC     DPTR
   \   00012A   A3           INC     DPTR
   \   00012B   A3           INC     DPTR
   \   00012C   A3           INC     DPTR
   \   00012D   A3           INC     DPTR
   \   00012E   E0           MOVX    A,@DPTR
   \   00012F   FE           MOV     R6,A
   \   000130   A3           INC     DPTR
   \   000131   E0           MOVX    A,@DPTR
   \   000132   FF           MOV     R7,A
   \   000133   EE           MOV     A,R6
   \   000134   F8           MOV     R0,A
   \   000135   EF           MOV     A,R7
   \   000136   F9           MOV     R1,A
   1766            for ( cnt = 0; cnt < desc->AppNumOutClusters; ptr++, cnt++ )
   \   000137   75..00       MOV     ?V0 + 0,#0x0
   \                     ??ZDO_BuildSimpleDescBuf_2:
   \   00013A   8C82         MOV     DPL,R4
   \   00013C   8D83         MOV     DPH,R5
   \   00013E   A3           INC     DPTR
   \   00013F   A3           INC     DPTR
   \   000140   A3           INC     DPTR
   \   000141   A3           INC     DPTR
   \   000142   A3           INC     DPTR
   \   000143   A3           INC     DPTR
   \   000144   A3           INC     DPTR
   \   000145   A3           INC     DPTR
   \   000146   A3           INC     DPTR
   \   000147   E0           MOVX    A,@DPTR
   \   000148   FE           MOV     R6,A
   \   000149   E5..         MOV     A,?V0 + 0
   \   00014B   C3           CLR     C
   \   00014C   9E           SUBB    A,R6
   \   00014D   5035         JNC     ??ZDO_BuildSimpleDescBuf_3
   1767            {
   1768              *buf++ = HI_UINT16( *ptr );
   \   00014F   8882         MOV     DPL,R0
   \   000151   8983         MOV     DPH,R1
   \   000153   A3           INC     DPTR
   \   000154   E0           MOVX    A,@DPTR
   \   000155   FF           MOV     R7,A
   \   000156   EF           MOV     A,R7
   \   000157   8A82         MOV     DPL,R2
   \   000159   8B83         MOV     DPH,R3
   \   00015B   F0           MOVX    @DPTR,A
   \   00015C   8A82         MOV     DPL,R2
   \   00015E   8B83         MOV     DPH,R3
   \   000160   A3           INC     DPTR
   \   000161   AA82         MOV     R2,DPL
   \   000163   AB83         MOV     R3,DPH
   1769              *buf++ = LO_UINT16( *ptr );
   \   000165   8882         MOV     DPL,R0
   \   000167   8983         MOV     DPH,R1
   \   000169   E0           MOVX    A,@DPTR
   \   00016A   8A82         MOV     DPL,R2
   \   00016C   8B83         MOV     DPH,R3
   \   00016E   F0           MOVX    @DPTR,A
   \   00016F   8A82         MOV     DPL,R2
   \   000171   8B83         MOV     DPH,R3
   \   000173   A3           INC     DPTR
   \   000174   AA82         MOV     R2,DPL
   \   000176   AB83         MOV     R3,DPH
   1770            }
   \   000178   E8           MOV     A,R0
   \   000179   2402         ADD     A,#0x2
   \   00017B   F8           MOV     R0,A
   \   00017C   E9           MOV     A,R1
   \   00017D   3400         ADDC    A,#0x0
   \   00017F   F9           MOV     R1,A
   \   000180   05..         INC     ?V0 + 0
   \   000182   80B6         SJMP    ??ZDO_BuildSimpleDescBuf_2
   1771          }
   \                     ??ZDO_BuildSimpleDescBuf_3:
   \   000184   7F01         MOV     R7,#0x1
   \   000186   02....       LJMP    ?BANKED_LEAVE_XDATA
   1772          
   1773          #if defined ( ZDO_COORDINATOR )
   1774          /*********************************************************************
   1775           * @fn      ZDO_MatchEndDeviceBind()
   1776           *
   1777           * @brief
   1778           *
   1779           *   Called to match end device binding requests
   1780           *
   1781           * @param  bindReq  - binding request information
   1782           * @param  SecurityUse - Security enable/disable
   1783           *
   1784           * @return  none
   1785           */
   1786          void ZDO_MatchEndDeviceBind( ZDEndDeviceBind_t *bindReq )
   1787          {
   1788            zAddrType_t dstAddr;
   1789            uint8 sendRsp = FALSE;
   1790            uint8 status;
   1791          
   1792            // Is this the first request?
   1793            if ( matchED == NULL )
   1794            {
   1795              // Create match info structure
   1796              matchED = (ZDMatchEndDeviceBind_t *)osal_mem_alloc( sizeof ( ZDMatchEndDeviceBind_t ) );
   1797              if ( matchED )
   1798              {
   1799                // Clear the structure
   1800                osal_memset( (uint8 *)matchED, 0, sizeof ( ZDMatchEndDeviceBind_t ) );
   1801          
   1802                // Copy the first request's information
   1803                if ( !ZDO_CopyMatchInfo( &(matchED->ed1), bindReq ) )
   1804                {
   1805          
   1806                  status = ZDP_NO_ENTRY;
   1807                  sendRsp = TRUE;
   1808                }
   1809              }
   1810              else
   1811              {
   1812                status = ZDP_NO_ENTRY;
   1813                sendRsp = TRUE;
   1814              }
   1815          
   1816              if ( !sendRsp )
   1817              {
   1818                // Set into the correct state
   1819                matchED->state = ZDMATCH_WAIT_REQ;
   1820          
   1821                // Setup the timeout
   1822                APS_SetEndDeviceBindTimeout( AIB_MaxBindingTime, ZDO_EndDeviceBindMatchTimeoutCB );
   1823              }
   1824            }
   1825            else
   1826            {
   1827                matchED->state = ZDMATCH_SENDING_BINDS;
   1828          
   1829                // Copy the 2nd request's information
   1830                if ( !ZDO_CopyMatchInfo( &(matchED->ed2), bindReq ) )
   1831                {
   1832                  status = ZDP_NO_ENTRY;
   1833                  sendRsp = TRUE;
   1834                }
   1835          
   1836                // Make a source match for ed1
   1837                matchED->ed1numMatched = ZDO_CompareClusterLists(
   1838                            matchED->ed1.numOutClusters, matchED->ed1.outClusters,
   1839                            matchED->ed2.numInClusters, matchED->ed2.inClusters, ZDOBuildBuf );
   1840                if ( matchED->ed1numMatched )
   1841                {
   1842                  // Save the match list
   1843                  matchED->ed1Matched = osal_mem_alloc( (short)(matchED->ed1numMatched * sizeof ( uint16 )) );
   1844                  if ( matchED->ed1Matched )
   1845                  {
   1846                    osal_memcpy( matchED->ed1Matched, ZDOBuildBuf, (matchED->ed1numMatched * sizeof ( uint16 )) );
   1847                  }
   1848                  else
   1849                  {
   1850                    // Allocation error, stop
   1851                    status = ZDP_NO_ENTRY;
   1852                    sendRsp = TRUE;
   1853                  }
   1854                }
   1855          
   1856                // Make a source match for ed2
   1857                matchED->ed2numMatched = ZDO_CompareClusterLists(
   1858                            matchED->ed2.numOutClusters, matchED->ed2.outClusters,
   1859                            matchED->ed1.numInClusters, matchED->ed1.inClusters, ZDOBuildBuf );
   1860                if ( matchED->ed2numMatched )
   1861                {
   1862                  // Save the match list
   1863                  matchED->ed2Matched = osal_mem_alloc( (short)(matchED->ed2numMatched * sizeof ( uint16 )) );
   1864                  if ( matchED->ed2Matched )
   1865                  {
   1866                    osal_memcpy( matchED->ed2Matched, ZDOBuildBuf, (matchED->ed2numMatched * sizeof ( uint16 )) );
   1867                  }
   1868                  else
   1869                  {
   1870                    // Allocation error, stop
   1871                    status = ZDP_NO_ENTRY;
   1872                    sendRsp = TRUE;
   1873                  }
   1874                }
   1875          
   1876                if ( (sendRsp == FALSE) && (matchED->ed1numMatched || matchED->ed2numMatched) )
   1877                {
   1878                  // Do the first unbind/bind state
   1879                  ZDMatchSendState( ZDMATCH_REASON_START, ZDP_SUCCESS, 0 );
   1880                }
   1881                else
   1882                {
   1883                  status = ZDP_NO_MATCH;
   1884                  sendRsp = TRUE;
   1885                }
   1886            }
   1887          
   1888            if ( sendRsp )
   1889            {
   1890              // send response to this requester
   1891              dstAddr.addrMode = Addr16Bit;
   1892              dstAddr.addr.shortAddr = bindReq->srcAddr;
   1893              ZDP_EndDeviceBindRsp( bindReq->TransSeq, &dstAddr, status, bindReq->SecurityUse );
   1894          
   1895              if ( matchED->state == ZDMATCH_SENDING_BINDS )
   1896              {
   1897                // send response to first requester
   1898                dstAddr.addrMode = Addr16Bit;
   1899                dstAddr.addr.shortAddr = matchED->ed1.srcAddr;
   1900                ZDP_EndDeviceBindRsp( matchED->ed1.TransSeq, &dstAddr, status, matchED->ed1.SecurityUse );
   1901              }
   1902          
   1903              // Process ended - release memory used
   1904              ZDO_RemoveMatchMemory();
   1905            }
   1906          }
   1907          
   1908          static void ZDO_RemoveMatchMemory( void )
   1909          {
   1910            if ( matchED )
   1911            {
   1912              if ( matchED->ed2Matched )
   1913                osal_mem_free( matchED->ed2Matched );
   1914              if ( matchED->ed1Matched )
   1915                osal_mem_free( matchED->ed1Matched );
   1916          
   1917              if ( matchED->ed1.inClusters )
   1918                osal_mem_free( matchED->ed1.inClusters );
   1919          
   1920              if ( matchED->ed1.outClusters )
   1921                osal_mem_free( matchED->ed1.outClusters );
   1922          
   1923              if ( matchED->ed2.inClusters )
   1924                osal_mem_free( matchED->ed2.inClusters );
   1925          
   1926              if ( matchED->ed2.outClusters )
   1927                osal_mem_free( matchED->ed2.outClusters );
   1928          
   1929              osal_mem_free( matchED );
   1930          
   1931              matchED = (ZDMatchEndDeviceBind_t *)NULL;
   1932            }
   1933          }
   1934          
   1935          static uint8 ZDO_CopyMatchInfo( ZDEndDeviceBind_t *destReq, ZDEndDeviceBind_t *srcReq )
   1936          {
   1937            uint8 allOK = TRUE;
   1938          
   1939            // Copy bind information into the match info structure
   1940            osal_memcpy( (uint8 *)destReq, srcReq, sizeof ( ZDEndDeviceBind_t ) );
   1941          
   1942            // Copy input cluster IDs
   1943            if ( srcReq->numInClusters )
   1944            {
   1945              destReq->inClusters = osal_mem_alloc( (short)(srcReq->numInClusters * sizeof ( uint16 )) );
   1946              if ( destReq->inClusters )
   1947              {
   1948                // Copy the clusters
   1949                osal_memcpy( (uint8*)(destReq->inClusters), (uint8 *)(srcReq->inClusters),
   1950                                (srcReq->numInClusters * sizeof ( uint16 )) );
   1951              }
   1952              else
   1953                allOK = FALSE;
   1954            }
   1955          
   1956            // Copy output cluster IDs
   1957            if ( srcReq->numOutClusters )
   1958            {
   1959              destReq->outClusters = osal_mem_alloc( (short)(srcReq->numOutClusters * sizeof ( uint16 )) );
   1960              if ( destReq->outClusters )
   1961              {
   1962                // Copy the clusters
   1963                osal_memcpy( (uint8 *)(destReq->outClusters), (uint8 *)(srcReq->outClusters),
   1964                                (srcReq->numOutClusters * sizeof ( uint16 )) );
   1965              }
   1966              else
   1967                allOK = FALSE;
   1968            }
   1969          
   1970            if ( !allOK )
   1971            {
   1972              if ( destReq->inClusters )
   1973                osal_mem_free( destReq->inClusters );
   1974              if ( destReq->outClusters )
   1975                osal_mem_free( destReq->outClusters );
   1976            }
   1977          
   1978            return ( allOK );
   1979          }
   1980          
   1981          uint8 ZDMatchSendState( uint8 reason, uint8 status, uint8 TransSeq )
   1982          {
   1983            uint8 *dstIEEEAddr;
   1984            uint8 dstEP;
   1985            zAddrType_t dstAddr;
   1986            zAddrType_t destinationAddr;
   1987            uint16 msgType;
   1988            uint16 clusterID;
   1989            ZDEndDeviceBind_t *ed = NULL;
   1990            uint8 rspStatus = ZDP_SUCCESS;
   1991          
   1992            if ( matchED == NULL )
   1993              return ( FALSE );
   1994          
   1995            // Check sequence number
   1996            if ( reason == ZDMATCH_REASON_BIND_RSP || reason == ZDMATCH_REASON_UNBIND_RSP )
   1997            {
   1998              if ( TransSeq != matchED->transSeq )
   1999                return( FALSE ); // ignore the message
   2000            }
   2001          
   2002            // turn off timer
   2003            APS_SetEndDeviceBindTimeout( 0, ZDO_EndDeviceBindMatchTimeoutCB );
   2004          
   2005            if ( reason == ZDMATCH_REASON_TIMEOUT )
   2006            {
   2007              rspStatus = ZDP_TIMEOUT;    // The process will stop
   2008            }
   2009          
   2010            if ( reason == ZDMATCH_REASON_START || reason == ZDMATCH_REASON_BIND_RSP )
   2011            {
   2012              matchED->sending = ZDMATCH_SENDING_UNBIND;
   2013          
   2014              if ( reason == ZDMATCH_REASON_BIND_RSP && status != ZDP_SUCCESS )
   2015              {
   2016                rspStatus = status;
   2017              }
   2018            }
   2019            else if ( reason == ZDMATCH_REASON_UNBIND_RSP )
   2020            {
   2021              if ( status == ZDP_SUCCESS )
   2022              {
   2023                matchED->sending = ZDMATCH_SENDING_UNBIND;
   2024              }
   2025              else
   2026              {
   2027                matchED->sending = ZDMATCH_SENDING_BIND;
   2028              }
   2029            }
   2030          
   2031            if ( reason != ZDMATCH_REASON_START && matchED->sending == ZDMATCH_SENDING_UNBIND )
   2032            {
   2033              // Move to the next cluster ID
   2034              if ( matchED->ed1numMatched )
   2035                matchED->ed1numMatched--;
   2036              else if ( matchED->ed2numMatched )
   2037                matchED->ed2numMatched--;
   2038            }
   2039          
   2040            // What message do we send now
   2041            if ( matchED->ed1numMatched )
   2042            {
   2043              ed = &(matchED->ed1);
   2044              clusterID = matchED->ed1Matched[matchED->ed1numMatched-1];
   2045              dstIEEEAddr = matchED->ed2.ieeeAddr;
   2046              dstEP = matchED->ed2.endpoint;
   2047            }
   2048            else if ( matchED->ed2numMatched )
   2049            {
   2050              ed = &(matchED->ed2);
   2051              clusterID = matchED->ed2Matched[matchED->ed2numMatched-1];
   2052              dstIEEEAddr = matchED->ed1.ieeeAddr;
   2053              dstEP = matchED->ed1.endpoint;
   2054            }
   2055          
   2056            dstAddr.addrMode = Addr16Bit;
   2057          
   2058            // Send the next message
   2059            if ( rspStatus == ZDP_SUCCESS && ed )
   2060            {
   2061              // Send unbind/bind message to source
   2062              if ( matchED->sending == ZDMATCH_SENDING_UNBIND )
   2063                msgType = Unbind_req;
   2064              else
   2065                msgType = Bind_req;
   2066          
   2067              dstAddr.addr.shortAddr = ed->srcAddr;
   2068          
   2069              // Save off the transaction sequence number
   2070              matchED->transSeq = ZDP_TransID;
   2071          
   2072              destinationAddr.addrMode = Addr64Bit;
   2073              osal_cpyExtAddr( destinationAddr.addr.extAddr, dstIEEEAddr );
   2074          
   2075              ZDP_BindUnbindReq( msgType, &dstAddr, ed->ieeeAddr, ed->endpoint, clusterID,
   2076                  &destinationAddr, dstEP, ed->SecurityUse );
   2077          
   2078              // Set timeout for response
   2079              APS_SetEndDeviceBindTimeout( AIB_MaxBindingTime, ZDO_EndDeviceBindMatchTimeoutCB );
   2080            }
   2081            else
   2082            {
   2083              // Send the response messages to requesting devices
   2084              // send response to first requester
   2085              dstAddr.addr.shortAddr = matchED->ed1.srcAddr;
   2086              ZDP_EndDeviceBindRsp( matchED->ed1.TransSeq, &dstAddr, rspStatus, matchED->ed1.SecurityUse );
   2087          
   2088              // send response to second requester
   2089              if ( matchED->state == ZDMATCH_SENDING_BINDS )
   2090              {
   2091                dstAddr.addr.shortAddr = matchED->ed2.srcAddr;
   2092                ZDP_EndDeviceBindRsp( matchED->ed2.TransSeq, &dstAddr, rspStatus, matchED->ed2.SecurityUse );
   2093              }
   2094          
   2095              // Process ended - release memory used
   2096              ZDO_RemoveMatchMemory();
   2097            }
   2098          
   2099            return ( TRUE );
   2100          }
   2101          
   2102          static void ZDO_EndDeviceBindMatchTimeoutCB( void )
   2103          {
   2104            ZDMatchSendState( ZDMATCH_REASON_TIMEOUT, ZDP_TIMEOUT, 0 );
   2105          }
   2106          
   2107          #endif // ZDO_COORDINATOR
   2108          
   2109          /*********************************************************************
   2110           * ZDO MESSAGE PARSING API FUNCTIONS
   2111           */
   2112          
   2113          /*********************************************************************
   2114           * @fn          ZDO_ParseEndDeviceBindReq
   2115           *
   2116           * @brief       This function parses the End_Device_Bind_req message.
   2117           *
   2118           *     NOTE:  The clusters lists in bindReq are allocated in this
   2119           *            function and must be freed by that calling function.
   2120           *
   2121           * @param       inMsg  - incoming message (request)
   2122           * @param       bindReq - pointer to place to parse message to
   2123           *
   2124           * @return      none
   2125           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   2126          void ZDO_ParseEndDeviceBindReq( zdoIncomingMsg_t *inMsg, ZDEndDeviceBind_t *bindReq )
   \                     ZDO_ParseEndDeviceBindReq:
   2127          {
   \   000000   74F2         MOV     A,#-0xe
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 14
   \   000005                ; Auto size: 0
   \   000005   8A..         MOV     ?V0 + 2,R2
   \   000007   8B..         MOV     ?V0 + 3,R3
   \   000009   8C..         MOV     ?V0 + 0,R4
   \   00000B   8D..         MOV     ?V0 + 1,R5
   2128            uint8 *msg;
   2129          
   2130            // Parse the message
   2131            bindReq->TransSeq = inMsg->TransSeq;
   \   00000D   E5..         MOV     A,?V0 + 2
   \   00000F   240F         ADD     A,#0xf
   \   000011   F582         MOV     DPL,A
   \   000013   E5..         MOV     A,?V0 + 3
   \   000015   3400         ADDC    A,#0x0
   \   000017   F583         MOV     DPH,A
   \   000019   E0           MOVX    A,@DPTR
   \   00001A   85..82       MOV     DPL,?V0 + 0
   \   00001D   85..83       MOV     DPH,?V0 + 1
   \   000020   F0           MOVX    @DPTR,A
   2132            bindReq->srcAddr = inMsg->srcAddr.addr.shortAddr;
   \   000021   85..82       MOV     DPL,?V0 + 2
   \   000024   85..83       MOV     DPH,?V0 + 3
   \   000027   A3           INC     DPTR
   \   000028   A3           INC     DPTR
   \   000029   E0           MOVX    A,@DPTR
   \   00002A   F8           MOV     R0,A
   \   00002B   A3           INC     DPTR
   \   00002C   E0           MOVX    A,@DPTR
   \   00002D   F9           MOV     R1,A
   \   00002E   85..82       MOV     DPL,?V0 + 0
   \   000031   85..83       MOV     DPH,?V0 + 1
   \   000034   A3           INC     DPTR
   \   000035   A3           INC     DPTR
   \   000036   E8           MOV     A,R0
   \   000037   F0           MOVX    @DPTR,A
   \   000038   A3           INC     DPTR
   \   000039   E9           MOV     A,R1
   \   00003A   F0           MOVX    @DPTR,A
   2133            bindReq->SecurityUse = inMsg->SecurityUse;
   \   00003B   E5..         MOV     A,?V0 + 2
   \   00003D   240E         ADD     A,#0xe
   \   00003F   F582         MOV     DPL,A
   \   000041   E5..         MOV     A,?V0 + 3
   \   000043   3400         ADDC    A,#0x0
   \   000045   F583         MOV     DPH,A
   \   000047   E0           MOVX    A,@DPTR
   \   000048   85..82       MOV     DPL,?V0 + 0
   \   00004B   85..83       MOV     DPH,?V0 + 1
   \   00004E   A3           INC     DPTR
   \   00004F   F0           MOVX    @DPTR,A
   2134            msg = inMsg->asdu;
   \   000050   E5..         MOV     A,?V0 + 2
   \   000052   2411         ADD     A,#0x11
   \   000054   F582         MOV     DPL,A
   \   000056   E5..         MOV     A,?V0 + 3
   \   000058   3400         ADDC    A,#0x0
   \   00005A   F583         MOV     DPH,A
   \   00005C   E0           MOVX    A,@DPTR
   \   00005D   F8           MOV     R0,A
   \   00005E   A3           INC     DPTR
   \   00005F   E0           MOVX    A,@DPTR
   \   000060   F9           MOV     R1,A
   \   000061   E8           MOV     A,R0
   \   000062   FE           MOV     R6,A
   \   000063   E9           MOV     A,R1
   \   000064   FF           MOV     R7,A
   2135          
   2136            bindReq->localCoordinator = BUILD_UINT16( msg[0], msg[1] );
   \   000065   8E82         MOV     DPL,R6
   \   000067   8F83         MOV     DPH,R7
   \   000069   E0           MOVX    A,@DPTR
   \   00006A   FA           MOV     R2,A
   \   00006B   7B00         MOV     R3,#0x0
   \   00006D   8E82         MOV     DPL,R6
   \   00006F   8F83         MOV     DPH,R7
   \   000071   A3           INC     DPTR
   \   000072   E0           MOVX    A,@DPTR
   \   000073   F8           MOV     R0,A
   \   000074   E4           CLR     A
   \   000075   C8           XCH     A,R0
   \   000076   F9           MOV     R1,A
   \   000077   E8           MOV     A,R0
   \   000078   2A           ADD     A,R2
   \   000079   F8           MOV     R0,A
   \   00007A   E9           MOV     A,R1
   \   00007B   3B           ADDC    A,R3
   \   00007C   F9           MOV     R1,A
   \   00007D   85..82       MOV     DPL,?V0 + 0
   \   000080   85..83       MOV     DPH,?V0 + 1
   \   000083   A3           INC     DPTR
   \   000084   A3           INC     DPTR
   \   000085   A3           INC     DPTR
   \   000086   A3           INC     DPTR
   \   000087   E8           MOV     A,R0
   \   000088   F0           MOVX    @DPTR,A
   \   000089   A3           INC     DPTR
   \   00008A   E9           MOV     A,R1
   \   00008B   F0           MOVX    @DPTR,A
   2137            msg += 2;
   \   00008C   EE           MOV     A,R6
   \   00008D   2402         ADD     A,#0x2
   \   00008F   FE           MOV     R6,A
   \   000090   EF           MOV     A,R7
   \   000091   3400         ADDC    A,#0x0
   \   000093   FF           MOV     R7,A
   2138          
   2139            osal_cpyExtAddr( &(bindReq->ieeeAddr), msg );
   \   000094                ; Setup parameters for call to function osal_cpyExtAddr
   \   000094   EE           MOV     A,R6
   \   000095   FC           MOV     R4,A
   \   000096   EF           MOV     A,R7
   \   000097   FD           MOV     R5,A
   \   000098   E5..         MOV     A,?V0 + 0
   \   00009A   2406         ADD     A,#0x6
   \   00009C   FA           MOV     R2,A
   \   00009D   E5..         MOV     A,?V0 + 1
   \   00009F   3400         ADDC    A,#0x0
   \   0000A1   FB           MOV     R3,A
   \   0000A2   12....       LCALL   ??osal_cpyExtAddr?relay
   2140            msg += Z_EXTADDR_LEN;
   \   0000A5   EE           MOV     A,R6
   \   0000A6   2408         ADD     A,#0x8
   \   0000A8   FE           MOV     R6,A
   \   0000A9   EF           MOV     A,R7
   \   0000AA   3400         ADDC    A,#0x0
   \   0000AC   FF           MOV     R7,A
   2141          
   2142            bindReq->endpoint = *msg++;
   \   0000AD   8E82         MOV     DPL,R6
   \   0000AF   8F83         MOV     DPH,R7
   \   0000B1   E0           MOVX    A,@DPTR
   \   0000B2   C0E0         PUSH    A
   \   0000B4   E5..         MOV     A,?V0 + 0
   \   0000B6   240E         ADD     A,#0xe
   \   0000B8   F582         MOV     DPL,A
   \   0000BA   E5..         MOV     A,?V0 + 1
   \   0000BC   3400         ADDC    A,#0x0
   \   0000BE   F583         MOV     DPH,A
   \   0000C0   D0E0         POP     A
   \   0000C2   F0           MOVX    @DPTR,A
   \   0000C3   8E82         MOV     DPL,R6
   \   0000C5   8F83         MOV     DPH,R7
   \   0000C7   A3           INC     DPTR
   \   0000C8   AE82         MOV     R6,DPL
   \   0000CA   AF83         MOV     R7,DPH
   2143            bindReq->profileID = BUILD_UINT16( msg[0], msg[1] );
   \   0000CC   8E82         MOV     DPL,R6
   \   0000CE   8F83         MOV     DPH,R7
   \   0000D0   E0           MOVX    A,@DPTR
   \   0000D1   FA           MOV     R2,A
   \   0000D2   7B00         MOV     R3,#0x0
   \   0000D4   8E82         MOV     DPL,R6
   \   0000D6   8F83         MOV     DPH,R7
   \   0000D8   A3           INC     DPTR
   \   0000D9   E0           MOVX    A,@DPTR
   \   0000DA   F8           MOV     R0,A
   \   0000DB   E4           CLR     A
   \   0000DC   C8           XCH     A,R0
   \   0000DD   F9           MOV     R1,A
   \   0000DE   E8           MOV     A,R0
   \   0000DF   2A           ADD     A,R2
   \   0000E0   F8           MOV     R0,A
   \   0000E1   E9           MOV     A,R1
   \   0000E2   3B           ADDC    A,R3
   \   0000E3   F9           MOV     R1,A
   \   0000E4   E5..         MOV     A,?V0 + 0
   \   0000E6   240F         ADD     A,#0xf
   \   0000E8   F582         MOV     DPL,A
   \   0000EA   E5..         MOV     A,?V0 + 1
   \   0000EC   3400         ADDC    A,#0x0
   \   0000EE   F583         MOV     DPH,A
   \   0000F0   E8           MOV     A,R0
   \   0000F1   F0           MOVX    @DPTR,A
   \   0000F2   A3           INC     DPTR
   \   0000F3   E9           MOV     A,R1
   \   0000F4   F0           MOVX    @DPTR,A
   2144            msg += 2;
   \   0000F5   EE           MOV     A,R6
   \   0000F6   2402         ADD     A,#0x2
   \   0000F8   FE           MOV     R6,A
   \   0000F9   EF           MOV     A,R7
   \   0000FA   3400         ADDC    A,#0x0
   \   0000FC   FF           MOV     R7,A
   2145          
   2146            bindReq->numInClusters = *msg++;
   \   0000FD   8E82         MOV     DPL,R6
   \   0000FF   8F83         MOV     DPH,R7
   \   000101   E0           MOVX    A,@DPTR
   \   000102   C0E0         PUSH    A
   \   000104   E5..         MOV     A,?V0 + 0
   \   000106   2411         ADD     A,#0x11
   \   000108   F582         MOV     DPL,A
   \   00010A   E5..         MOV     A,?V0 + 1
   \   00010C   3400         ADDC    A,#0x0
   \   00010E   F583         MOV     DPH,A
   \   000110   D0E0         POP     A
   \   000112   F0           MOVX    @DPTR,A
   \   000113   8E82         MOV     DPL,R6
   \   000115   8F83         MOV     DPH,R7
   \   000117   A3           INC     DPTR
   \   000118   AE82         MOV     R6,DPL
   \   00011A   AF83         MOV     R7,DPH
   2147            bindReq->inClusters = NULL;
   \   00011C   E5..         MOV     A,?V0 + 0
   \   00011E   2412         ADD     A,#0x12
   \   000120   F582         MOV     DPL,A
   \   000122   E5..         MOV     A,?V0 + 1
   \   000124   3400         ADDC    A,#0x0
   \   000126   F583         MOV     DPH,A
   \   000128   7400         MOV     A,#0x0
   \   00012A   F0           MOVX    @DPTR,A
   \   00012B   A3           INC     DPTR
   \   00012C   7400         MOV     A,#0x0
   \   00012E   F0           MOVX    @DPTR,A
   2148            if ( bindReq->numInClusters )
   \   00012F   E5..         MOV     A,?V0 + 0
   \   000131   2411         ADD     A,#0x11
   \   000133   F582         MOV     DPL,A
   \   000135   E5..         MOV     A,?V0 + 1
   \   000137   3400         ADDC    A,#0x0
   \   000139   F583         MOV     DPH,A
   \   00013B   E0           MOVX    A,@DPTR
   \   00013C   6067         JZ      ??ZDO_ParseEndDeviceBindReq_0
   2149            {
   2150              bindReq->inClusters = (uint16*)osal_mem_alloc( (bindReq->numInClusters * sizeof( uint16 )) );
   \   00013E                ; Setup parameters for call to function osal_mem_alloc
   \   00013E   E5..         MOV     A,?V0 + 0
   \   000140   2411         ADD     A,#0x11
   \   000142   F582         MOV     DPL,A
   \   000144   E5..         MOV     A,?V0 + 1
   \   000146   3400         ADDC    A,#0x0
   \   000148   F583         MOV     DPH,A
   \   00014A   E0           MOVX    A,@DPTR
   \   00014B   FA           MOV     R2,A
   \   00014C   7B00         MOV     R3,#0x0
   \   00014E   EA           MOV     A,R2
   \   00014F   75F002       MOV     B,#0x2
   \   000152   A4           MUL     AB
   \   000153   CA           XCH     A,R2
   \   000154   ACF0         MOV     R4,B
   \   000156   75F000       MOV     B,#0x0
   \   000159   A4           MUL     AB
   \   00015A   2C           ADD     A,R4
   \   00015B   FC           MOV     R4,A
   \   00015C   75F002       MOV     B,#0x2
   \   00015F   EB           MOV     A,R3
   \   000160   A4           MUL     AB
   \   000161   2C           ADD     A,R4
   \   000162   FB           MOV     R3,A
   \   000163   12....       LCALL   ??osal_mem_alloc?relay
   \   000166   E5..         MOV     A,?V0 + 0
   \   000168   2412         ADD     A,#0x12
   \   00016A   F582         MOV     DPL,A
   \   00016C   E5..         MOV     A,?V0 + 1
   \   00016E   3400         ADDC    A,#0x0
   \   000170   F583         MOV     DPH,A
   \   000172   EA           MOV     A,R2
   \   000173   F0           MOVX    @DPTR,A
   \   000174   A3           INC     DPTR
   \   000175   EB           MOV     A,R3
   \   000176   F0           MOVX    @DPTR,A
   2151              msg = ZDO_ConvertOTAClusters( bindReq->numInClusters, msg, bindReq->inClusters );
   \   000177                ; Setup parameters for call to function ZDO_ConvertOTAClusters
   \   000177   E5..         MOV     A,?V0 + 0
   \   000179   2412         ADD     A,#0x12
   \   00017B   F582         MOV     DPL,A
   \   00017D   E5..         MOV     A,?V0 + 1
   \   00017F   3400         ADDC    A,#0x0
   \   000181   F583         MOV     DPH,A
   \   000183   E0           MOVX    A,@DPTR
   \   000184   FC           MOV     R4,A
   \   000185   A3           INC     DPTR
   \   000186   E0           MOVX    A,@DPTR
   \   000187   FD           MOV     R5,A
   \   000188   EE           MOV     A,R6
   \   000189   FA           MOV     R2,A
   \   00018A   EF           MOV     A,R7
   \   00018B   FB           MOV     R3,A
   \   00018C   E5..         MOV     A,?V0 + 0
   \   00018E   2411         ADD     A,#0x11
   \   000190   F582         MOV     DPL,A
   \   000192   E5..         MOV     A,?V0 + 1
   \   000194   3400         ADDC    A,#0x0
   \   000196   F583         MOV     DPH,A
   \   000198   E0           MOVX    A,@DPTR
   \   000199   F9           MOV     R1,A
   \   00019A   12....       LCALL   ??ZDO_ConvertOTAClusters?relay
   \   00019D   8A..         MOV     ?V0 + 4,R2
   \   00019F   8B..         MOV     ?V0 + 5,R3
   \   0001A1   AE..         MOV     R6,?V0 + 4
   \   0001A3   AF..         MOV     R7,?V0 + 5
   2152            }
   2153          
   2154            bindReq->numOutClusters = *msg++;
   \                     ??ZDO_ParseEndDeviceBindReq_0:
   \   0001A5   8E82         MOV     DPL,R6
   \   0001A7   8F83         MOV     DPH,R7
   \   0001A9   E0           MOVX    A,@DPTR
   \   0001AA   C0E0         PUSH    A
   \   0001AC   E5..         MOV     A,?V0 + 0
   \   0001AE   2414         ADD     A,#0x14
   \   0001B0   F582         MOV     DPL,A
   \   0001B2   E5..         MOV     A,?V0 + 1
   \   0001B4   3400         ADDC    A,#0x0
   \   0001B6   F583         MOV     DPH,A
   \   0001B8   D0E0         POP     A
   \   0001BA   F0           MOVX    @DPTR,A
   \   0001BB   8E82         MOV     DPL,R6
   \   0001BD   8F83         MOV     DPH,R7
   \   0001BF   A3           INC     DPTR
   \   0001C0   AE82         MOV     R6,DPL
   \   0001C2   AF83         MOV     R7,DPH
   2155            bindReq->outClusters = NULL;
   \   0001C4   E5..         MOV     A,?V0 + 0
   \   0001C6   2415         ADD     A,#0x15
   \   0001C8   F582         MOV     DPL,A
   \   0001CA   E5..         MOV     A,?V0 + 1
   \   0001CC   3400         ADDC    A,#0x0
   \   0001CE   F583         MOV     DPH,A
   \   0001D0   7400         MOV     A,#0x0
   \   0001D2   F0           MOVX    @DPTR,A
   \   0001D3   A3           INC     DPTR
   \   0001D4   7400         MOV     A,#0x0
   \   0001D6   F0           MOVX    @DPTR,A
   2156            if ( bindReq->numOutClusters )
   \   0001D7   E5..         MOV     A,?V0 + 0
   \   0001D9   2414         ADD     A,#0x14
   \   0001DB   F582         MOV     DPL,A
   \   0001DD   E5..         MOV     A,?V0 + 1
   \   0001DF   3400         ADDC    A,#0x0
   \   0001E1   F583         MOV     DPH,A
   \   0001E3   E0           MOVX    A,@DPTR
   \   0001E4   605F         JZ      ??ZDO_ParseEndDeviceBindReq_1
   2157            {
   2158              bindReq->outClusters = (uint16*)osal_mem_alloc( (bindReq->numOutClusters * sizeof( uint16 )) );
   \   0001E6                ; Setup parameters for call to function osal_mem_alloc
   \   0001E6   E5..         MOV     A,?V0 + 0
   \   0001E8   2414         ADD     A,#0x14
   \   0001EA   F582         MOV     DPL,A
   \   0001EC   E5..         MOV     A,?V0 + 1
   \   0001EE   3400         ADDC    A,#0x0
   \   0001F0   F583         MOV     DPH,A
   \   0001F2   E0           MOVX    A,@DPTR
   \   0001F3   FA           MOV     R2,A
   \   0001F4   7B00         MOV     R3,#0x0
   \   0001F6   EA           MOV     A,R2
   \   0001F7   75F002       MOV     B,#0x2
   \   0001FA   A4           MUL     AB
   \   0001FB   CA           XCH     A,R2
   \   0001FC   ACF0         MOV     R4,B
   \   0001FE   75F000       MOV     B,#0x0
   \   000201   A4           MUL     AB
   \   000202   2C           ADD     A,R4
   \   000203   FC           MOV     R4,A
   \   000204   75F002       MOV     B,#0x2
   \   000207   EB           MOV     A,R3
   \   000208   A4           MUL     AB
   \   000209   2C           ADD     A,R4
   \   00020A   FB           MOV     R3,A
   \   00020B   12....       LCALL   ??osal_mem_alloc?relay
   \   00020E   E5..         MOV     A,?V0 + 0
   \   000210   2415         ADD     A,#0x15
   \   000212   F582         MOV     DPL,A
   \   000214   E5..         MOV     A,?V0 + 1
   \   000216   3400         ADDC    A,#0x0
   \   000218   F583         MOV     DPH,A
   \   00021A   EA           MOV     A,R2
   \   00021B   F0           MOVX    @DPTR,A
   \   00021C   A3           INC     DPTR
   \   00021D   EB           MOV     A,R3
   \   00021E   F0           MOVX    @DPTR,A
   2159              msg = ZDO_ConvertOTAClusters( bindReq->numOutClusters, msg, bindReq->outClusters );
   \   00021F                ; Setup parameters for call to function ZDO_ConvertOTAClusters
   \   00021F   E5..         MOV     A,?V0 + 0
   \   000221   2415         ADD     A,#0x15
   \   000223   F582         MOV     DPL,A
   \   000225   E5..         MOV     A,?V0 + 1
   \   000227   3400         ADDC    A,#0x0
   \   000229   F583         MOV     DPH,A
   \   00022B   E0           MOVX    A,@DPTR
   \   00022C   FC           MOV     R4,A
   \   00022D   A3           INC     DPTR
   \   00022E   E0           MOVX    A,@DPTR
   \   00022F   FD           MOV     R5,A
   \   000230   EE           MOV     A,R6
   \   000231   FA           MOV     R2,A
   \   000232   EF           MOV     A,R7
   \   000233   FB           MOV     R3,A
   \   000234   E5..         MOV     A,?V0 + 0
   \   000236   2414         ADD     A,#0x14
   \   000238   F582         MOV     DPL,A
   \   00023A   E5..         MOV     A,?V0 + 1
   \   00023C   3400         ADDC    A,#0x0
   \   00023E   F583         MOV     DPH,A
   \   000240   E0           MOVX    A,@DPTR
   \   000241   F9           MOV     R1,A
   \   000242   12....       LCALL   ??ZDO_ConvertOTAClusters?relay
   2160            }
   2161          }
   \                     ??ZDO_ParseEndDeviceBindReq_1:
   \   000245   7F06         MOV     R7,#0x6
   \   000247   02....       LJMP    ?BANKED_LEAVE_XDATA
   2162          
   2163          /*********************************************************************
   2164           * @fn          ZDO_ParseBindUnbindReq
   2165           *
   2166           * @brief       This function parses the Bind_req or Unbind_req message.
   2167           *
   2168           * @param       inMsg  - incoming message (request)
   2169           * @param       pReq - place to put parsed information
   2170           *
   2171           * @return      none
   2172           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   2173          void ZDO_ParseBindUnbindReq( zdoIncomingMsg_t *inMsg, ZDO_BindUnbindReq_t *pReq )
   \                     ZDO_ParseBindUnbindReq:
   2174          {
   \   000000   74F4         MOV     A,#-0xc
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 12
   \   000005                ; Auto size: 0
   \   000005   8A..         MOV     ?V0 + 2,R2
   \   000007   8B..         MOV     ?V0 + 3,R3
   \   000009   8C..         MOV     ?V0 + 0,R4
   \   00000B   8D..         MOV     ?V0 + 1,R5
   2175            uint8 *msg;
   2176          
   2177            msg = inMsg->asdu;
   \   00000D   E5..         MOV     A,?V0 + 2
   \   00000F   2411         ADD     A,#0x11
   \   000011   F582         MOV     DPL,A
   \   000013   E5..         MOV     A,?V0 + 3
   \   000015   3400         ADDC    A,#0x0
   \   000017   F583         MOV     DPH,A
   \   000019   E0           MOVX    A,@DPTR
   \   00001A   F8           MOV     R0,A
   \   00001B   A3           INC     DPTR
   \   00001C   E0           MOVX    A,@DPTR
   \   00001D   F9           MOV     R1,A
   \   00001E   E8           MOV     A,R0
   \   00001F   FE           MOV     R6,A
   \   000020   E9           MOV     A,R1
   \   000021   FF           MOV     R7,A
   2178            osal_cpyExtAddr( pReq->srcAddress, msg );
   \   000022                ; Setup parameters for call to function osal_cpyExtAddr
   \   000022   EE           MOV     A,R6
   \   000023   FC           MOV     R4,A
   \   000024   EF           MOV     A,R7
   \   000025   FD           MOV     R5,A
   \   000026   AA..         MOV     R2,?V0 + 0
   \   000028   AB..         MOV     R3,?V0 + 1
   \   00002A   12....       LCALL   ??osal_cpyExtAddr?relay
   2179            msg += Z_EXTADDR_LEN;
   \   00002D   EE           MOV     A,R6
   \   00002E   2408         ADD     A,#0x8
   \   000030   FE           MOV     R6,A
   \   000031   EF           MOV     A,R7
   \   000032   3400         ADDC    A,#0x0
   \   000034   FF           MOV     R7,A
   2180            pReq->srcEndpoint = *msg++;
   \   000035   8E82         MOV     DPL,R6
   \   000037   8F83         MOV     DPH,R7
   \   000039   E0           MOVX    A,@DPTR
   \   00003A   85..82       MOV     DPL,?V0 + 0
   \   00003D   85..83       MOV     DPH,?V0 + 1
   \   000040   A3           INC     DPTR
   \   000041   A3           INC     DPTR
   \   000042   A3           INC     DPTR
   \   000043   A3           INC     DPTR
   \   000044   A3           INC     DPTR
   \   000045   A3           INC     DPTR
   \   000046   A3           INC     DPTR
   \   000047   A3           INC     DPTR
   \   000048   F0           MOVX    @DPTR,A
   \   000049   8E82         MOV     DPL,R6
   \   00004B   8F83         MOV     DPH,R7
   \   00004D   A3           INC     DPTR
   \   00004E   AE82         MOV     R6,DPL
   \   000050   AF83         MOV     R7,DPH
   2181            pReq->clusterID = BUILD_UINT16( msg[0], msg[1] );
   \   000052   8E82         MOV     DPL,R6
   \   000054   8F83         MOV     DPH,R7
   \   000056   E0           MOVX    A,@DPTR
   \   000057   FA           MOV     R2,A
   \   000058   7B00         MOV     R3,#0x0
   \   00005A   8E82         MOV     DPL,R6
   \   00005C   8F83         MOV     DPH,R7
   \   00005E   A3           INC     DPTR
   \   00005F   E0           MOVX    A,@DPTR
   \   000060   F8           MOV     R0,A
   \   000061   E4           CLR     A
   \   000062   C8           XCH     A,R0
   \   000063   F9           MOV     R1,A
   \   000064   E8           MOV     A,R0
   \   000065   2A           ADD     A,R2
   \   000066   F8           MOV     R0,A
   \   000067   E9           MOV     A,R1
   \   000068   3B           ADDC    A,R3
   \   000069   F9           MOV     R1,A
   \   00006A   85..82       MOV     DPL,?V0 + 0
   \   00006D   85..83       MOV     DPH,?V0 + 1
   \   000070   A3           INC     DPTR
   \   000071   A3           INC     DPTR
   \   000072   A3           INC     DPTR
   \   000073   A3           INC     DPTR
   \   000074   A3           INC     DPTR
   \   000075   A3           INC     DPTR
   \   000076   A3           INC     DPTR
   \   000077   A3           INC     DPTR
   \   000078   A3           INC     DPTR
   \   000079   E8           MOV     A,R0
   \   00007A   F0           MOVX    @DPTR,A
   \   00007B   A3           INC     DPTR
   \   00007C   E9           MOV     A,R1
   \   00007D   F0           MOVX    @DPTR,A
   2182            msg += 2;
   \   00007E   EE           MOV     A,R6
   \   00007F   2402         ADD     A,#0x2
   \   000081   FE           MOV     R6,A
   \   000082   EF           MOV     A,R7
   \   000083   3400         ADDC    A,#0x0
   \   000085   FF           MOV     R7,A
   2183            pReq->dstAddress.addrMode = *msg++;
   \   000086   8E82         MOV     DPL,R6
   \   000088   8F83         MOV     DPH,R7
   \   00008A   E0           MOVX    A,@DPTR
   \   00008B   C0E0         PUSH    A
   \   00008D   E5..         MOV     A,?V0 + 0
   \   00008F   2413         ADD     A,#0x13
   \   000091   F582         MOV     DPL,A
   \   000093   E5..         MOV     A,?V0 + 1
   \   000095   3400         ADDC    A,#0x0
   \   000097   F583         MOV     DPH,A
   \   000099   D0E0         POP     A
   \   00009B   F0           MOVX    @DPTR,A
   \   00009C   8E82         MOV     DPL,R6
   \   00009E   8F83         MOV     DPH,R7
   \   0000A0   A3           INC     DPTR
   \   0000A1   AE82         MOV     R6,DPL
   \   0000A3   AF83         MOV     R7,DPH
   2184            if ( pReq->dstAddress.addrMode == Addr64Bit )
   \   0000A5   E5..         MOV     A,?V0 + 0
   \   0000A7   2413         ADD     A,#0x13
   \   0000A9   F582         MOV     DPL,A
   \   0000AB   E5..         MOV     A,?V0 + 1
   \   0000AD   3400         ADDC    A,#0x0
   \   0000AF   F583         MOV     DPH,A
   \   0000B1   E0           MOVX    A,@DPTR
   \   0000B2   6403         XRL     A,#0x3
   \   0000B4   7031         JNZ     ??ZDO_ParseBindUnbindReq_0
   2185            {
   2186              osal_cpyExtAddr( pReq->dstAddress.addr.extAddr, msg );
   \   0000B6                ; Setup parameters for call to function osal_cpyExtAddr
   \   0000B6   EE           MOV     A,R6
   \   0000B7   FC           MOV     R4,A
   \   0000B8   EF           MOV     A,R7
   \   0000B9   FD           MOV     R5,A
   \   0000BA   E5..         MOV     A,?V0 + 0
   \   0000BC   240B         ADD     A,#0xb
   \   0000BE   FA           MOV     R2,A
   \   0000BF   E5..         MOV     A,?V0 + 1
   \   0000C1   3400         ADDC    A,#0x0
   \   0000C3   FB           MOV     R3,A
   \   0000C4   12....       LCALL   ??osal_cpyExtAddr?relay
   2187              msg += Z_EXTADDR_LEN;
   \   0000C7   EE           MOV     A,R6
   \   0000C8   2408         ADD     A,#0x8
   \   0000CA   FE           MOV     R6,A
   \   0000CB   EF           MOV     A,R7
   \   0000CC   3400         ADDC    A,#0x0
   \   0000CE   FF           MOV     R7,A
   2188              pReq->dstEndpoint = *msg;
   \   0000CF   8E82         MOV     DPL,R6
   \   0000D1   8F83         MOV     DPH,R7
   \   0000D3   E0           MOVX    A,@DPTR
   \   0000D4   C0E0         PUSH    A
   \   0000D6   E5..         MOV     A,?V0 + 0
   \   0000D8   2414         ADD     A,#0x14
   \   0000DA   F582         MOV     DPL,A
   \   0000DC   E5..         MOV     A,?V0 + 1
   \   0000DE   3400         ADDC    A,#0x0
   \   0000E0   F583         MOV     DPH,A
   \   0000E2   D0E0         POP     A
   \   0000E4   F0           MOVX    @DPTR,A
   \   0000E5   8029         SJMP    ??ZDO_ParseBindUnbindReq_1
   2189            }
   2190            else
   2191            {
   2192              // copy group address
   2193              pReq->dstAddress.addr.shortAddr = BUILD_UINT16( msg[0], msg[1] );
   \                     ??ZDO_ParseBindUnbindReq_0:
   \   0000E7   8E82         MOV     DPL,R6
   \   0000E9   8F83         MOV     DPH,R7
   \   0000EB   E0           MOVX    A,@DPTR
   \   0000EC   FA           MOV     R2,A
   \   0000ED   7B00         MOV     R3,#0x0
   \   0000EF   8E82         MOV     DPL,R6
   \   0000F1   8F83         MOV     DPH,R7
   \   0000F3   A3           INC     DPTR
   \   0000F4   E0           MOVX    A,@DPTR
   \   0000F5   F8           MOV     R0,A
   \   0000F6   E4           CLR     A
   \   0000F7   C8           XCH     A,R0
   \   0000F8   F9           MOV     R1,A
   \   0000F9   E8           MOV     A,R0
   \   0000FA   2A           ADD     A,R2
   \   0000FB   F8           MOV     R0,A
   \   0000FC   E9           MOV     A,R1
   \   0000FD   3B           ADDC    A,R3
   \   0000FE   F9           MOV     R1,A
   \   0000FF   E5..         MOV     A,?V0 + 0
   \   000101   240B         ADD     A,#0xb
   \   000103   F582         MOV     DPL,A
   \   000105   E5..         MOV     A,?V0 + 1
   \   000107   3400         ADDC    A,#0x0
   \   000109   F583         MOV     DPH,A
   \   00010B   E8           MOV     A,R0
   \   00010C   F0           MOVX    @DPTR,A
   \   00010D   A3           INC     DPTR
   \   00010E   E9           MOV     A,R1
   \   00010F   F0           MOVX    @DPTR,A
   2194            }
   2195          }
   \                     ??ZDO_ParseBindUnbindReq_1:
   \   000110   7F04         MOV     R7,#0x4
   \   000112   02....       LJMP    ?BANKED_LEAVE_XDATA
   2196          
   2197          /*********************************************************************
   2198           * @fn      ZDO_ParseAddrRsp
   2199           *
   2200           * @brief   Turns the inMsg (incoming message) into the out parsed
   2201           *          structure.
   2202           *
   2203           * @param   inMsg - incoming message
   2204           *
   2205           * @return  pointer to parsed structures.  This structure was
   2206           *          allocated using osal_mem_alloc, so it must be freed
   2207           *          by the calling function [osal_mem_free()].
   2208           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   2209          ZDO_NwkIEEEAddrResp_t *ZDO_ParseAddrRsp( zdoIncomingMsg_t *inMsg )
   \                     ZDO_ParseAddrRsp:
   2210          {
   \   000000   74F0         MOV     A,#-0x10
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 16
   \   000005                ; Auto size: 0
   \   000005   8A..         MOV     ?V0 + 6,R2
   \   000007   8B..         MOV     ?V0 + 7,R3
   2211            ZDO_NwkIEEEAddrResp_t *rsp;
   2212            uint8 *msg;
   2213            byte cnt = 0;
   2214          
   2215            // Calculate the number of items in the list
   2216            if ( inMsg->asduLen > (1 + Z_EXTADDR_LEN + 2) )
   \   000009   E5..         MOV     A,?V0 + 6
   \   00000B   2410         ADD     A,#0x10
   \   00000D   F582         MOV     DPL,A
   \   00000F   E5..         MOV     A,?V0 + 7
   \   000011   3400         ADDC    A,#0x0
   \   000013   F583         MOV     DPH,A
   \   000015   E0           MOVX    A,@DPTR
   \   000016   C3           CLR     C
   \   000017   940C         SUBB    A,#0xc
   \   000019   401E         JC      ??ZDO_ParseAddrRsp_0
   2217              cnt = inMsg->asdu[1 + Z_EXTADDR_LEN + 2];
   \   00001B   E5..         MOV     A,?V0 + 6
   \   00001D   2411         ADD     A,#0x11
   \   00001F   F582         MOV     DPL,A
   \   000021   E5..         MOV     A,?V0 + 7
   \   000023   3400         ADDC    A,#0x0
   \   000025   F583         MOV     DPH,A
   \   000027   E0           MOVX    A,@DPTR
   \   000028   240B         ADD     A,#0xb
   \   00002A   F8           MOV     R0,A
   \   00002B   A3           INC     DPTR
   \   00002C   E0           MOVX    A,@DPTR
   \   00002D   3400         ADDC    A,#0x0
   \   00002F   F9           MOV     R1,A
   \   000030   8882         MOV     DPL,R0
   \   000032   8983         MOV     DPH,R1
   \   000034   E0           MOVX    A,@DPTR
   \   000035   F5..         MOV     ?V0 + 0,A
   \   000037   8003         SJMP    ??ZDO_ParseAddrRsp_1
   2218            else
   2219              cnt = 0;
   \                     ??ZDO_ParseAddrRsp_0:
   \   000039   75..00       MOV     ?V0 + 0,#0x0
   2220          
   2221            // Make buffer
   2222            rsp = (ZDO_NwkIEEEAddrResp_t *)osal_mem_alloc( sizeof(ZDO_NwkIEEEAddrResp_t) + (cnt * sizeof ( uint16 )) );
   \                     ??ZDO_ParseAddrRsp_1:
   \   00003C                ; Setup parameters for call to function osal_mem_alloc
   \   00003C   A8..         MOV     R0,?V0 + 0
   \   00003E   7900         MOV     R1,#0x0
   \   000040   E8           MOV     A,R0
   \   000041   75F002       MOV     B,#0x2
   \   000044   A4           MUL     AB
   \   000045   C8           XCH     A,R0
   \   000046   AAF0         MOV     R2,B
   \   000048   75F000       MOV     B,#0x0
   \   00004B   A4           MUL     AB
   \   00004C   2A           ADD     A,R2
   \   00004D   FA           MOV     R2,A
   \   00004E   75F002       MOV     B,#0x2
   \   000051   E9           MOV     A,R1
   \   000052   A4           MUL     AB
   \   000053   2A           ADD     A,R2
   \   000054   F9           MOV     R1,A
   \   000055   740D         MOV     A,#0xd
   \   000057   28           ADD     A,R0
   \   000058   FA           MOV     R2,A
   \   000059   7400         MOV     A,#0x0
   \   00005B   39           ADDC    A,R1
   \   00005C   FB           MOV     R3,A
   \   00005D   12....       LCALL   ??osal_mem_alloc?relay
   \   000060   8A..         MOV     ?V0 + 4,R2
   \   000062   8B..         MOV     ?V0 + 5,R3
   \   000064   85....       MOV     ?V0 + 2,?V0 + 4
   \   000067   85....       MOV     ?V0 + 3,?V0 + 5
   2223          
   2224            if ( rsp )
   \   00006A   E5..         MOV     A,?V0 + 2
   \   00006C   6400         XRL     A,#0x0
   \   00006E   7004         JNZ     ??ZDO_ParseAddrRsp_2
   \   000070   E5..         MOV     A,?V0 + 3
   \   000072   6400         XRL     A,#0x0
   \                     ??ZDO_ParseAddrRsp_2:
   \   000074   7003         JNZ     $+5
   \   000076   02....       LJMP    ??ZDO_ParseAddrRsp_3 & 0xFFFF
   2225            {
   2226              msg = inMsg->asdu;
   \   000079   E5..         MOV     A,?V0 + 6
   \   00007B   2411         ADD     A,#0x11
   \   00007D   F582         MOV     DPL,A
   \   00007F   E5..         MOV     A,?V0 + 7
   \   000081   3400         ADDC    A,#0x0
   \   000083   F583         MOV     DPH,A
   \   000085   E0           MOVX    A,@DPTR
   \   000086   F8           MOV     R0,A
   \   000087   A3           INC     DPTR
   \   000088   E0           MOVX    A,@DPTR
   \   000089   F9           MOV     R1,A
   \   00008A   E8           MOV     A,R0
   \   00008B   FE           MOV     R6,A
   \   00008C   E9           MOV     A,R1
   \   00008D   FF           MOV     R7,A
   2227          
   2228              rsp->status = *msg++;
   \   00008E   8E82         MOV     DPL,R6
   \   000090   8F83         MOV     DPH,R7
   \   000092   E0           MOVX    A,@DPTR
   \   000093   85..82       MOV     DPL,?V0 + 2
   \   000096   85..83       MOV     DPH,?V0 + 3
   \   000099   F0           MOVX    @DPTR,A
   \   00009A   8E82         MOV     DPL,R6
   \   00009C   8F83         MOV     DPH,R7
   \   00009E   A3           INC     DPTR
   \   00009F   AE82         MOV     R6,DPL
   \   0000A1   AF83         MOV     R7,DPH
   2229              if ( rsp->status == ZDO_SUCCESS )
   \   0000A3   85..82       MOV     DPL,?V0 + 2
   \   0000A6   85..83       MOV     DPH,?V0 + 3
   \   0000A9   E0           MOVX    A,@DPTR
   \   0000AA   6003         JZ      $+5
   \   0000AC   02....       LJMP    ??ZDO_ParseAddrRsp_3 & 0xFFFF
   2230              {
   2231                osal_cpyExtAddr( rsp->extAddr, msg );
   \   0000AF                ; Setup parameters for call to function osal_cpyExtAddr
   \   0000AF   EE           MOV     A,R6
   \   0000B0   FC           MOV     R4,A
   \   0000B1   EF           MOV     A,R7
   \   0000B2   FD           MOV     R5,A
   \   0000B3   E5..         MOV     A,?V0 + 2
   \   0000B5   2403         ADD     A,#0x3
   \   0000B7   FA           MOV     R2,A
   \   0000B8   E5..         MOV     A,?V0 + 3
   \   0000BA   3400         ADDC    A,#0x0
   \   0000BC   FB           MOV     R3,A
   \   0000BD   12....       LCALL   ??osal_cpyExtAddr?relay
   2232                msg += Z_EXTADDR_LEN;
   \   0000C0   EE           MOV     A,R6
   \   0000C1   2408         ADD     A,#0x8
   \   0000C3   FE           MOV     R6,A
   \   0000C4   EF           MOV     A,R7
   \   0000C5   3400         ADDC    A,#0x0
   \   0000C7   FF           MOV     R7,A
   2233                rsp->nwkAddr = BUILD_UINT16( msg[0], msg[1] );
   \   0000C8   8E82         MOV     DPL,R6
   \   0000CA   8F83         MOV     DPH,R7
   \   0000CC   E0           MOVX    A,@DPTR
   \   0000CD   FA           MOV     R2,A
   \   0000CE   7B00         MOV     R3,#0x0
   \   0000D0   8E82         MOV     DPL,R6
   \   0000D2   8F83         MOV     DPH,R7
   \   0000D4   A3           INC     DPTR
   \   0000D5   E0           MOVX    A,@DPTR
   \   0000D6   F8           MOV     R0,A
   \   0000D7   E4           CLR     A
   \   0000D8   C8           XCH     A,R0
   \   0000D9   F9           MOV     R1,A
   \   0000DA   E8           MOV     A,R0
   \   0000DB   2A           ADD     A,R2
   \   0000DC   F8           MOV     R0,A
   \   0000DD   E9           MOV     A,R1
   \   0000DE   3B           ADDC    A,R3
   \   0000DF   F9           MOV     R1,A
   \   0000E0   85..82       MOV     DPL,?V0 + 2
   \   0000E3   85..83       MOV     DPH,?V0 + 3
   \   0000E6   A3           INC     DPTR
   \   0000E7   E8           MOV     A,R0
   \   0000E8   F0           MOVX    @DPTR,A
   \   0000E9   A3           INC     DPTR
   \   0000EA   E9           MOV     A,R1
   \   0000EB   F0           MOVX    @DPTR,A
   2234          
   2235                msg += 2;
   \   0000EC   EE           MOV     A,R6
   \   0000ED   2402         ADD     A,#0x2
   \   0000EF   FE           MOV     R6,A
   \   0000F0   EF           MOV     A,R7
   \   0000F1   3400         ADDC    A,#0x0
   \   0000F3   FF           MOV     R7,A
   2236                rsp->numAssocDevs = 0;
   \   0000F4   7400         MOV     A,#0x0
   \   0000F6   C0E0         PUSH    A
   \   0000F8   E5..         MOV     A,?V0 + 2
   \   0000FA   240B         ADD     A,#0xb
   \   0000FC   F582         MOV     DPL,A
   \   0000FE   E5..         MOV     A,?V0 + 3
   \   000100   3400         ADDC    A,#0x0
   \   000102   F583         MOV     DPH,A
   \   000104   D0E0         POP     A
   \   000106   F0           MOVX    @DPTR,A
   2237          
   2238                // StartIndex field is only present if NumAssocDev field is non-zero.
   2239                if ( cnt > 0 )
   \   000107   E5..         MOV     A,?V0 + 0
   \   000109   C3           CLR     C
   \   00010A   9401         SUBB    A,#0x1
   \   00010C   5003         JNC     $+5
   \   00010E   02....       LJMP    ??ZDO_ParseAddrRsp_3 & 0xFFFF
   2240                {
   2241                  uint16 *pList = &(rsp->devList[0]);
   \   000111   E5..         MOV     A,?V0 + 2
   \   000113   240D         ADD     A,#0xd
   \   000115   FA           MOV     R2,A
   \   000116   E5..         MOV     A,?V0 + 3
   \   000118   3400         ADDC    A,#0x0
   \   00011A   FB           MOV     R3,A
   \   00011B   EA           MOV     A,R2
   \   00011C   F8           MOV     R0,A
   \   00011D   EB           MOV     A,R3
   \   00011E   F9           MOV     R1,A
   2242                  byte n = cnt;
   \   00011F   AC..         MOV     R4,?V0 + 0
   2243          
   2244                  rsp->numAssocDevs = *msg++;
   \   000121   8E82         MOV     DPL,R6
   \   000123   8F83         MOV     DPH,R7
   \   000125   E0           MOVX    A,@DPTR
   \   000126   C0E0         PUSH    A
   \   000128   E5..         MOV     A,?V0 + 2
   \   00012A   240B         ADD     A,#0xb
   \   00012C   F582         MOV     DPL,A
   \   00012E   E5..         MOV     A,?V0 + 3
   \   000130   3400         ADDC    A,#0x0
   \   000132   F583         MOV     DPH,A
   \   000134   D0E0         POP     A
   \   000136   F0           MOVX    @DPTR,A
   \   000137   8E82         MOV     DPL,R6
   \   000139   8F83         MOV     DPH,R7
   \   00013B   A3           INC     DPTR
   \   00013C   AE82         MOV     R6,DPL
   \   00013E   AF83         MOV     R7,DPH
   2245                  rsp->startIndex = *msg++;
   \   000140   8E82         MOV     DPL,R6
   \   000142   8F83         MOV     DPH,R7
   \   000144   E0           MOVX    A,@DPTR
   \   000145   C0E0         PUSH    A
   \   000147   E5..         MOV     A,?V0 + 2
   \   000149   240C         ADD     A,#0xc
   \   00014B   F582         MOV     DPL,A
   \   00014D   E5..         MOV     A,?V0 + 3
   \   00014F   3400         ADDC    A,#0x0
   \   000151   F583         MOV     DPH,A
   \   000153   D0E0         POP     A
   \   000155   F0           MOVX    @DPTR,A
   \   000156   8E82         MOV     DPL,R6
   \   000158   8F83         MOV     DPH,R7
   \   00015A   A3           INC     DPTR
   \   00015B   AE82         MOV     R6,DPL
   \   00015D   AF83         MOV     R7,DPH
   2246          
   2247                  while ( n != 0 )
   \                     ??ZDO_ParseAddrRsp_4:
   \   00015F   EC           MOV     A,R4
   \   000160   6038         JZ      ??ZDO_ParseAddrRsp_3
   2248                  {
   2249                    *pList++ = BUILD_UINT16( msg[0], msg[1] );
   \   000162   8E82         MOV     DPL,R6
   \   000164   8F83         MOV     DPH,R7
   \   000166   E0           MOVX    A,@DPTR
   \   000167   F5..         MOV     ?V0 + 4,A
   \   000169   75..00       MOV     ?V0 + 5,#0x0
   \   00016C   8E82         MOV     DPL,R6
   \   00016E   8F83         MOV     DPH,R7
   \   000170   A3           INC     DPTR
   \   000171   E0           MOVX    A,@DPTR
   \   000172   FA           MOV     R2,A
   \   000173   E4           CLR     A
   \   000174   CA           XCH     A,R2
   \   000175   FB           MOV     R3,A
   \   000176   EA           MOV     A,R2
   \   000177   25..         ADD     A,?V0 + 4
   \   000179   FA           MOV     R2,A
   \   00017A   EB           MOV     A,R3
   \   00017B   35..         ADDC    A,?V0 + 5
   \   00017D   FB           MOV     R3,A
   \   00017E   8882         MOV     DPL,R0
   \   000180   8983         MOV     DPH,R1
   \   000182   EA           MOV     A,R2
   \   000183   F0           MOVX    @DPTR,A
   \   000184   A3           INC     DPTR
   \   000185   EB           MOV     A,R3
   \   000186   F0           MOVX    @DPTR,A
   \   000187   E8           MOV     A,R0
   \   000188   2402         ADD     A,#0x2
   \   00018A   F8           MOV     R0,A
   \   00018B   E9           MOV     A,R1
   \   00018C   3400         ADDC    A,#0x0
   \   00018E   F9           MOV     R1,A
   2250                    msg += sizeof( uint16 );
   \   00018F   EE           MOV     A,R6
   \   000190   2402         ADD     A,#0x2
   \   000192   FE           MOV     R6,A
   \   000193   EF           MOV     A,R7
   \   000194   3400         ADDC    A,#0x0
   \   000196   FF           MOV     R7,A
   2251                    n--;
   \   000197   1C           DEC     R4
   \   000198   80C5         SJMP    ??ZDO_ParseAddrRsp_4
   2252                  }
   2253                }
   2254              }
   2255            }
   2256            return ( rsp );
   \                     ??ZDO_ParseAddrRsp_3:
   \   00019A   AA..         MOV     R2,?V0 + 2
   \   00019C   AB..         MOV     R3,?V0 + 3
   \   00019E   7F08         MOV     R7,#0x8
   \   0001A0   02....       LJMP    ?BANKED_LEAVE_XDATA
   2257          }
   2258          
   2259          /*********************************************************************
   2260           * @fn          ZDO_ParseNodeDescRsp
   2261           *
   2262           * @brief       This function parses the Node_Desc_rsp message.
   2263           *
   2264           * @param       inMsg - incoming message
   2265           * @param       pNDRsp - place to parse the message into
   2266           *
   2267           * @return      none
   2268           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   2269          void ZDO_ParseNodeDescRsp( zdoIncomingMsg_t *inMsg, ZDO_NodeDescRsp_t *pNDRsp )
   \                     ZDO_ParseNodeDescRsp:
   2270          {
   \   000000   74F6         MOV     A,#-0xa
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 10
   \   000005                ; Auto size: 0
   2271            uint8 *msg;
   2272          
   2273            msg = inMsg->asdu;
   \   000005   EA           MOV     A,R2
   \   000006   2411         ADD     A,#0x11
   \   000008   F582         MOV     DPL,A
   \   00000A   EB           MOV     A,R3
   \   00000B   3400         ADDC    A,#0x0
   \   00000D   F583         MOV     DPH,A
   \   00000F   E0           MOVX    A,@DPTR
   \   000010   FE           MOV     R6,A
   \   000011   A3           INC     DPTR
   \   000012   E0           MOVX    A,@DPTR
   \   000013   FF           MOV     R7,A
   \   000014   EE           MOV     A,R6
   \   000015   F8           MOV     R0,A
   \   000016   EF           MOV     A,R7
   \   000017   F9           MOV     R1,A
   2274          
   2275            pNDRsp->status = *msg++;
   \   000018   8882         MOV     DPL,R0
   \   00001A   8983         MOV     DPH,R1
   \   00001C   E0           MOVX    A,@DPTR
   \   00001D   8C82         MOV     DPL,R4
   \   00001F   8D83         MOV     DPH,R5
   \   000021   F0           MOVX    @DPTR,A
   \   000022   8882         MOV     DPL,R0
   \   000024   8983         MOV     DPH,R1
   \   000026   A3           INC     DPTR
   \   000027   A882         MOV     R0,DPL
   \   000029   A983         MOV     R1,DPH
   2276            pNDRsp->nwkAddr = BUILD_UINT16( msg[0], msg[1] );
   \   00002B   8882         MOV     DPL,R0
   \   00002D   8983         MOV     DPH,R1
   \   00002F   E0           MOVX    A,@DPTR
   \   000030   F5..         MOV     ?V0 + 0,A
   \   000032   75..00       MOV     ?V0 + 1,#0x0
   \   000035   8882         MOV     DPL,R0
   \   000037   8983         MOV     DPH,R1
   \   000039   A3           INC     DPTR
   \   00003A   E0           MOVX    A,@DPTR
   \   00003B   FE           MOV     R6,A
   \   00003C   E4           CLR     A
   \   00003D   CE           XCH     A,R6
   \   00003E   FF           MOV     R7,A
   \   00003F   EE           MOV     A,R6
   \   000040   25..         ADD     A,?V0 + 0
   \   000042   FE           MOV     R6,A
   \   000043   EF           MOV     A,R7
   \   000044   35..         ADDC    A,?V0 + 1
   \   000046   FF           MOV     R7,A
   \   000047   8C82         MOV     DPL,R4
   \   000049   8D83         MOV     DPH,R5
   \   00004B   A3           INC     DPTR
   \   00004C   EE           MOV     A,R6
   \   00004D   F0           MOVX    @DPTR,A
   \   00004E   A3           INC     DPTR
   \   00004F   EF           MOV     A,R7
   \   000050   F0           MOVX    @DPTR,A
   2277          
   2278            if ( pNDRsp->status == ZDP_SUCCESS )
   \   000051   8C82         MOV     DPL,R4
   \   000053   8D83         MOV     DPH,R5
   \   000055   E0           MOVX    A,@DPTR
   \   000056   6003         JZ      $+5
   \   000058   02....       LJMP    ??ZDO_ParseNodeDescRsp_0 & 0xFFFF
   2279            {
   2280              msg += 2;
   \   00005B   E8           MOV     A,R0
   \   00005C   2402         ADD     A,#0x2
   \   00005E   F8           MOV     R0,A
   \   00005F   E9           MOV     A,R1
   \   000060   3400         ADDC    A,#0x0
   \   000062   F9           MOV     R1,A
   2281              pNDRsp->nodeDesc.LogicalType = *msg & 0x07;
   \   000063   8882         MOV     DPL,R0
   \   000065   8983         MOV     DPH,R1
   \   000067   E0           MOVX    A,@DPTR
   \   000068   5407         ANL     A,#0x7
   \   00006A   C0E0         PUSH    A
   \   00006C   8C82         MOV     DPL,R4
   \   00006E   8D83         MOV     DPH,R5
   \   000070   A3           INC     DPTR
   \   000071   A3           INC     DPTR
   \   000072   A3           INC     DPTR
   \   000073   E0           MOVX    A,@DPTR
   \   000074   54F8         ANL     A,#0xf8
   \   000076   FE           MOV     R6,A
   \   000077   D0E0         POP     A
   \   000079   4E           ORL     A,R6
   \   00007A   8C82         MOV     DPL,R4
   \   00007C   8D83         MOV     DPH,R5
   \   00007E   A3           INC     DPTR
   \   00007F   A3           INC     DPTR
   \   000080   A3           INC     DPTR
   \   000081   F0           MOVX    @DPTR,A
   2282          
   2283              pNDRsp->nodeDesc.ComplexDescAvail = ( *msg & 0x08 ) >> 3;
   \   000082   8C82         MOV     DPL,R4
   \   000084   8D83         MOV     DPH,R5
   \   000086   A3           INC     DPTR
   \   000087   A3           INC     DPTR
   \   000088   A3           INC     DPTR
   \   000089   C082         PUSH    DPL
   \   00008B   C083         PUSH    DPH
   \   00008D   8882         MOV     DPL,R0
   \   00008F   8983         MOV     DPH,R1
   \   000091   E0           MOVX    A,@DPTR
   \   000092   A2E3         MOV     C,0xE0 /* A   */.3
   \   000094   D083         POP     DPH
   \   000096   D082         POP     DPL
   \   000098   E0           MOVX    A,@DPTR
   \   000099   92E3         MOV     0xE0 /* A   */.3,C
   \   00009B   F0           MOVX    @DPTR,A
   2284              pNDRsp->nodeDesc.UserDescAvail = ( *msg & 0x10 ) >> 4;
   \   00009C   8C82         MOV     DPL,R4
   \   00009E   8D83         MOV     DPH,R5
   \   0000A0   A3           INC     DPTR
   \   0000A1   A3           INC     DPTR
   \   0000A2   A3           INC     DPTR
   \   0000A3   C082         PUSH    DPL
   \   0000A5   C083         PUSH    DPH
   \   0000A7   8882         MOV     DPL,R0
   \   0000A9   8983         MOV     DPH,R1
   \   0000AB   E0           MOVX    A,@DPTR
   \   0000AC   A2E4         MOV     C,0xE0 /* A   */.4
   \   0000AE   D083         POP     DPH
   \   0000B0   D082         POP     DPL
   \   0000B2   E0           MOVX    A,@DPTR
   \   0000B3   92E4         MOV     0xE0 /* A   */.4,C
   \   0000B5   F0           MOVX    @DPTR,A
   2285          
   2286              msg++;  // Reserved bits.
   \   0000B6   8882         MOV     DPL,R0
   \   0000B8   8983         MOV     DPH,R1
   \   0000BA   A3           INC     DPTR
   \   0000BB   A882         MOV     R0,DPL
   \   0000BD   A983         MOV     R1,DPH
   2287              pNDRsp->nodeDesc.FrequencyBand = (*msg >> 3) & 0x1f;
   \   0000BF   8882         MOV     DPL,R0
   \   0000C1   8983         MOV     DPH,R1
   \   0000C3   E0           MOVX    A,@DPTR
   \   0000C4   54F8         ANL     A,#0xf8
   \   0000C6   C0E0         PUSH    A
   \   0000C8   8C82         MOV     DPL,R4
   \   0000CA   8D83         MOV     DPH,R5
   \   0000CC   A3           INC     DPTR
   \   0000CD   A3           INC     DPTR
   \   0000CE   A3           INC     DPTR
   \   0000CF   A3           INC     DPTR
   \   0000D0   E0           MOVX    A,@DPTR
   \   0000D1   5407         ANL     A,#0x7
   \   0000D3   FE           MOV     R6,A
   \   0000D4   D0E0         POP     A
   \   0000D6   4E           ORL     A,R6
   \   0000D7   8C82         MOV     DPL,R4
   \   0000D9   8D83         MOV     DPH,R5
   \   0000DB   A3           INC     DPTR
   \   0000DC   A3           INC     DPTR
   \   0000DD   A3           INC     DPTR
   \   0000DE   A3           INC     DPTR
   \   0000DF   F0           MOVX    @DPTR,A
   2288              pNDRsp->nodeDesc.APSFlags = *msg++ & 0x07;
   \   0000E0   8882         MOV     DPL,R0
   \   0000E2   8983         MOV     DPH,R1
   \   0000E4   E0           MOVX    A,@DPTR
   \   0000E5   5407         ANL     A,#0x7
   \   0000E7   C0E0         PUSH    A
   \   0000E9   8C82         MOV     DPL,R4
   \   0000EB   8D83         MOV     DPH,R5
   \   0000ED   A3           INC     DPTR
   \   0000EE   A3           INC     DPTR
   \   0000EF   A3           INC     DPTR
   \   0000F0   A3           INC     DPTR
   \   0000F1   E0           MOVX    A,@DPTR
   \   0000F2   54F8         ANL     A,#0xf8
   \   0000F4   FE           MOV     R6,A
   \   0000F5   D0E0         POP     A
   \   0000F7   4E           ORL     A,R6
   \   0000F8   8882         MOV     DPL,R0
   \   0000FA   8983         MOV     DPH,R1
   \   0000FC   A3           INC     DPTR
   \   0000FD   A882         MOV     R0,DPL
   \   0000FF   A983         MOV     R1,DPH
   \   000101   8C82         MOV     DPL,R4
   \   000103   8D83         MOV     DPH,R5
   \   000105   A3           INC     DPTR
   \   000106   A3           INC     DPTR
   \   000107   A3           INC     DPTR
   \   000108   A3           INC     DPTR
   \   000109   F0           MOVX    @DPTR,A
   2289              pNDRsp->nodeDesc.CapabilityFlags = *msg++;
   \   00010A   8882         MOV     DPL,R0
   \   00010C   8983         MOV     DPH,R1
   \   00010E   E0           MOVX    A,@DPTR
   \   00010F   8C82         MOV     DPL,R4
   \   000111   8D83         MOV     DPH,R5
   \   000113   A3           INC     DPTR
   \   000114   A3           INC     DPTR
   \   000115   A3           INC     DPTR
   \   000116   A3           INC     DPTR
   \   000117   A3           INC     DPTR
   \   000118   F0           MOVX    @DPTR,A
   \   000119   8882         MOV     DPL,R0
   \   00011B   8983         MOV     DPH,R1
   \   00011D   A3           INC     DPTR
   \   00011E   A882         MOV     R0,DPL
   \   000120   A983         MOV     R1,DPH
   2290              pNDRsp->nodeDesc.ManufacturerCode[0] = *msg++;
   \   000122   8882         MOV     DPL,R0
   \   000124   8983         MOV     DPH,R1
   \   000126   E0           MOVX    A,@DPTR
   \   000127   8C82         MOV     DPL,R4
   \   000129   8D83         MOV     DPH,R5
   \   00012B   A3           INC     DPTR
   \   00012C   A3           INC     DPTR
   \   00012D   A3           INC     DPTR
   \   00012E   A3           INC     DPTR
   \   00012F   A3           INC     DPTR
   \   000130   A3           INC     DPTR
   \   000131   F0           MOVX    @DPTR,A
   \   000132   8882         MOV     DPL,R0
   \   000134   8983         MOV     DPH,R1
   \   000136   A3           INC     DPTR
   \   000137   A882         MOV     R0,DPL
   \   000139   A983         MOV     R1,DPH
   2291              pNDRsp->nodeDesc.ManufacturerCode[1] = *msg++;
   \   00013B   8882         MOV     DPL,R0
   \   00013D   8983         MOV     DPH,R1
   \   00013F   E0           MOVX    A,@DPTR
   \   000140   8C82         MOV     DPL,R4
   \   000142   8D83         MOV     DPH,R5
   \   000144   A3           INC     DPTR
   \   000145   A3           INC     DPTR
   \   000146   A3           INC     DPTR
   \   000147   A3           INC     DPTR
   \   000148   A3           INC     DPTR
   \   000149   A3           INC     DPTR
   \   00014A   A3           INC     DPTR
   \   00014B   F0           MOVX    @DPTR,A
   \   00014C   8882         MOV     DPL,R0
   \   00014E   8983         MOV     DPH,R1
   \   000150   A3           INC     DPTR
   \   000151   A882         MOV     R0,DPL
   \   000153   A983         MOV     R1,DPH
   2292              pNDRsp->nodeDesc.MaxBufferSize = *msg++;
   \   000155   8882         MOV     DPL,R0
   \   000157   8983         MOV     DPH,R1
   \   000159   E0           MOVX    A,@DPTR
   \   00015A   8C82         MOV     DPL,R4
   \   00015C   8D83         MOV     DPH,R5
   \   00015E   A3           INC     DPTR
   \   00015F   A3           INC     DPTR
   \   000160   A3           INC     DPTR
   \   000161   A3           INC     DPTR
   \   000162   A3           INC     DPTR
   \   000163   A3           INC     DPTR
   \   000164   A3           INC     DPTR
   \   000165   A3           INC     DPTR
   \   000166   F0           MOVX    @DPTR,A
   \   000167   8882         MOV     DPL,R0
   \   000169   8983         MOV     DPH,R1
   \   00016B   A3           INC     DPTR
   \   00016C   A882         MOV     R0,DPL
   \   00016E   A983         MOV     R1,DPH
   2293              pNDRsp->nodeDesc.MaxTransferSize[0] = *msg++;
   \   000170   8882         MOV     DPL,R0
   \   000172   8983         MOV     DPH,R1
   \   000174   E0           MOVX    A,@DPTR
   \   000175   8C82         MOV     DPL,R4
   \   000177   8D83         MOV     DPH,R5
   \   000179   A3           INC     DPTR
   \   00017A   A3           INC     DPTR
   \   00017B   A3           INC     DPTR
   \   00017C   A3           INC     DPTR
   \   00017D   A3           INC     DPTR
   \   00017E   A3           INC     DPTR
   \   00017F   A3           INC     DPTR
   \   000180   A3           INC     DPTR
   \   000181   A3           INC     DPTR
   \   000182   F0           MOVX    @DPTR,A
   \   000183   8882         MOV     DPL,R0
   \   000185   8983         MOV     DPH,R1
   \   000187   A3           INC     DPTR
   \   000188   A882         MOV     R0,DPL
   \   00018A   A983         MOV     R1,DPH
   2294              pNDRsp->nodeDesc.MaxTransferSize[1] = *msg++;
   \   00018C   8882         MOV     DPL,R0
   \   00018E   8983         MOV     DPH,R1
   \   000190   E0           MOVX    A,@DPTR
   \   000191   8C82         MOV     DPL,R4
   \   000193   8D83         MOV     DPH,R5
   \   000195   A3           INC     DPTR
   \   000196   A3           INC     DPTR
   \   000197   A3           INC     DPTR
   \   000198   A3           INC     DPTR
   \   000199   A3           INC     DPTR
   \   00019A   A3           INC     DPTR
   \   00019B   A3           INC     DPTR
   \   00019C   A3           INC     DPTR
   \   00019D   A3           INC     DPTR
   \   00019E   A3           INC     DPTR
   \   00019F   F0           MOVX    @DPTR,A
   \   0001A0   8882         MOV     DPL,R0
   \   0001A2   8983         MOV     DPH,R1
   \   0001A4   A3           INC     DPTR
   \   0001A5   A882         MOV     R0,DPL
   \   0001A7   A983         MOV     R1,DPH
   2295              pNDRsp->nodeDesc.ServerMask = BUILD_UINT16( msg[0], msg[1] );
   \   0001A9   8882         MOV     DPL,R0
   \   0001AB   8983         MOV     DPH,R1
   \   0001AD   E0           MOVX    A,@DPTR
   \   0001AE   F5..         MOV     ?V0 + 0,A
   \   0001B0   75..00       MOV     ?V0 + 1,#0x0
   \   0001B3   8882         MOV     DPL,R0
   \   0001B5   8983         MOV     DPH,R1
   \   0001B7   A3           INC     DPTR
   \   0001B8   E0           MOVX    A,@DPTR
   \   0001B9   FE           MOV     R6,A
   \   0001BA   E4           CLR     A
   \   0001BB   CE           XCH     A,R6
   \   0001BC   FF           MOV     R7,A
   \   0001BD   EE           MOV     A,R6
   \   0001BE   25..         ADD     A,?V0 + 0
   \   0001C0   FE           MOV     R6,A
   \   0001C1   EF           MOV     A,R7
   \   0001C2   35..         ADDC    A,?V0 + 1
   \   0001C4   FF           MOV     R7,A
   \   0001C5   EC           MOV     A,R4
   \   0001C6   240B         ADD     A,#0xb
   \   0001C8   F582         MOV     DPL,A
   \   0001CA   ED           MOV     A,R5
   \   0001CB   3400         ADDC    A,#0x0
   \   0001CD   F583         MOV     DPH,A
   \   0001CF   EE           MOV     A,R6
   \   0001D0   F0           MOVX    @DPTR,A
   \   0001D1   A3           INC     DPTR
   \   0001D2   EF           MOV     A,R7
   \   0001D3   F0           MOVX    @DPTR,A
   2296            }
   2297          }
   \                     ??ZDO_ParseNodeDescRsp_0:
   \   0001D4   7F02         MOV     R7,#0x2
   \   0001D6   02....       LJMP    ?BANKED_LEAVE_XDATA
   2298          
   2299          /*********************************************************************
   2300           * @fn          ZDO_ParesPowerDescRsp
   2301           *
   2302           * @brief       This function parses the Power_Desc_rsp message.
   2303           *
   2304           * @param       inMsg  - incoming message
   2305           * @param       pNPRsp - place to parse the message into
   2306           *
   2307           * @return      none
   2308           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   2309          void ZDO_ParsePowerDescRsp( zdoIncomingMsg_t *inMsg, ZDO_PowerRsp_t *pNPRsp )
   \                     ZDO_ParsePowerDescRsp:
   2310          {
   \   000000   74F4         MOV     A,#-0xc
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 12
   \   000005                ; Auto size: 0
   \   000005   EA           MOV     A,R2
   \   000006   FE           MOV     R6,A
   \   000007   EB           MOV     A,R3
   \   000008   FF           MOV     R7,A
   2311            uint8 *msg;
   2312          
   2313            msg = inMsg->asdu;
   \   000009   EE           MOV     A,R6
   \   00000A   2411         ADD     A,#0x11
   \   00000C   F582         MOV     DPL,A
   \   00000E   EF           MOV     A,R7
   \   00000F   3400         ADDC    A,#0x0
   \   000011   F583         MOV     DPH,A
   \   000013   E0           MOVX    A,@DPTR
   \   000014   F8           MOV     R0,A
   \   000015   A3           INC     DPTR
   \   000016   E0           MOVX    A,@DPTR
   \   000017   F9           MOV     R1,A
   \   000018   E8           MOV     A,R0
   \   000019   FA           MOV     R2,A
   \   00001A   E9           MOV     A,R1
   \   00001B   FB           MOV     R3,A
   2314            pNPRsp->status = *msg++;
   \   00001C   8A82         MOV     DPL,R2
   \   00001E   8B83         MOV     DPH,R3
   \   000020   E0           MOVX    A,@DPTR
   \   000021   8C82         MOV     DPL,R4
   \   000023   8D83         MOV     DPH,R5
   \   000025   F0           MOVX    @DPTR,A
   \   000026   8A82         MOV     DPL,R2
   \   000028   8B83         MOV     DPH,R3
   \   00002A   A3           INC     DPTR
   \   00002B   AA82         MOV     R2,DPL
   \   00002D   AB83         MOV     R3,DPH
   2315            pNPRsp->nwkAddr = BUILD_UINT16( msg[0], msg[1] );
   \   00002F   8A82         MOV     DPL,R2
   \   000031   8B83         MOV     DPH,R3
   \   000033   E0           MOVX    A,@DPTR
   \   000034   F5..         MOV     ?V0 + 0,A
   \   000036   75..00       MOV     ?V0 + 1,#0x0
   \   000039   8A82         MOV     DPL,R2
   \   00003B   8B83         MOV     DPH,R3
   \   00003D   A3           INC     DPTR
   \   00003E   E0           MOVX    A,@DPTR
   \   00003F   F8           MOV     R0,A
   \   000040   E4           CLR     A
   \   000041   C8           XCH     A,R0
   \   000042   F9           MOV     R1,A
   \   000043   E8           MOV     A,R0
   \   000044   25..         ADD     A,?V0 + 0
   \   000046   F8           MOV     R0,A
   \   000047   E9           MOV     A,R1
   \   000048   35..         ADDC    A,?V0 + 1
   \   00004A   F9           MOV     R1,A
   \   00004B   8C82         MOV     DPL,R4
   \   00004D   8D83         MOV     DPH,R5
   \   00004F   A3           INC     DPTR
   \   000050   E8           MOV     A,R0
   \   000051   F0           MOVX    @DPTR,A
   \   000052   A3           INC     DPTR
   \   000053   E9           MOV     A,R1
   \   000054   F0           MOVX    @DPTR,A
   2316          
   2317            if ( pNPRsp->status == ZDP_SUCCESS )
   \   000055   8C82         MOV     DPL,R4
   \   000057   8D83         MOV     DPH,R5
   \   000059   E0           MOVX    A,@DPTR
   \   00005A   6003         JZ      $+5
   \   00005C   02....       LJMP    ??ZDO_ParsePowerDescRsp_0 & 0xFFFF
   2318            {
   2319              msg += 2;
   \   00005F   EA           MOV     A,R2
   \   000060   2402         ADD     A,#0x2
   \   000062   FA           MOV     R2,A
   \   000063   EB           MOV     A,R3
   \   000064   3400         ADDC    A,#0x0
   \   000066   FB           MOV     R3,A
   2320              pNPRsp->pwrDesc.AvailablePowerSources = *msg >> 4;
   \   000067   8C82         MOV     DPL,R4
   \   000069   8D83         MOV     DPH,R5
   \   00006B   A3           INC     DPTR
   \   00006C   A3           INC     DPTR
   \   00006D   A3           INC     DPTR
   \   00006E   E0           MOVX    A,@DPTR
   \   00006F   540F         ANL     A,#0xf
   \   000071   F5..         MOV     ?V0 + 2,A
   \   000073   A3           INC     DPTR
   \   000074   E0           MOVX    A,@DPTR
   \   000075   54FF         ANL     A,#0xff
   \   000077   F5..         MOV     ?V0 + 3,A
   \   000079   8A82         MOV     DPL,R2
   \   00007B   8B83         MOV     DPH,R3
   \   00007D   E0           MOVX    A,@DPTR
   \   00007E   C4           SWAP    A
   \   00007F   540F         ANL     A,#0xf
   \   000081   F5..         MOV     ?V0 + 0,A
   \   000083   75..00       MOV     ?V0 + 1,#0x0
   \   000086   7404         MOV     A,#0x4
   \   000088   78..         MOV     R0,#?V0 + 0
   \   00008A   12....       LCALL   ?S_SHL
   \   00008D   E5..         MOV     A,?V0 + 0
   \   00008F   45..         ORL     A,?V0 + 2
   \   000091   F8           MOV     R0,A
   \   000092   E5..         MOV     A,?V0 + 1
   \   000094   45..         ORL     A,?V0 + 3
   \   000096   F9           MOV     R1,A
   \   000097   8C82         MOV     DPL,R4
   \   000099   8D83         MOV     DPH,R5
   \   00009B   A3           INC     DPTR
   \   00009C   A3           INC     DPTR
   \   00009D   A3           INC     DPTR
   \   00009E   E8           MOV     A,R0
   \   00009F   F0           MOVX    @DPTR,A
   \   0000A0   A3           INC     DPTR
   \   0000A1   E9           MOV     A,R1
   \   0000A2   F0           MOVX    @DPTR,A
   2321              pNPRsp->pwrDesc.PowerMode = *msg++ & 0x0F;
   \   0000A3   8C82         MOV     DPL,R4
   \   0000A5   8D83         MOV     DPH,R5
   \   0000A7   A3           INC     DPTR
   \   0000A8   A3           INC     DPTR
   \   0000A9   A3           INC     DPTR
   \   0000AA   E0           MOVX    A,@DPTR
   \   0000AB   54F0         ANL     A,#0xf0
   \   0000AD   F8           MOV     R0,A
   \   0000AE   A3           INC     DPTR
   \   0000AF   E0           MOVX    A,@DPTR
   \   0000B0   54FF         ANL     A,#0xff
   \   0000B2   F9           MOV     R1,A
   \   0000B3   8A82         MOV     DPL,R2
   \   0000B5   8B83         MOV     DPH,R3
   \   0000B7   E0           MOVX    A,@DPTR
   \   0000B8   F5..         MOV     ?V0 + 0,A
   \   0000BA   75..00       MOV     ?V0 + 1,#0x0
   \   0000BD   740F         MOV     A,#0xf
   \   0000BF   55..         ANL     A,?V0 + 0
   \   0000C1   F5..         MOV     ?V0 + 0,A
   \   0000C3   7400         MOV     A,#0x0
   \   0000C5   55..         ANL     A,?V0 + 1
   \   0000C7   F5..         MOV     ?V0 + 1,A
   \   0000C9   E5..         MOV     A,?V0 + 0
   \   0000CB   48           ORL     A,R0
   \   0000CC   F8           MOV     R0,A
   \   0000CD   E5..         MOV     A,?V0 + 1
   \   0000CF   49           ORL     A,R1
   \   0000D0   F9           MOV     R1,A
   \   0000D1   8A82         MOV     DPL,R2
   \   0000D3   8B83         MOV     DPH,R3
   \   0000D5   A3           INC     DPTR
   \   0000D6   AA82         MOV     R2,DPL
   \   0000D8   AB83         MOV     R3,DPH
   \   0000DA   8C82         MOV     DPL,R4
   \   0000DC   8D83         MOV     DPH,R5
   \   0000DE   A3           INC     DPTR
   \   0000DF   A3           INC     DPTR
   \   0000E0   A3           INC     DPTR
   \   0000E1   E8           MOV     A,R0
   \   0000E2   F0           MOVX    @DPTR,A
   \   0000E3   A3           INC     DPTR
   \   0000E4   E9           MOV     A,R1
   \   0000E5   F0           MOVX    @DPTR,A
   2322              pNPRsp->pwrDesc.CurrentPowerSourceLevel = *msg >> 4;
   \   0000E6   8C82         MOV     DPL,R4
   \   0000E8   8D83         MOV     DPH,R5
   \   0000EA   A3           INC     DPTR
   \   0000EB   A3           INC     DPTR
   \   0000EC   A3           INC     DPTR
   \   0000ED   E0           MOVX    A,@DPTR
   \   0000EE   54FF         ANL     A,#0xff
   \   0000F0   F5..         MOV     ?V0 + 2,A
   \   0000F2   A3           INC     DPTR
   \   0000F3   E0           MOVX    A,@DPTR
   \   0000F4   540F         ANL     A,#0xf
   \   0000F6   F5..         MOV     ?V0 + 3,A
   \   0000F8   8A82         MOV     DPL,R2
   \   0000FA   8B83         MOV     DPH,R3
   \   0000FC   E0           MOVX    A,@DPTR
   \   0000FD   C4           SWAP    A
   \   0000FE   540F         ANL     A,#0xf
   \   000100   F5..         MOV     ?V0 + 0,A
   \   000102   75..00       MOV     ?V0 + 1,#0x0
   \   000105   740C         MOV     A,#0xc
   \   000107   78..         MOV     R0,#?V0 + 0
   \   000109   12....       LCALL   ?S_SHL
   \   00010C   E5..         MOV     A,?V0 + 0
   \   00010E   45..         ORL     A,?V0 + 2
   \   000110   F8           MOV     R0,A
   \   000111   E5..         MOV     A,?V0 + 1
   \   000113   45..         ORL     A,?V0 + 3
   \   000115   F9           MOV     R1,A
   \   000116   8C82         MOV     DPL,R4
   \   000118   8D83         MOV     DPH,R5
   \   00011A   A3           INC     DPTR
   \   00011B   A3           INC     DPTR
   \   00011C   A3           INC     DPTR
   \   00011D   E8           MOV     A,R0
   \   00011E   F0           MOVX    @DPTR,A
   \   00011F   A3           INC     DPTR
   \   000120   E9           MOV     A,R1
   \   000121   F0           MOVX    @DPTR,A
   2323              pNPRsp->pwrDesc.CurrentPowerSource = *msg++ & 0x0F;
   \   000122   8C82         MOV     DPL,R4
   \   000124   8D83         MOV     DPH,R5
   \   000126   A3           INC     DPTR
   \   000127   A3           INC     DPTR
   \   000128   A3           INC     DPTR
   \   000129   E0           MOVX    A,@DPTR
   \   00012A   54FF         ANL     A,#0xff
   \   00012C   F8           MOV     R0,A
   \   00012D   A3           INC     DPTR
   \   00012E   E0           MOVX    A,@DPTR
   \   00012F   54F0         ANL     A,#0xf0
   \   000131   F9           MOV     R1,A
   \   000132   8A82         MOV     DPL,R2
   \   000134   8B83         MOV     DPH,R3
   \   000136   E0           MOVX    A,@DPTR
   \   000137   F5..         MOV     ?V0 + 0,A
   \   000139   E4           CLR     A
   \   00013A   C5..         XCH     A,?V0 + 0
   \   00013C   F5..         MOV     ?V0 + 1,A
   \   00013E   7400         MOV     A,#0x0
   \   000140   55..         ANL     A,?V0 + 0
   \   000142   F5..         MOV     ?V0 + 0,A
   \   000144   740F         MOV     A,#0xf
   \   000146   55..         ANL     A,?V0 + 1
   \   000148   F5..         MOV     ?V0 + 1,A
   \   00014A   E5..         MOV     A,?V0 + 0
   \   00014C   48           ORL     A,R0
   \   00014D   F8           MOV     R0,A
   \   00014E   E5..         MOV     A,?V0 + 1
   \   000150   49           ORL     A,R1
   \   000151   F9           MOV     R1,A
   \   000152   8C82         MOV     DPL,R4
   \   000154   8D83         MOV     DPH,R5
   \   000156   A3           INC     DPTR
   \   000157   A3           INC     DPTR
   \   000158   A3           INC     DPTR
   \   000159   E8           MOV     A,R0
   \   00015A   F0           MOVX    @DPTR,A
   \   00015B   A3           INC     DPTR
   \   00015C   E9           MOV     A,R1
   \   00015D   F0           MOVX    @DPTR,A
   2324            }
   2325          }
   \                     ??ZDO_ParsePowerDescRsp_0:
   \   00015E   7F04         MOV     R7,#0x4
   \   000160   02....       LJMP    ?BANKED_LEAVE_XDATA
   2326          
   2327          /*********************************************************************
   2328           * @fn          ZDO_ParseSimpleDescRsp
   2329           *
   2330           * @brief       This function parse the Simple_Desc_rsp message.
   2331           *
   2332           *   NOTE: The pAppInClusterList and pAppOutClusterList fields
   2333           *         in the SimpleDescriptionFormat_t structure are allocated
   2334           *         and the calling function needs to free [osal_msg_free()]
   2335           *         these buffers.
   2336           *
   2337           * @param       inMsg  - incoming message
   2338           * @param       pSimpleDescRsp - place to parse the message into
   2339           *
   2340           * @return      none
   2341           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   2342          void ZDO_ParseSimpleDescRsp( zdoIncomingMsg_t *inMsg, ZDO_SimpleDescRsp_t *pSimpleDescRsp )
   \                     ZDO_ParseSimpleDescRsp:
   2343          {
   \   000000   74F4         MOV     A,#-0xc
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 12
   \   000005                ; Auto size: 0
   \   000005   8A..         MOV     ?V0 + 2,R2
   \   000007   8B..         MOV     ?V0 + 3,R3
   \   000009   8C..         MOV     ?V0 + 0,R4
   \   00000B   8D..         MOV     ?V0 + 1,R5
   2344            uint8 *msg;
   2345          
   2346            msg = inMsg->asdu;
   \   00000D   E5..         MOV     A,?V0 + 2
   \   00000F   2411         ADD     A,#0x11
   \   000011   F582         MOV     DPL,A
   \   000013   E5..         MOV     A,?V0 + 3
   \   000015   3400         ADDC    A,#0x0
   \   000017   F583         MOV     DPH,A
   \   000019   E0           MOVX    A,@DPTR
   \   00001A   F8           MOV     R0,A
   \   00001B   A3           INC     DPTR
   \   00001C   E0           MOVX    A,@DPTR
   \   00001D   F9           MOV     R1,A
   \   00001E   E8           MOV     A,R0
   \   00001F   FE           MOV     R6,A
   \   000020   E9           MOV     A,R1
   \   000021   FF           MOV     R7,A
   2347            pSimpleDescRsp->status = *msg++;
   \   000022   8E82         MOV     DPL,R6
   \   000024   8F83         MOV     DPH,R7
   \   000026   E0           MOVX    A,@DPTR
   \   000027   85..82       MOV     DPL,?V0 + 0
   \   00002A   85..83       MOV     DPH,?V0 + 1
   \   00002D   F0           MOVX    @DPTR,A
   \   00002E   8E82         MOV     DPL,R6
   \   000030   8F83         MOV     DPH,R7
   \   000032   A3           INC     DPTR
   \   000033   AE82         MOV     R6,DPL
   \   000035   AF83         MOV     R7,DPH
   2348            pSimpleDescRsp->nwkAddr = BUILD_UINT16( msg[0], msg[1] );
   \   000037   8E82         MOV     DPL,R6
   \   000039   8F83         MOV     DPH,R7
   \   00003B   E0           MOVX    A,@DPTR
   \   00003C   FA           MOV     R2,A
   \   00003D   7B00         MOV     R3,#0x0
   \   00003F   8E82         MOV     DPL,R6
   \   000041   8F83         MOV     DPH,R7
   \   000043   A3           INC     DPTR
   \   000044   E0           MOVX    A,@DPTR
   \   000045   F8           MOV     R0,A
   \   000046   E4           CLR     A
   \   000047   C8           XCH     A,R0
   \   000048   F9           MOV     R1,A
   \   000049   E8           MOV     A,R0
   \   00004A   2A           ADD     A,R2
   \   00004B   F8           MOV     R0,A
   \   00004C   E9           MOV     A,R1
   \   00004D   3B           ADDC    A,R3
   \   00004E   F9           MOV     R1,A
   \   00004F   85..82       MOV     DPL,?V0 + 0
   \   000052   85..83       MOV     DPH,?V0 + 1
   \   000055   A3           INC     DPTR
   \   000056   E8           MOV     A,R0
   \   000057   F0           MOVX    @DPTR,A
   \   000058   A3           INC     DPTR
   \   000059   E9           MOV     A,R1
   \   00005A   F0           MOVX    @DPTR,A
   2349            msg += sizeof ( uint16 );
   \   00005B   EE           MOV     A,R6
   \   00005C   2402         ADD     A,#0x2
   \   00005E   FE           MOV     R6,A
   \   00005F   EF           MOV     A,R7
   \   000060   3400         ADDC    A,#0x0
   \   000062   FF           MOV     R7,A
   2350            msg++; // Skip past the length field.
   \   000063   8E82         MOV     DPL,R6
   \   000065   8F83         MOV     DPH,R7
   \   000067   A3           INC     DPTR
   \   000068   AE82         MOV     R6,DPL
   \   00006A   AF83         MOV     R7,DPH
   2351          
   2352            if ( pSimpleDescRsp->status == ZDP_SUCCESS )
   \   00006C   85..82       MOV     DPL,?V0 + 0
   \   00006F   85..83       MOV     DPH,?V0 + 1
   \   000072   E0           MOVX    A,@DPTR
   \   000073   7011         JNZ     ??ZDO_ParseSimpleDescRsp_0
   2353            {
   2354              ZDO_ParseSimpleDescBuf( msg, &(pSimpleDescRsp->simpleDesc) );
   \   000075                ; Setup parameters for call to function ZDO_ParseSimpleDescBuf
   \   000075   E5..         MOV     A,?V0 + 0
   \   000077   2403         ADD     A,#0x3
   \   000079   FC           MOV     R4,A
   \   00007A   E5..         MOV     A,?V0 + 1
   \   00007C   3400         ADDC    A,#0x0
   \   00007E   FD           MOV     R5,A
   \   00007F   EE           MOV     A,R6
   \   000080   FA           MOV     R2,A
   \   000081   EF           MOV     A,R7
   \   000082   FB           MOV     R3,A
   \   000083   12....       LCALL   ??ZDO_ParseSimpleDescBuf?relay
   2355            }
   2356          }
   \                     ??ZDO_ParseSimpleDescRsp_0:
   \   000086   7F04         MOV     R7,#0x4
   \   000088   02....       LJMP    ?BANKED_LEAVE_XDATA
   2357          
   2358          /*********************************************************************
   2359           * @fn          ZDO_ParseEPListRsp
   2360           *
   2361           * @brief       This parse the Active_EP_rsp or Match_Desc_rsp message.
   2362           *
   2363           * @param       inMsg  - incoming message
   2364           *
   2365           * @return      none
   2366           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   2367          ZDO_ActiveEndpointRsp_t *ZDO_ParseEPListRsp( zdoIncomingMsg_t *inMsg )
   \                     ZDO_ParseEPListRsp:
   2368          {
   \   000000   74F1         MOV     A,#-0xf
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 15
   \   000005                ; Auto size: 2
   \   000005   74FE         MOV     A,#-0x2
   \   000007   12....       LCALL   ?ALLOC_XSTACK8
   \   00000A   85..82       MOV     DPL,?XSP + 0
   \   00000D   85..83       MOV     DPH,?XSP + 1
   \   000010   EA           MOV     A,R2
   \   000011   F0           MOVX    @DPTR,A
   \   000012   A3           INC     DPTR
   \   000013   EB           MOV     A,R3
   \   000014   F0           MOVX    @DPTR,A
   2369            ZDO_ActiveEndpointRsp_t *pRsp;
   2370            uint8 *msg;
   2371            uint8 Status;
   2372            uint8 cnt;
   2373          
   2374            msg = inMsg->asdu;
   \   000015   85..82       MOV     DPL,?XSP + 0
   \   000018   85..83       MOV     DPH,?XSP + 1
   \   00001B   E0           MOVX    A,@DPTR
   \   00001C   2411         ADD     A,#0x11
   \   00001E   F8           MOV     R0,A
   \   00001F   A3           INC     DPTR
   \   000020   E0           MOVX    A,@DPTR
   \   000021   3400         ADDC    A,#0x0
   \   000023   F9           MOV     R1,A
   \   000024   8882         MOV     DPL,R0
   \   000026   8983         MOV     DPH,R1
   \   000028   E0           MOVX    A,@DPTR
   \   000029   F8           MOV     R0,A
   \   00002A   A3           INC     DPTR
   \   00002B   E0           MOVX    A,@DPTR
   \   00002C   F9           MOV     R1,A
   \   00002D   E8           MOV     A,R0
   \   00002E   FE           MOV     R6,A
   \   00002F   E9           MOV     A,R1
   \   000030   FF           MOV     R7,A
   2375            Status = *msg++;
   \   000031   8E82         MOV     DPL,R6
   \   000033   8F83         MOV     DPH,R7
   \   000035   E0           MOVX    A,@DPTR
   \   000036   F5..         MOV     ?V0 + 6,A
   \   000038   8E82         MOV     DPL,R6
   \   00003A   8F83         MOV     DPH,R7
   \   00003C   A3           INC     DPTR
   \   00003D   AE82         MOV     R6,DPL
   \   00003F   AF83         MOV     R7,DPH
   2376            cnt = msg[2];
   \   000041   8E82         MOV     DPL,R6
   \   000043   8F83         MOV     DPH,R7
   \   000045   A3           INC     DPTR
   \   000046   A3           INC     DPTR
   \   000047   E0           MOVX    A,@DPTR
   \   000048   F5..         MOV     ?V0 + 3,A
   2377          
   2378            pRsp = (ZDO_ActiveEndpointRsp_t *)osal_mem_alloc( sizeof(  ZDO_ActiveEndpointRsp_t ) + cnt );
   \   00004A                ; Setup parameters for call to function osal_mem_alloc
   \   00004A   85....       MOV     ?V0 + 0,?V0 + 3
   \   00004D   75..00       MOV     ?V0 + 1,#0x0
   \   000050   7404         MOV     A,#0x4
   \   000052   25..         ADD     A,?V0 + 0
   \   000054   FA           MOV     R2,A
   \   000055   7400         MOV     A,#0x0
   \   000057   35..         ADDC    A,?V0 + 1
   \   000059   FB           MOV     R3,A
   \   00005A   12....       LCALL   ??osal_mem_alloc?relay
   \   00005D   8A..         MOV     ?V0 + 0,R2
   \   00005F   8B..         MOV     ?V0 + 1,R3
   \   000061   85....       MOV     ?V0 + 4,?V0 + 0
   \   000064   85....       MOV     ?V0 + 5,?V0 + 1
   2379            if ( pRsp )
   \   000067   E5..         MOV     A,?V0 + 4
   \   000069   6400         XRL     A,#0x0
   \   00006B   7004         JNZ     ??ZDO_ParseEPListRsp_0
   \   00006D   E5..         MOV     A,?V0 + 5
   \   00006F   6400         XRL     A,#0x0
   \                     ??ZDO_ParseEPListRsp_0:
   \   000071   6070         JZ      ??ZDO_ParseEPListRsp_1
   2380            {
   2381              pRsp->status = Status;
   \   000073   85..82       MOV     DPL,?V0 + 4
   \   000076   85..83       MOV     DPH,?V0 + 5
   \   000079   E5..         MOV     A,?V0 + 6
   \   00007B   F0           MOVX    @DPTR,A
   2382              pRsp->nwkAddr = BUILD_UINT16( msg[0], msg[1] );
   \   00007C   8E82         MOV     DPL,R6
   \   00007E   8F83         MOV     DPH,R7
   \   000080   E0           MOVX    A,@DPTR
   \   000081   FA           MOV     R2,A
   \   000082   7B00         MOV     R3,#0x0
   \   000084   8E82         MOV     DPL,R6
   \   000086   8F83         MOV     DPH,R7
   \   000088   A3           INC     DPTR
   \   000089   E0           MOVX    A,@DPTR
   \   00008A   F8           MOV     R0,A
   \   00008B   E4           CLR     A
   \   00008C   C8           XCH     A,R0
   \   00008D   F9           MOV     R1,A
   \   00008E   E8           MOV     A,R0
   \   00008F   2A           ADD     A,R2
   \   000090   F8           MOV     R0,A
   \   000091   E9           MOV     A,R1
   \   000092   3B           ADDC    A,R3
   \   000093   F9           MOV     R1,A
   \   000094   85..82       MOV     DPL,?V0 + 4
   \   000097   85..83       MOV     DPH,?V0 + 5
   \   00009A   A3           INC     DPTR
   \   00009B   E8           MOV     A,R0
   \   00009C   F0           MOVX    @DPTR,A
   \   00009D   A3           INC     DPTR
   \   00009E   E9           MOV     A,R1
   \   00009F   F0           MOVX    @DPTR,A
   2383              msg += sizeof( uint16 );
   \   0000A0   EE           MOV     A,R6
   \   0000A1   2402         ADD     A,#0x2
   \   0000A3   FE           MOV     R6,A
   \   0000A4   EF           MOV     A,R7
   \   0000A5   3400         ADDC    A,#0x0
   \   0000A7   FF           MOV     R7,A
   2384              pRsp->cnt = cnt;
   \   0000A8   85..82       MOV     DPL,?V0 + 4
   \   0000AB   85..83       MOV     DPH,?V0 + 5
   \   0000AE   A3           INC     DPTR
   \   0000AF   A3           INC     DPTR
   \   0000B0   A3           INC     DPTR
   \   0000B1   E5..         MOV     A,?V0 + 3
   \   0000B3   F0           MOVX    @DPTR,A
   2385              msg++; // pass cnt
   \   0000B4   8E82         MOV     DPL,R6
   \   0000B6   8F83         MOV     DPH,R7
   \   0000B8   A3           INC     DPTR
   \   0000B9   AE82         MOV     R6,DPL
   \   0000BB   AF83         MOV     R7,DPH
   2386              osal_memcpy( pRsp->epList, msg, cnt );
   \   0000BD                ; Setup parameters for call to function osal_memcpy
   \   0000BD   8E..         MOV     ?V0 + 0,R6
   \   0000BF   8F..         MOV     ?V0 + 1,R7
   \   0000C1   75..00       MOV     ?V0 + 2,#0x0
   \   0000C4   78..         MOV     R0,#?V0 + 0
   \   0000C6   12....       LCALL   ?PUSH_XSTACK_I_THREE
   \   0000C9   E5..         MOV     A,?V0 + 3
   \   0000CB   F5..         MOV     ?V0 + 0,A
   \   0000CD   AC..         MOV     R4,?V0 + 0
   \   0000CF   7D00         MOV     R5,#0x0
   \   0000D1   E5..         MOV     A,?V0 + 4
   \   0000D3   2404         ADD     A,#0x4
   \   0000D5   FA           MOV     R2,A
   \   0000D6   E5..         MOV     A,?V0 + 5
   \   0000D8   3400         ADDC    A,#0x0
   \   0000DA   FB           MOV     R3,A
   \   0000DB   12....       LCALL   ??osal_memcpy?relay
   \   0000DE   7403         MOV     A,#0x3
   \   0000E0   12....       LCALL   ?DEALLOC_XSTACK8
   2387            }
   2388          
   2389            return ( pRsp );
   \                     ??ZDO_ParseEPListRsp_1:
   \   0000E3   AA..         MOV     R2,?V0 + 4
   \   0000E5   AB..         MOV     R3,?V0 + 5
   \   0000E7   7402         MOV     A,#0x2
   \   0000E9   12....       LCALL   ?DEALLOC_XSTACK8
   \   0000EC   7F07         MOV     R7,#0x7
   \   0000EE   02....       LJMP    ?BANKED_LEAVE_XDATA
   2390          }
   2391          
   2392          /*********************************************************************
   2393           * @fn          ZDO_ParseServerDiscRsp
   2394           *
   2395           * @brief       Parse the Server_Discovery_rsp message.
   2396           *
   2397           * @param       inMsg - incoming message.
   2398           * @param       pRsp - place to put the parsed information.
   2399           *
   2400           * @return      none
   2401           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   2402          void ZDO_ParseServerDiscRsp( zdoIncomingMsg_t *inMsg, ZDO_ServerDiscRsp_t *pRsp )
   \                     ZDO_ParseServerDiscRsp:
   2403          {
   \   000000   74F7         MOV     A,#-0x9
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 9
   \   000005                ; Auto size: 0
   2404            pRsp->status = inMsg->asdu[0];
   \   000005   EA           MOV     A,R2
   \   000006   2411         ADD     A,#0x11
   \   000008   F582         MOV     DPL,A
   \   00000A   EB           MOV     A,R3
   \   00000B   3400         ADDC    A,#0x0
   \   00000D   F583         MOV     DPH,A
   \   00000F   E0           MOVX    A,@DPTR
   \   000010   F8           MOV     R0,A
   \   000011   A3           INC     DPTR
   \   000012   E0           MOVX    A,@DPTR
   \   000013   F583         MOV     DPH,A
   \   000015   8882         MOV     DPL,R0
   \   000017   E0           MOVX    A,@DPTR
   \   000018   8C82         MOV     DPL,R4
   \   00001A   8D83         MOV     DPH,R5
   \   00001C   F0           MOVX    @DPTR,A
   2405            pRsp->serverMask = BUILD_UINT16( inMsg->asdu[1], inMsg->asdu[2] );
   \   00001D   EA           MOV     A,R2
   \   00001E   2411         ADD     A,#0x11
   \   000020   F582         MOV     DPL,A
   \   000022   EB           MOV     A,R3
   \   000023   3400         ADDC    A,#0x0
   \   000025   F583         MOV     DPH,A
   \   000027   E0           MOVX    A,@DPTR
   \   000028   F8           MOV     R0,A
   \   000029   A3           INC     DPTR
   \   00002A   E0           MOVX    A,@DPTR
   \   00002B   F583         MOV     DPH,A
   \   00002D   8882         MOV     DPL,R0
   \   00002F   A3           INC     DPTR
   \   000030   E0           MOVX    A,@DPTR
   \   000031   FE           MOV     R6,A
   \   000032   7F00         MOV     R7,#0x0
   \   000034   EA           MOV     A,R2
   \   000035   2411         ADD     A,#0x11
   \   000037   F582         MOV     DPL,A
   \   000039   EB           MOV     A,R3
   \   00003A   3400         ADDC    A,#0x0
   \   00003C   F583         MOV     DPH,A
   \   00003E   E0           MOVX    A,@DPTR
   \   00003F   F8           MOV     R0,A
   \   000040   A3           INC     DPTR
   \   000041   E0           MOVX    A,@DPTR
   \   000042   F583         MOV     DPH,A
   \   000044   8882         MOV     DPL,R0
   \   000046   A3           INC     DPTR
   \   000047   A3           INC     DPTR
   \   000048   E0           MOVX    A,@DPTR
   \   000049   F8           MOV     R0,A
   \   00004A   E4           CLR     A
   \   00004B   C8           XCH     A,R0
   \   00004C   F9           MOV     R1,A
   \   00004D   E8           MOV     A,R0
   \   00004E   2E           ADD     A,R6
   \   00004F   F8           MOV     R0,A
   \   000050   E9           MOV     A,R1
   \   000051   3F           ADDC    A,R7
   \   000052   F9           MOV     R1,A
   \   000053   8C82         MOV     DPL,R4
   \   000055   8D83         MOV     DPH,R5
   \   000057   A3           INC     DPTR
   \   000058   E8           MOV     A,R0
   \   000059   F0           MOVX    @DPTR,A
   \   00005A   A3           INC     DPTR
   \   00005B   E9           MOV     A,R1
   \   00005C   F0           MOVX    @DPTR,A
   2406          }
   \   00005D   7F01         MOV     R7,#0x1
   \   00005F   02....       LJMP    ?BANKED_LEAVE_XDATA
   2407          
   2408          /*********************************************************************
   2409           * @fn          ZDO_ParseMgmtLqiRsp
   2410           *
   2411           * @brief       This function parses the incoming Management
   2412           *              LQI response
   2413           *
   2414           * @param       inMsg - incoming message
   2415           *
   2416           * @return      a pointer to parsed response structure (NULL if not allocated).
   2417           *          This structure was allocated using osal_mem_alloc, so it must be freed
   2418           *          by the calling function [osal_mem_free()].
   2419           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   2420          ZDO_MgmtLqiRsp_t *ZDO_ParseMgmtLqiRsp( zdoIncomingMsg_t *inMsg )
   \                     ZDO_ParseMgmtLqiRsp:
   2421          {
   \   000000   74F0         MOV     A,#-0x10
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 16
   \   000005                ; Auto size: 3
   \   000005   74FD         MOV     A,#-0x3
   \   000007   12....       LCALL   ?ALLOC_XSTACK8
   \   00000A   7401         MOV     A,#0x1
   \   00000C   12....       LCALL   ?XSTACK_DISP0_8
   \   00000F   EA           MOV     A,R2
   \   000010   F0           MOVX    @DPTR,A
   \   000011   A3           INC     DPTR
   \   000012   EB           MOV     A,R3
   \   000013   F0           MOVX    @DPTR,A
   2422            ZDO_MgmtLqiRsp_t *pRsp;
   2423            uint8 status;
   2424            uint8 startIndex = 0;
   \   000014   75..00       MOV     ?V0 + 4,#0x0
   2425            uint8 neighborLqiCount = 0;
   \   000017   75..00       MOV     ?V0 + 0,#0x0
   2426            uint8 neighborLqiEntries = 0;
   \   00001A   75..00       MOV     ?V0 + 1,#0x0
   2427            uint8 *msg;
   2428          
   2429            msg = inMsg->asdu;
   \   00001D   7401         MOV     A,#0x1
   \   00001F   12....       LCALL   ?XSTACK_DISP0_8
   \   000022   E0           MOVX    A,@DPTR
   \   000023   2411         ADD     A,#0x11
   \   000025   F8           MOV     R0,A
   \   000026   A3           INC     DPTR
   \   000027   E0           MOVX    A,@DPTR
   \   000028   3400         ADDC    A,#0x0
   \   00002A   F9           MOV     R1,A
   \   00002B   8882         MOV     DPL,R0
   \   00002D   8983         MOV     DPH,R1
   \   00002F   E0           MOVX    A,@DPTR
   \   000030   F8           MOV     R0,A
   \   000031   A3           INC     DPTR
   \   000032   E0           MOVX    A,@DPTR
   \   000033   F9           MOV     R1,A
   \   000034   E8           MOV     A,R0
   \   000035   FE           MOV     R6,A
   \   000036   E9           MOV     A,R1
   \   000037   FF           MOV     R7,A
   2430          
   2431            status = *msg++;
   \   000038   8E82         MOV     DPL,R6
   \   00003A   8F83         MOV     DPH,R7
   \   00003C   E0           MOVX    A,@DPTR
   \   00003D   85..82       MOV     DPL,?XSP + 0
   \   000040   85..83       MOV     DPH,?XSP + 1
   \   000043   F0           MOVX    @DPTR,A
   \   000044   8E82         MOV     DPL,R6
   \   000046   8F83         MOV     DPH,R7
   \   000048   A3           INC     DPTR
   \   000049   AE82         MOV     R6,DPL
   \   00004B   AF83         MOV     R7,DPH
   2432            if ( status == ZSuccess )
   \   00004D   85..82       MOV     DPL,?XSP + 0
   \   000050   85..83       MOV     DPH,?XSP + 1
   \   000053   E0           MOVX    A,@DPTR
   \   000054   7030         JNZ     ??ZDO_ParseMgmtLqiRsp_0
   2433            {
   2434              neighborLqiEntries = *msg++;
   \   000056   8E82         MOV     DPL,R6
   \   000058   8F83         MOV     DPH,R7
   \   00005A   E0           MOVX    A,@DPTR
   \   00005B   F5..         MOV     ?V0 + 1,A
   \   00005D   8E82         MOV     DPL,R6
   \   00005F   8F83         MOV     DPH,R7
   \   000061   A3           INC     DPTR
   \   000062   AE82         MOV     R6,DPL
   \   000064   AF83         MOV     R7,DPH
   2435              startIndex = *msg++;
   \   000066   8E82         MOV     DPL,R6
   \   000068   8F83         MOV     DPH,R7
   \   00006A   E0           MOVX    A,@DPTR
   \   00006B   F5..         MOV     ?V0 + 4,A
   \   00006D   8E82         MOV     DPL,R6
   \   00006F   8F83         MOV     DPH,R7
   \   000071   A3           INC     DPTR
   \   000072   AE82         MOV     R6,DPL
   \   000074   AF83         MOV     R7,DPH
   2436              neighborLqiCount = *msg++;
   \   000076   8E82         MOV     DPL,R6
   \   000078   8F83         MOV     DPH,R7
   \   00007A   E0           MOVX    A,@DPTR
   \   00007B   F5..         MOV     ?V0 + 0,A
   \   00007D   8E82         MOV     DPL,R6
   \   00007F   8F83         MOV     DPH,R7
   \   000081   A3           INC     DPTR
   \   000082   AE82         MOV     R6,DPL
   \   000084   AF83         MOV     R7,DPH
   2437            }
   2438          
   2439            // Allocate a buffer big enough to handle the list.
   2440            pRsp = (ZDO_MgmtLqiRsp_t *)osal_mem_alloc(
   2441                      sizeof( ZDO_MgmtLqiRsp_t ) + (neighborLqiCount * sizeof( neighborLqiItem_t )) );
   \                     ??ZDO_ParseMgmtLqiRsp_0:
   \   000086                ; Setup parameters for call to function osal_mem_alloc
   \   000086   A8..         MOV     R0,?V0 + 0
   \   000088   7900         MOV     R1,#0x0
   \   00008A   E8           MOV     A,R0
   \   00008B   75F00E       MOV     B,#0xe
   \   00008E   A4           MUL     AB
   \   00008F   C8           XCH     A,R0
   \   000090   AAF0         MOV     R2,B
   \   000092   75F000       MOV     B,#0x0
   \   000095   A4           MUL     AB
   \   000096   2A           ADD     A,R2
   \   000097   FA           MOV     R2,A
   \   000098   75F00E       MOV     B,#0xe
   \   00009B   E9           MOV     A,R1
   \   00009C   A4           MUL     AB
   \   00009D   2A           ADD     A,R2
   \   00009E   F9           MOV     R1,A
   \   00009F   7404         MOV     A,#0x4
   \   0000A1   28           ADD     A,R0
   \   0000A2   FA           MOV     R2,A
   \   0000A3   7400         MOV     A,#0x0
   \   0000A5   39           ADDC    A,R1
   \   0000A6   FB           MOV     R3,A
   \   0000A7   12....       LCALL   ??osal_mem_alloc?relay
   \   0000AA   8A..         MOV     ?V0 + 2,R2
   \   0000AC   8B..         MOV     ?V0 + 3,R3
   \   0000AE   85....       MOV     ?V0 + 6,?V0 + 2
   \   0000B1   85....       MOV     ?V0 + 7,?V0 + 3
   2442            if ( pRsp )
   \   0000B4   E5..         MOV     A,?V0 + 6
   \   0000B6   6400         XRL     A,#0x0
   \   0000B8   7004         JNZ     ??ZDO_ParseMgmtLqiRsp_1
   \   0000BA   E5..         MOV     A,?V0 + 7
   \   0000BC   6400         XRL     A,#0x0
   \                     ??ZDO_ParseMgmtLqiRsp_1:
   \   0000BE   7003         JNZ     $+5
   \   0000C0   02....       LJMP    ??ZDO_ParseMgmtLqiRsp_2 & 0xFFFF
   2443            {
   2444              uint8 x;
   2445              neighborLqiItem_t *pList = pRsp->list;
   \   0000C3   E5..         MOV     A,?V0 + 6
   \   0000C5   2404         ADD     A,#0x4
   \   0000C7   F8           MOV     R0,A
   \   0000C8   E5..         MOV     A,?V0 + 7
   \   0000CA   3400         ADDC    A,#0x0
   \   0000CC   F9           MOV     R1,A
   \   0000CD   88..         MOV     ?V0 + 2,R0
   \   0000CF   89..         MOV     ?V0 + 3,R1
   2446              pRsp->status = status;
   \   0000D1   85..82       MOV     DPL,?XSP + 0
   \   0000D4   85..83       MOV     DPH,?XSP + 1
   \   0000D7   E0           MOVX    A,@DPTR
   \   0000D8   85..82       MOV     DPL,?V0 + 6
   \   0000DB   85..83       MOV     DPH,?V0 + 7
   \   0000DE   F0           MOVX    @DPTR,A
   2447              pRsp->neighborLqiEntries = neighborLqiEntries;
   \   0000DF   85..82       MOV     DPL,?V0 + 6
   \   0000E2   85..83       MOV     DPH,?V0 + 7
   \   0000E5   A3           INC     DPTR
   \   0000E6   E5..         MOV     A,?V0 + 1
   \   0000E8   F0           MOVX    @DPTR,A
   2448              pRsp->startIndex = startIndex;
   \   0000E9   85..82       MOV     DPL,?V0 + 6
   \   0000EC   85..83       MOV     DPH,?V0 + 7
   \   0000EF   A3           INC     DPTR
   \   0000F0   A3           INC     DPTR
   \   0000F1   E5..         MOV     A,?V0 + 4
   \   0000F3   F0           MOVX    @DPTR,A
   2449              pRsp->neighborLqiCount = neighborLqiCount;
   \   0000F4   85..82       MOV     DPL,?V0 + 6
   \   0000F7   85..83       MOV     DPH,?V0 + 7
   \   0000FA   A3           INC     DPTR
   \   0000FB   A3           INC     DPTR
   \   0000FC   A3           INC     DPTR
   \   0000FD   E5..         MOV     A,?V0 + 0
   \   0000FF   F0           MOVX    @DPTR,A
   2450          
   2451              for ( x = 0; x < neighborLqiCount; x++ )
   \   000100   75..00       MOV     ?V0 + 5,#0x0
   \                     ??ZDO_ParseMgmtLqiRsp_3:
   \   000103   E5..         MOV     A,?V0 + 5
   \   000105   C3           CLR     C
   \   000106   95..         SUBB    A,?V0 + 0
   \   000108   4003         JC      $+5
   \   00010A   02....       LJMP    ??ZDO_ParseMgmtLqiRsp_2 & 0xFFFF
   2452              {
   2453                osal_cpyExtAddr(pList->extPANId, msg);   //Copy extended PAN ID
   \   00010D                ; Setup parameters for call to function osal_cpyExtAddr
   \   00010D   EE           MOV     A,R6
   \   00010E   FC           MOV     R4,A
   \   00010F   EF           MOV     A,R7
   \   000110   FD           MOV     R5,A
   \   000111   E5..         MOV     A,?V0 + 2
   \   000113   2404         ADD     A,#0x4
   \   000115   FA           MOV     R2,A
   \   000116   E5..         MOV     A,?V0 + 3
   \   000118   3400         ADDC    A,#0x0
   \   00011A   FB           MOV     R3,A
   \   00011B   12....       LCALL   ??osal_cpyExtAddr?relay
   2454                msg += Z_EXTADDR_LEN;
   \   00011E   EE           MOV     A,R6
   \   00011F   2408         ADD     A,#0x8
   \   000121   FE           MOV     R6,A
   \   000122   EF           MOV     A,R7
   \   000123   3400         ADDC    A,#0x0
   \   000125   FF           MOV     R7,A
   2455          
   2456                msg += Z_EXTADDR_LEN;  // Throwing away IEEE.
   \   000126   EE           MOV     A,R6
   \   000127   2408         ADD     A,#0x8
   \   000129   FE           MOV     R6,A
   \   00012A   EF           MOV     A,R7
   \   00012B   3400         ADDC    A,#0x0
   \   00012D   FF           MOV     R7,A
   2457                pList->nwkAddr = BUILD_UINT16( msg[0], msg[1] );
   \   00012E   8E82         MOV     DPL,R6
   \   000130   8F83         MOV     DPH,R7
   \   000132   E0           MOVX    A,@DPTR
   \   000133   F8           MOV     R0,A
   \   000134   7900         MOV     R1,#0x0
   \   000136   8E82         MOV     DPL,R6
   \   000138   8F83         MOV     DPH,R7
   \   00013A   A3           INC     DPTR
   \   00013B   E0           MOVX    A,@DPTR
   \   00013C   FA           MOV     R2,A
   \   00013D   E4           CLR     A
   \   00013E   CA           XCH     A,R2
   \   00013F   FB           MOV     R3,A
   \   000140   EA           MOV     A,R2
   \   000141   28           ADD     A,R0
   \   000142   F8           MOV     R0,A
   \   000143   EB           MOV     A,R3
   \   000144   39           ADDC    A,R1
   \   000145   F9           MOV     R1,A
   \   000146   85..82       MOV     DPL,?V0 + 2
   \   000149   85..83       MOV     DPH,?V0 + 3
   \   00014C   E8           MOV     A,R0
   \   00014D   F0           MOVX    @DPTR,A
   \   00014E   A3           INC     DPTR
   \   00014F   E9           MOV     A,R1
   \   000150   F0           MOVX    @DPTR,A
   2458                msg += 2 + 1 + 1 + 1;      // Skip DeviceType, RxOnIdle, Rlationship, PermitJoining and Depth
   \   000151   EE           MOV     A,R6
   \   000152   2405         ADD     A,#0x5
   \   000154   FE           MOV     R6,A
   \   000155   EF           MOV     A,R7
   \   000156   3400         ADDC    A,#0x0
   \   000158   FF           MOV     R7,A
   2459                pList->rxLqi = *msg++;
   \   000159   8E82         MOV     DPL,R6
   \   00015B   8F83         MOV     DPH,R7
   \   00015D   E0           MOVX    A,@DPTR
   \   00015E   C0E0         PUSH    A
   \   000160   E5..         MOV     A,?V0 + 2
   \   000162   240D         ADD     A,#0xd
   \   000164   F582         MOV     DPL,A
   \   000166   E5..         MOV     A,?V0 + 3
   \   000168   3400         ADDC    A,#0x0
   \   00016A   F583         MOV     DPH,A
   \   00016C   D0E0         POP     A
   \   00016E   F0           MOVX    @DPTR,A
   \   00016F   8E82         MOV     DPL,R6
   \   000171   8F83         MOV     DPH,R7
   \   000173   A3           INC     DPTR
   \   000174   AE82         MOV     R6,DPL
   \   000176   AF83         MOV     R7,DPH
   2460                pList->txQuality = 0;  // This is not specified OTA by ZigBee 1.1.
   \   000178   7400         MOV     A,#0x0
   \   00017A   C0E0         PUSH    A
   \   00017C   E5..         MOV     A,?V0 + 2
   \   00017E   240C         ADD     A,#0xc
   \   000180   F582         MOV     DPL,A
   \   000182   E5..         MOV     A,?V0 + 3
   \   000184   3400         ADDC    A,#0x0
   \   000186   F583         MOV     DPH,A
   \   000188   D0E0         POP     A
   \   00018A   F0           MOVX    @DPTR,A
   2461                pList++;
   \   00018B   E5..         MOV     A,?V0 + 2
   \   00018D   240E         ADD     A,#0xe
   \   00018F   F5..         MOV     ?V0 + 2,A
   \   000191   E5..         MOV     A,?V0 + 3
   \   000193   3400         ADDC    A,#0x0
   \   000195   F5..         MOV     ?V0 + 3,A
   2462              }
   \   000197   05..         INC     ?V0 + 5
   \   000199   02....       LJMP    ??ZDO_ParseMgmtLqiRsp_3 & 0xFFFF
   2463            }
   2464          
   2465            return ( pRsp );
   \                     ??ZDO_ParseMgmtLqiRsp_2:
   \   00019C   AA..         MOV     R2,?V0 + 6
   \   00019E   AB..         MOV     R3,?V0 + 7
   \   0001A0   7403         MOV     A,#0x3
   \   0001A2   12....       LCALL   ?DEALLOC_XSTACK8
   \   0001A5   7F08         MOV     R7,#0x8
   \   0001A7   02....       LJMP    ?BANKED_LEAVE_XDATA
   2466          }
   2467          
   2468          /*********************************************************************
   2469           * @fn          ZDO_ParseMgmNwkDiscRsp
   2470           *
   2471           * @brief       This function parses the incoming Management
   2472           *              Network Discover response.
   2473           *
   2474           * @param       inMsg - incoming message
   2475           *
   2476           * @return      pointer to parsed response.  This structure was
   2477           *          allocated using osal_mem_alloc, so it must be freed
   2478           *          by the calling function [osal_mem_free()].
   2479           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   2480          ZDO_MgmNwkDiscRsp_t *ZDO_ParseMgmNwkDiscRsp( zdoIncomingMsg_t *inMsg )
   \                     ZDO_ParseMgmNwkDiscRsp:
   2481          {
   \   000000   74F0         MOV     A,#-0x10
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 16
   \   000005                ; Auto size: 3
   \   000005   74FD         MOV     A,#-0x3
   \   000007   12....       LCALL   ?ALLOC_XSTACK8
   \   00000A   7401         MOV     A,#0x1
   \   00000C   12....       LCALL   ?XSTACK_DISP0_8
   \   00000F   EA           MOV     A,R2
   \   000010   F0           MOVX    @DPTR,A
   \   000011   A3           INC     DPTR
   \   000012   EB           MOV     A,R3
   \   000013   F0           MOVX    @DPTR,A
   2482            ZDO_MgmNwkDiscRsp_t *pRsp;
   2483            uint8 status;
   2484            uint8 networkCount = 0;
   \   000014   75..00       MOV     ?V0 + 4,#0x0
   2485            uint8 startIndex = 0;
   \   000017   75..00       MOV     ?V0 + 3,#0x0
   2486            uint8 networkListCount = 0;
   \   00001A   75..00       MOV     ?V0 + 2,#0x0
   2487            uint8 *msg;
   2488          
   2489            msg = inMsg->asdu;
   \   00001D   7401         MOV     A,#0x1
   \   00001F   12....       LCALL   ?XSTACK_DISP0_8
   \   000022   E0           MOVX    A,@DPTR
   \   000023   2411         ADD     A,#0x11
   \   000025   F8           MOV     R0,A
   \   000026   A3           INC     DPTR
   \   000027   E0           MOVX    A,@DPTR
   \   000028   3400         ADDC    A,#0x0
   \   00002A   F9           MOV     R1,A
   \   00002B   8882         MOV     DPL,R0
   \   00002D   8983         MOV     DPH,R1
   \   00002F   E0           MOVX    A,@DPTR
   \   000030   F8           MOV     R0,A
   \   000031   A3           INC     DPTR
   \   000032   E0           MOVX    A,@DPTR
   \   000033   F9           MOV     R1,A
   \   000034   E8           MOV     A,R0
   \   000035   FE           MOV     R6,A
   \   000036   E9           MOV     A,R1
   \   000037   FF           MOV     R7,A
   2490            status = *msg++;
   \   000038   8E82         MOV     DPL,R6
   \   00003A   8F83         MOV     DPH,R7
   \   00003C   E0           MOVX    A,@DPTR
   \   00003D   85..82       MOV     DPL,?XSP + 0
   \   000040   85..83       MOV     DPH,?XSP + 1
   \   000043   F0           MOVX    @DPTR,A
   \   000044   8E82         MOV     DPL,R6
   \   000046   8F83         MOV     DPH,R7
   \   000048   A3           INC     DPTR
   \   000049   AE82         MOV     R6,DPL
   \   00004B   AF83         MOV     R7,DPH
   2491          
   2492            if ( status == ZSuccess )
   \   00004D   85..82       MOV     DPL,?XSP + 0
   \   000050   85..83       MOV     DPH,?XSP + 1
   \   000053   E0           MOVX    A,@DPTR
   \   000054   7030         JNZ     ??ZDO_ParseMgmNwkDiscRsp_0
   2493            {
   2494              networkCount = *msg++;
   \   000056   8E82         MOV     DPL,R6
   \   000058   8F83         MOV     DPH,R7
   \   00005A   E0           MOVX    A,@DPTR
   \   00005B   F5..         MOV     ?V0 + 4,A
   \   00005D   8E82         MOV     DPL,R6
   \   00005F   8F83         MOV     DPH,R7
   \   000061   A3           INC     DPTR
   \   000062   AE82         MOV     R6,DPL
   \   000064   AF83         MOV     R7,DPH
   2495              startIndex = *msg++;
   \   000066   8E82         MOV     DPL,R6
   \   000068   8F83         MOV     DPH,R7
   \   00006A   E0           MOVX    A,@DPTR
   \   00006B   F5..         MOV     ?V0 + 3,A
   \   00006D   8E82         MOV     DPL,R6
   \   00006F   8F83         MOV     DPH,R7
   \   000071   A3           INC     DPTR
   \   000072   AE82         MOV     R6,DPL
   \   000074   AF83         MOV     R7,DPH
   2496              networkListCount = *msg++;
   \   000076   8E82         MOV     DPL,R6
   \   000078   8F83         MOV     DPH,R7
   \   00007A   E0           MOVX    A,@DPTR
   \   00007B   F5..         MOV     ?V0 + 2,A
   \   00007D   8E82         MOV     DPL,R6
   \   00007F   8F83         MOV     DPH,R7
   \   000081   A3           INC     DPTR
   \   000082   AE82         MOV     R6,DPL
   \   000084   AF83         MOV     R7,DPH
   2497            }
   2498          
   2499            // Allocate a buffer big enough to handle the list.
   2500            pRsp = (ZDO_MgmNwkDiscRsp_t *)osal_mem_alloc( sizeof( ZDO_MgmNwkDiscRsp_t )
   2501                                            + (networkListCount * sizeof( mgmtNwkDiscItem_t )) );
   \                     ??ZDO_ParseMgmNwkDiscRsp_0:
   \   000086                ; Setup parameters for call to function osal_mem_alloc
   \   000086   A8..         MOV     R0,?V0 + 2
   \   000088   7900         MOV     R1,#0x0
   \   00008A   E8           MOV     A,R0
   \   00008B   75F010       MOV     B,#0x10
   \   00008E   A4           MUL     AB
   \   00008F   C8           XCH     A,R0
   \   000090   AAF0         MOV     R2,B
   \   000092   75F000       MOV     B,#0x0
   \   000095   A4           MUL     AB
   \   000096   2A           ADD     A,R2
   \   000097   FA           MOV     R2,A
   \   000098   75F010       MOV     B,#0x10
   \   00009B   E9           MOV     A,R1
   \   00009C   A4           MUL     AB
   \   00009D   2A           ADD     A,R2
   \   00009E   F9           MOV     R1,A
   \   00009F   7404         MOV     A,#0x4
   \   0000A1   28           ADD     A,R0
   \   0000A2   FA           MOV     R2,A
   \   0000A3   7400         MOV     A,#0x0
   \   0000A5   39           ADDC    A,R1
   \   0000A6   FB           MOV     R3,A
   \   0000A7   12....       LCALL   ??osal_mem_alloc?relay
   \   0000AA   8A..         MOV     ?V0 + 0,R2
   \   0000AC   8B..         MOV     ?V0 + 1,R3
   \   0000AE   85....       MOV     ?V0 + 6,?V0 + 0
   \   0000B1   85....       MOV     ?V0 + 7,?V0 + 1
   2502            if ( pRsp )
   \   0000B4   E5..         MOV     A,?V0 + 6
   \   0000B6   6400         XRL     A,#0x0
   \   0000B8   7004         JNZ     ??ZDO_ParseMgmNwkDiscRsp_1
   \   0000BA   E5..         MOV     A,?V0 + 7
   \   0000BC   6400         XRL     A,#0x0
   \                     ??ZDO_ParseMgmNwkDiscRsp_1:
   \   0000BE   7003         JNZ     $+5
   \   0000C0   02....       LJMP    ??ZDO_ParseMgmNwkDiscRsp_2 & 0xFFFF
   2503            {
   2504              uint8 x;
   2505              mgmtNwkDiscItem_t *pList;
   2506          
   2507              pRsp->status = status;
   \   0000C3   85..82       MOV     DPL,?XSP + 0
   \   0000C6   85..83       MOV     DPH,?XSP + 1
   \   0000C9   E0           MOVX    A,@DPTR
   \   0000CA   85..82       MOV     DPL,?V0 + 6
   \   0000CD   85..83       MOV     DPH,?V0 + 7
   \   0000D0   F0           MOVX    @DPTR,A
   2508              pRsp->networkCount = networkCount;
   \   0000D1   85..82       MOV     DPL,?V0 + 6
   \   0000D4   85..83       MOV     DPH,?V0 + 7
   \   0000D7   A3           INC     DPTR
   \   0000D8   E5..         MOV     A,?V0 + 4
   \   0000DA   F0           MOVX    @DPTR,A
   2509              pRsp->startIndex = startIndex;
   \   0000DB   85..82       MOV     DPL,?V0 + 6
   \   0000DE   85..83       MOV     DPH,?V0 + 7
   \   0000E1   A3           INC     DPTR
   \   0000E2   A3           INC     DPTR
   \   0000E3   E5..         MOV     A,?V0 + 3
   \   0000E5   F0           MOVX    @DPTR,A
   2510              pRsp->networkListCount = networkListCount;
   \   0000E6   85..82       MOV     DPL,?V0 + 6
   \   0000E9   85..83       MOV     DPH,?V0 + 7
   \   0000EC   A3           INC     DPTR
   \   0000ED   A3           INC     DPTR
   \   0000EE   A3           INC     DPTR
   \   0000EF   E5..         MOV     A,?V0 + 2
   \   0000F1   F0           MOVX    @DPTR,A
   2511              pList = pRsp->list;
   \   0000F2   E5..         MOV     A,?V0 + 6
   \   0000F4   2404         ADD     A,#0x4
   \   0000F6   F8           MOV     R0,A
   \   0000F7   E5..         MOV     A,?V0 + 7
   \   0000F9   3400         ADDC    A,#0x0
   \   0000FB   F9           MOV     R1,A
   \   0000FC   88..         MOV     ?V0 + 0,R0
   \   0000FE   89..         MOV     ?V0 + 1,R1
   2512          
   2513              for ( x = 0; x < networkListCount; x++ )
   \   000100   75..00       MOV     ?V0 + 5,#0x0
   \                     ??ZDO_ParseMgmNwkDiscRsp_3:
   \   000103   E5..         MOV     A,?V0 + 5
   \   000105   C3           CLR     C
   \   000106   95..         SUBB    A,?V0 + 2
   \   000108   4003         JC      $+5
   \   00010A   02....       LJMP    ??ZDO_ParseMgmNwkDiscRsp_2 & 0xFFFF
   2514              {
   2515                osal_cpyExtAddr(pList->extendedPANID, msg);   //Copy extended PAN ID
   \   00010D                ; Setup parameters for call to function osal_cpyExtAddr
   \   00010D   EE           MOV     A,R6
   \   00010E   FC           MOV     R4,A
   \   00010F   EF           MOV     A,R7
   \   000110   FD           MOV     R5,A
   \   000111   AA..         MOV     R2,?V0 + 0
   \   000113   AB..         MOV     R3,?V0 + 1
   \   000115   12....       LCALL   ??osal_cpyExtAddr?relay
   2516                pList->PANId = BUILD_UINT16( msg[0], msg[1] );
   \   000118   8E82         MOV     DPL,R6
   \   00011A   8F83         MOV     DPH,R7
   \   00011C   E0           MOVX    A,@DPTR
   \   00011D   F8           MOV     R0,A
   \   00011E   7900         MOV     R1,#0x0
   \   000120   8E82         MOV     DPL,R6
   \   000122   8F83         MOV     DPH,R7
   \   000124   A3           INC     DPTR
   \   000125   E0           MOVX    A,@DPTR
   \   000126   FA           MOV     R2,A
   \   000127   E4           CLR     A
   \   000128   CA           XCH     A,R2
   \   000129   FB           MOV     R3,A
   \   00012A   EA           MOV     A,R2
   \   00012B   28           ADD     A,R0
   \   00012C   F8           MOV     R0,A
   \   00012D   EB           MOV     A,R3
   \   00012E   39           ADDC    A,R1
   \   00012F   F9           MOV     R1,A
   \   000130   85..82       MOV     DPL,?V0 + 0
   \   000133   85..83       MOV     DPH,?V0 + 1
   \   000136   A3           INC     DPTR
   \   000137   A3           INC     DPTR
   \   000138   A3           INC     DPTR
   \   000139   A3           INC     DPTR
   \   00013A   A3           INC     DPTR
   \   00013B   A3           INC     DPTR
   \   00013C   A3           INC     DPTR
   \   00013D   A3           INC     DPTR
   \   00013E   E8           MOV     A,R0
   \   00013F   F0           MOVX    @DPTR,A
   \   000140   A3           INC     DPTR
   \   000141   E9           MOV     A,R1
   \   000142   F0           MOVX    @DPTR,A
   2517                msg += Z_EXTADDR_LEN;
   \   000143   EE           MOV     A,R6
   \   000144   2408         ADD     A,#0x8
   \   000146   FE           MOV     R6,A
   \   000147   EF           MOV     A,R7
   \   000148   3400         ADDC    A,#0x0
   \   00014A   FF           MOV     R7,A
   2518          
   2519                pList->logicalChannel = *msg++;
   \   00014B   8E82         MOV     DPL,R6
   \   00014D   8F83         MOV     DPH,R7
   \   00014F   E0           MOVX    A,@DPTR
   \   000150   85..82       MOV     DPL,?V0 + 0
   \   000153   85..83       MOV     DPH,?V0 + 1
   \   000156   A3           INC     DPTR
   \   000157   A3           INC     DPTR
   \   000158   A3           INC     DPTR
   \   000159   A3           INC     DPTR
   \   00015A   A3           INC     DPTR
   \   00015B   A3           INC     DPTR
   \   00015C   A3           INC     DPTR
   \   00015D   A3           INC     DPTR
   \   00015E   A3           INC     DPTR
   \   00015F   A3           INC     DPTR
   \   000160   F0           MOVX    @DPTR,A
   \   000161   8E82         MOV     DPL,R6
   \   000163   8F83         MOV     DPH,R7
   \   000165   A3           INC     DPTR
   \   000166   AE82         MOV     R6,DPL
   \   000168   AF83         MOV     R7,DPH
   2520                pList->stackProfile = (*msg) & 0x0F;
   \   00016A   8E82         MOV     DPL,R6
   \   00016C   8F83         MOV     DPH,R7
   \   00016E   E0           MOVX    A,@DPTR
   \   00016F   540F         ANL     A,#0xf
   \   000171   C0E0         PUSH    A
   \   000173   E5..         MOV     A,?V0 + 0
   \   000175   240B         ADD     A,#0xb
   \   000177   F582         MOV     DPL,A
   \   000179   E5..         MOV     A,?V0 + 1
   \   00017B   3400         ADDC    A,#0x0
   \   00017D   F583         MOV     DPH,A
   \   00017F   D0E0         POP     A
   \   000181   F0           MOVX    @DPTR,A
   2521                pList->version = (*msg++ >> 4) & 0x0F;
   \   000182   8E82         MOV     DPL,R6
   \   000184   8F83         MOV     DPH,R7
   \   000186   E0           MOVX    A,@DPTR
   \   000187   C4           SWAP    A
   \   000188   540F         ANL     A,#0xf
   \   00018A   C0E0         PUSH    A
   \   00018C   E5..         MOV     A,?V0 + 0
   \   00018E   240C         ADD     A,#0xc
   \   000190   F582         MOV     DPL,A
   \   000192   E5..         MOV     A,?V0 + 1
   \   000194   3400         ADDC    A,#0x0
   \   000196   F583         MOV     DPH,A
   \   000198   D0E0         POP     A
   \   00019A   F0           MOVX    @DPTR,A
   \   00019B   8E82         MOV     DPL,R6
   \   00019D   8F83         MOV     DPH,R7
   \   00019F   A3           INC     DPTR
   \   0001A0   AE82         MOV     R6,DPL
   \   0001A2   AF83         MOV     R7,DPH
   2522                pList->beaconOrder = (*msg) & 0x0F;
   \   0001A4   8E82         MOV     DPL,R6
   \   0001A6   8F83         MOV     DPH,R7
   \   0001A8   E0           MOVX    A,@DPTR
   \   0001A9   540F         ANL     A,#0xf
   \   0001AB   C0E0         PUSH    A
   \   0001AD   E5..         MOV     A,?V0 + 0
   \   0001AF   240D         ADD     A,#0xd
   \   0001B1   F582         MOV     DPL,A
   \   0001B3   E5..         MOV     A,?V0 + 1
   \   0001B5   3400         ADDC    A,#0x0
   \   0001B7   F583         MOV     DPH,A
   \   0001B9   D0E0         POP     A
   \   0001BB   F0           MOVX    @DPTR,A
   2523                pList->superFrameOrder = (*msg++ >> 4) & 0x0F;
   \   0001BC   8E82         MOV     DPL,R6
   \   0001BE   8F83         MOV     DPH,R7
   \   0001C0   E0           MOVX    A,@DPTR
   \   0001C1   C4           SWAP    A
   \   0001C2   540F         ANL     A,#0xf
   \   0001C4   C0E0         PUSH    A
   \   0001C6   E5..         MOV     A,?V0 + 0
   \   0001C8   240E         ADD     A,#0xe
   \   0001CA   F582         MOV     DPL,A
   \   0001CC   E5..         MOV     A,?V0 + 1
   \   0001CE   3400         ADDC    A,#0x0
   \   0001D0   F583         MOV     DPH,A
   \   0001D2   D0E0         POP     A
   \   0001D4   F0           MOVX    @DPTR,A
   \   0001D5   8E82         MOV     DPL,R6
   \   0001D7   8F83         MOV     DPH,R7
   \   0001D9   A3           INC     DPTR
   \   0001DA   AE82         MOV     R6,DPL
   \   0001DC   AF83         MOV     R7,DPH
   2524                pList->permitJoining = *msg++;
   \   0001DE   8E82         MOV     DPL,R6
   \   0001E0   8F83         MOV     DPH,R7
   \   0001E2   E0           MOVX    A,@DPTR
   \   0001E3   C0E0         PUSH    A
   \   0001E5   E5..         MOV     A,?V0 + 0
   \   0001E7   240F         ADD     A,#0xf
   \   0001E9   F582         MOV     DPL,A
   \   0001EB   E5..         MOV     A,?V0 + 1
   \   0001ED   3400         ADDC    A,#0x0
   \   0001EF   F583         MOV     DPH,A
   \   0001F1   D0E0         POP     A
   \   0001F3   F0           MOVX    @DPTR,A
   \   0001F4   8E82         MOV     DPL,R6
   \   0001F6   8F83         MOV     DPH,R7
   \   0001F8   A3           INC     DPTR
   \   0001F9   AE82         MOV     R6,DPL
   \   0001FB   AF83         MOV     R7,DPH
   2525                pList++;
   \   0001FD   E5..         MOV     A,?V0 + 0
   \   0001FF   2410         ADD     A,#0x10
   \   000201   F5..         MOV     ?V0 + 0,A
   \   000203   E5..         MOV     A,?V0 + 1
   \   000205   3400         ADDC    A,#0x0
   \   000207   F5..         MOV     ?V0 + 1,A
   2526              }
   \   000209   05..         INC     ?V0 + 5
   \   00020B   02....       LJMP    ??ZDO_ParseMgmNwkDiscRsp_3 & 0xFFFF
   2527            }
   2528          
   2529            return ( pRsp );
   \                     ??ZDO_ParseMgmNwkDiscRsp_2:
   \   00020E   AA..         MOV     R2,?V0 + 6
   \   000210   AB..         MOV     R3,?V0 + 7
   \   000212   7403         MOV     A,#0x3
   \   000214   12....       LCALL   ?DEALLOC_XSTACK8
   \   000217   7F08         MOV     R7,#0x8
   \   000219   02....       LJMP    ?BANKED_LEAVE_XDATA
   2530          }
   2531          
   2532          /*********************************************************************
   2533           * @fn          ZDO_ParseMgmtRtgRsp
   2534           *
   2535           * @brief       This function parses the incoming Management
   2536           *              Routing response.
   2537           *
   2538           * @param       inMsg - incoming message
   2539           *
   2540           * @return      a pointer to parsed response structure (NULL if not allocated).
   2541           *          This structure was allocated using osal_mem_alloc, so it must be freed
   2542           *          by the calling function [osal_mem_free()].
   2543           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   2544          ZDO_MgmtRtgRsp_t *ZDO_ParseMgmtRtgRsp( zdoIncomingMsg_t *inMsg )
   \                     ZDO_ParseMgmtRtgRsp:
   2545          {
   \   000000   74F0         MOV     A,#-0x10
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 16
   \   000005                ; Auto size: 2
   \   000005   74FE         MOV     A,#-0x2
   \   000007   12....       LCALL   ?ALLOC_XSTACK8
   \   00000A   85..82       MOV     DPL,?XSP + 0
   \   00000D   85..83       MOV     DPH,?XSP + 1
   \   000010   EA           MOV     A,R2
   \   000011   F0           MOVX    @DPTR,A
   \   000012   A3           INC     DPTR
   \   000013   EB           MOV     A,R3
   \   000014   F0           MOVX    @DPTR,A
   2546            ZDO_MgmtRtgRsp_t *pRsp;
   2547            uint8 status;
   2548            uint8 rtgCount = 0;
   \   000015   75..00       MOV     ?V0 + 2,#0x0
   2549            uint8 startIndex = 0;
   \   000018   75..00       MOV     ?V0 + 3,#0x0
   2550            uint8 rtgListCount = 0;
   \   00001B   75..00       MOV     ?V0 + 4,#0x0
   2551            uint8 *msg;
   2552          
   2553            msg = inMsg->asdu;
   \   00001E   85..82       MOV     DPL,?XSP + 0
   \   000021   85..83       MOV     DPH,?XSP + 1
   \   000024   E0           MOVX    A,@DPTR
   \   000025   2411         ADD     A,#0x11
   \   000027   F8           MOV     R0,A
   \   000028   A3           INC     DPTR
   \   000029   E0           MOVX    A,@DPTR
   \   00002A   3400         ADDC    A,#0x0
   \   00002C   F9           MOV     R1,A
   \   00002D   8882         MOV     DPL,R0
   \   00002F   8983         MOV     DPH,R1
   \   000031   E0           MOVX    A,@DPTR
   \   000032   F8           MOV     R0,A
   \   000033   A3           INC     DPTR
   \   000034   E0           MOVX    A,@DPTR
   \   000035   F9           MOV     R1,A
   \   000036   E8           MOV     A,R0
   \   000037   FE           MOV     R6,A
   \   000038   E9           MOV     A,R1
   \   000039   FF           MOV     R7,A
   2554          
   2555            status = *msg++;
   \   00003A   8E82         MOV     DPL,R6
   \   00003C   8F83         MOV     DPH,R7
   \   00003E   E0           MOVX    A,@DPTR
   \   00003F   F5..         MOV     ?V0 + 5,A
   \   000041   8E82         MOV     DPL,R6
   \   000043   8F83         MOV     DPH,R7
   \   000045   A3           INC     DPTR
   \   000046   AE82         MOV     R6,DPL
   \   000048   AF83         MOV     R7,DPH
   2556            if ( status == ZSuccess )
   \   00004A   E5..         MOV     A,?V0 + 5
   \   00004C   7030         JNZ     ??ZDO_ParseMgmtRtgRsp_0
   2557            {
   2558              rtgCount = *msg++;
   \   00004E   8E82         MOV     DPL,R6
   \   000050   8F83         MOV     DPH,R7
   \   000052   E0           MOVX    A,@DPTR
   \   000053   F5..         MOV     ?V0 + 2,A
   \   000055   8E82         MOV     DPL,R6
   \   000057   8F83         MOV     DPH,R7
   \   000059   A3           INC     DPTR
   \   00005A   AE82         MOV     R6,DPL
   \   00005C   AF83         MOV     R7,DPH
   2559              startIndex = *msg++;
   \   00005E   8E82         MOV     DPL,R6
   \   000060   8F83         MOV     DPH,R7
   \   000062   E0           MOVX    A,@DPTR
   \   000063   F5..         MOV     ?V0 + 3,A
   \   000065   8E82         MOV     DPL,R6
   \   000067   8F83         MOV     DPH,R7
   \   000069   A3           INC     DPTR
   \   00006A   AE82         MOV     R6,DPL
   \   00006C   AF83         MOV     R7,DPH
   2560              rtgListCount = *msg++;
   \   00006E   8E82         MOV     DPL,R6
   \   000070   8F83         MOV     DPH,R7
   \   000072   E0           MOVX    A,@DPTR
   \   000073   F5..         MOV     ?V0 + 4,A
   \   000075   8E82         MOV     DPL,R6
   \   000077   8F83         MOV     DPH,R7
   \   000079   A3           INC     DPTR
   \   00007A   AE82         MOV     R6,DPL
   \   00007C   AF83         MOV     R7,DPH
   2561            }
   2562          
   2563            // Allocate a buffer big enough to handle the list
   2564            pRsp = (ZDO_MgmtRtgRsp_t *)osal_mem_alloc(
   2565                    sizeof( ZDO_MgmtRtgRsp_t ) + (rtgListCount * sizeof( rtgItem_t )) );
   \                     ??ZDO_ParseMgmtRtgRsp_0:
   \   00007E                ; Setup parameters for call to function osal_mem_alloc
   \   00007E   A8..         MOV     R0,?V0 + 4
   \   000080   7900         MOV     R1,#0x0
   \   000082   E8           MOV     A,R0
   \   000083   75F006       MOV     B,#0x6
   \   000086   A4           MUL     AB
   \   000087   C8           XCH     A,R0
   \   000088   AAF0         MOV     R2,B
   \   00008A   75F000       MOV     B,#0x0
   \   00008D   A4           MUL     AB
   \   00008E   2A           ADD     A,R2
   \   00008F   FA           MOV     R2,A
   \   000090   75F006       MOV     B,#0x6
   \   000093   E9           MOV     A,R1
   \   000094   A4           MUL     AB
   \   000095   2A           ADD     A,R2
   \   000096   F9           MOV     R1,A
   \   000097   7404         MOV     A,#0x4
   \   000099   28           ADD     A,R0
   \   00009A   FA           MOV     R2,A
   \   00009B   7400         MOV     A,#0x0
   \   00009D   39           ADDC    A,R1
   \   00009E   FB           MOV     R3,A
   \   00009F   12....       LCALL   ??osal_mem_alloc?relay
   \   0000A2   8A..         MOV     ?V0 + 0,R2
   \   0000A4   8B..         MOV     ?V0 + 1,R3
   \   0000A6   85....       MOV     ?V0 + 6,?V0 + 0
   \   0000A9   85....       MOV     ?V0 + 7,?V0 + 1
   2566            if ( pRsp )
   \   0000AC   E5..         MOV     A,?V0 + 6
   \   0000AE   6400         XRL     A,#0x0
   \   0000B0   7004         JNZ     ??ZDO_ParseMgmtRtgRsp_1
   \   0000B2   E5..         MOV     A,?V0 + 7
   \   0000B4   6400         XRL     A,#0x0
   \                     ??ZDO_ParseMgmtRtgRsp_1:
   \   0000B6   7003         JNZ     $+5
   \   0000B8   02....       LJMP    ??ZDO_ParseMgmtRtgRsp_2 & 0xFFFF
   2567            {
   2568              uint8 x;
   2569              rtgItem_t *pList = pRsp->list;
   \   0000BB   E5..         MOV     A,?V0 + 6
   \   0000BD   2404         ADD     A,#0x4
   \   0000BF   F8           MOV     R0,A
   \   0000C0   E5..         MOV     A,?V0 + 7
   \   0000C2   3400         ADDC    A,#0x0
   \   0000C4   F9           MOV     R1,A
   \   0000C5   E8           MOV     A,R0
   \   0000C6   FA           MOV     R2,A
   \   0000C7   E9           MOV     A,R1
   \   0000C8   FB           MOV     R3,A
   2570              pRsp->status = status;
   \   0000C9   85..82       MOV     DPL,?V0 + 6
   \   0000CC   85..83       MOV     DPH,?V0 + 7
   \   0000CF   E5..         MOV     A,?V0 + 5
   \   0000D1   F0           MOVX    @DPTR,A
   2571              pRsp->rtgCount = rtgCount;
   \   0000D2   85..82       MOV     DPL,?V0 + 6
   \   0000D5   85..83       MOV     DPH,?V0 + 7
   \   0000D8   A3           INC     DPTR
   \   0000D9   E5..         MOV     A,?V0 + 2
   \   0000DB   F0           MOVX    @DPTR,A
   2572              pRsp->startIndex = startIndex;
   \   0000DC   85..82       MOV     DPL,?V0 + 6
   \   0000DF   85..83       MOV     DPH,?V0 + 7
   \   0000E2   A3           INC     DPTR
   \   0000E3   A3           INC     DPTR
   \   0000E4   E5..         MOV     A,?V0 + 3
   \   0000E6   F0           MOVX    @DPTR,A
   2573              pRsp->rtgListCount = rtgListCount;
   \   0000E7   85..82       MOV     DPL,?V0 + 6
   \   0000EA   85..83       MOV     DPH,?V0 + 7
   \   0000ED   A3           INC     DPTR
   \   0000EE   A3           INC     DPTR
   \   0000EF   A3           INC     DPTR
   \   0000F0   E5..         MOV     A,?V0 + 4
   \   0000F2   F0           MOVX    @DPTR,A
   2574          
   2575              for ( x = 0; x < rtgListCount; x++ )
   \   0000F3   75..00       MOV     ?V0 + 0,#0x0
   \                     ??ZDO_ParseMgmtRtgRsp_3:
   \   0000F6   E5..         MOV     A,?V0 + 0
   \   0000F8   C3           CLR     C
   \   0000F9   95..         SUBB    A,?V0 + 4
   \   0000FB   5078         JNC     ??ZDO_ParseMgmtRtgRsp_2
   2576              {
   2577                pList->dstAddress = BUILD_UINT16( msg[0], msg[1] );
   \   0000FD   8E82         MOV     DPL,R6
   \   0000FF   8F83         MOV     DPH,R7
   \   000101   E0           MOVX    A,@DPTR
   \   000102   F8           MOV     R0,A
   \   000103   7900         MOV     R1,#0x0
   \   000105   8E82         MOV     DPL,R6
   \   000107   8F83         MOV     DPH,R7
   \   000109   A3           INC     DPTR
   \   00010A   E0           MOVX    A,@DPTR
   \   00010B   FC           MOV     R4,A
   \   00010C   E4           CLR     A
   \   00010D   CC           XCH     A,R4
   \   00010E   FD           MOV     R5,A
   \   00010F   EC           MOV     A,R4
   \   000110   28           ADD     A,R0
   \   000111   F8           MOV     R0,A
   \   000112   ED           MOV     A,R5
   \   000113   39           ADDC    A,R1
   \   000114   F9           MOV     R1,A
   \   000115   8A82         MOV     DPL,R2
   \   000117   8B83         MOV     DPH,R3
   \   000119   E8           MOV     A,R0
   \   00011A   F0           MOVX    @DPTR,A
   \   00011B   A3           INC     DPTR
   \   00011C   E9           MOV     A,R1
   \   00011D   F0           MOVX    @DPTR,A
   2578                msg += 2;
   \   00011E   EE           MOV     A,R6
   \   00011F   2402         ADD     A,#0x2
   \   000121   FE           MOV     R6,A
   \   000122   EF           MOV     A,R7
   \   000123   3400         ADDC    A,#0x0
   \   000125   FF           MOV     R7,A
   2579                pList->status = *msg++;
   \   000126   8E82         MOV     DPL,R6
   \   000128   8F83         MOV     DPH,R7
   \   00012A   E0           MOVX    A,@DPTR
   \   00012B   8A82         MOV     DPL,R2
   \   00012D   8B83         MOV     DPH,R3
   \   00012F   A3           INC     DPTR
   \   000130   A3           INC     DPTR
   \   000131   A3           INC     DPTR
   \   000132   A3           INC     DPTR
   \   000133   A3           INC     DPTR
   \   000134   F0           MOVX    @DPTR,A
   \   000135   8E82         MOV     DPL,R6
   \   000137   8F83         MOV     DPH,R7
   \   000139   A3           INC     DPTR
   \   00013A   AE82         MOV     R6,DPL
   \   00013C   AF83         MOV     R7,DPH
   2580                pList->nextHopAddress = BUILD_UINT16( msg[0], msg[1] );
   \   00013E   8E82         MOV     DPL,R6
   \   000140   8F83         MOV     DPH,R7
   \   000142   E0           MOVX    A,@DPTR
   \   000143   F8           MOV     R0,A
   \   000144   7900         MOV     R1,#0x0
   \   000146   8E82         MOV     DPL,R6
   \   000148   8F83         MOV     DPH,R7
   \   00014A   A3           INC     DPTR
   \   00014B   E0           MOVX    A,@DPTR
   \   00014C   FC           MOV     R4,A
   \   00014D   E4           CLR     A
   \   00014E   CC           XCH     A,R4
   \   00014F   FD           MOV     R5,A
   \   000150   EC           MOV     A,R4
   \   000151   28           ADD     A,R0
   \   000152   F8           MOV     R0,A
   \   000153   ED           MOV     A,R5
   \   000154   39           ADDC    A,R1
   \   000155   F9           MOV     R1,A
   \   000156   8A82         MOV     DPL,R2
   \   000158   8B83         MOV     DPH,R3
   \   00015A   A3           INC     DPTR
   \   00015B   A3           INC     DPTR
   \   00015C   E8           MOV     A,R0
   \   00015D   F0           MOVX    @DPTR,A
   \   00015E   A3           INC     DPTR
   \   00015F   E9           MOV     A,R1
   \   000160   F0           MOVX    @DPTR,A
   2581                msg += 2;
   \   000161   EE           MOV     A,R6
   \   000162   2402         ADD     A,#0x2
   \   000164   FE           MOV     R6,A
   \   000165   EF           MOV     A,R7
   \   000166   3400         ADDC    A,#0x0
   \   000168   FF           MOV     R7,A
   2582                pList++;
   \   000169   EA           MOV     A,R2
   \   00016A   2406         ADD     A,#0x6
   \   00016C   FA           MOV     R2,A
   \   00016D   EB           MOV     A,R3
   \   00016E   3400         ADDC    A,#0x0
   \   000170   FB           MOV     R3,A
   2583              }
   \   000171   05..         INC     ?V0 + 0
   \   000173   8081         SJMP    ??ZDO_ParseMgmtRtgRsp_3
   2584            }
   2585          
   2586            return ( pRsp );
   \                     ??ZDO_ParseMgmtRtgRsp_2:
   \   000175   AA..         MOV     R2,?V0 + 6
   \   000177   AB..         MOV     R3,?V0 + 7
   \   000179   7402         MOV     A,#0x2
   \   00017B   12....       LCALL   ?DEALLOC_XSTACK8
   \   00017E   7F08         MOV     R7,#0x8
   \   000180   02....       LJMP    ?BANKED_LEAVE_XDATA
   2587          }
   2588          
   2589          /*********************************************************************
   2590           * @fn          ZDO_ParseMgmtBindRsp
   2591           *
   2592           * @brief       This function parses the incoming Management
   2593           *              Binding response.
   2594           *
   2595           * @param       inMsg - pointer to message to parse
   2596           *
   2597           * @return      a pointer to parsed response structure (NULL if not allocated).
   2598           *          This structure was allocated using osal_mem_alloc, so it must be freed
   2599           *          by the calling function [osal_mem_free()].
   2600           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   2601          ZDO_MgmtBindRsp_t *ZDO_ParseMgmtBindRsp( zdoIncomingMsg_t *inMsg )
   \                     ZDO_ParseMgmtBindRsp:
   2602          {
   \   000000   74F0         MOV     A,#-0x10
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 16
   \   000005                ; Auto size: 3
   \   000005   74FD         MOV     A,#-0x3
   \   000007   12....       LCALL   ?ALLOC_XSTACK8
   \   00000A   7401         MOV     A,#0x1
   \   00000C   12....       LCALL   ?XSTACK_DISP0_8
   \   00000F   EA           MOV     A,R2
   \   000010   F0           MOVX    @DPTR,A
   \   000011   A3           INC     DPTR
   \   000012   EB           MOV     A,R3
   \   000013   F0           MOVX    @DPTR,A
   2603            ZDO_MgmtBindRsp_t *pRsp;
   2604            uint8 status;
   2605            uint8 bindingCount = 0;
   \   000014   75..00       MOV     ?V0 + 4,#0x0
   2606            uint8 startIndex = 0;
   \   000017   75..00       MOV     ?V0 + 3,#0x0
   2607            uint8 bindingListCount = 0;
   \   00001A   75..00       MOV     ?V0 + 2,#0x0
   2608            uint8 *msg;
   2609          
   2610            msg = inMsg->asdu;
   \   00001D   7401         MOV     A,#0x1
   \   00001F   12....       LCALL   ?XSTACK_DISP0_8
   \   000022   E0           MOVX    A,@DPTR
   \   000023   2411         ADD     A,#0x11
   \   000025   F8           MOV     R0,A
   \   000026   A3           INC     DPTR
   \   000027   E0           MOVX    A,@DPTR
   \   000028   3400         ADDC    A,#0x0
   \   00002A   F9           MOV     R1,A
   \   00002B   8882         MOV     DPL,R0
   \   00002D   8983         MOV     DPH,R1
   \   00002F   E0           MOVX    A,@DPTR
   \   000030   F8           MOV     R0,A
   \   000031   A3           INC     DPTR
   \   000032   E0           MOVX    A,@DPTR
   \   000033   F9           MOV     R1,A
   \   000034   E8           MOV     A,R0
   \   000035   FE           MOV     R6,A
   \   000036   E9           MOV     A,R1
   \   000037   FF           MOV     R7,A
   2611          
   2612            status = *msg++;
   \   000038   8E82         MOV     DPL,R6
   \   00003A   8F83         MOV     DPH,R7
   \   00003C   E0           MOVX    A,@DPTR
   \   00003D   85..82       MOV     DPL,?XSP + 0
   \   000040   85..83       MOV     DPH,?XSP + 1
   \   000043   F0           MOVX    @DPTR,A
   \   000044   8E82         MOV     DPL,R6
   \   000046   8F83         MOV     DPH,R7
   \   000048   A3           INC     DPTR
   \   000049   AE82         MOV     R6,DPL
   \   00004B   AF83         MOV     R7,DPH
   2613            if ( status == ZSuccess )
   \   00004D   85..82       MOV     DPL,?XSP + 0
   \   000050   85..83       MOV     DPH,?XSP + 1
   \   000053   E0           MOVX    A,@DPTR
   \   000054   7030         JNZ     ??ZDO_ParseMgmtBindRsp_0
   2614            {
   2615              bindingCount = *msg++;
   \   000056   8E82         MOV     DPL,R6
   \   000058   8F83         MOV     DPH,R7
   \   00005A   E0           MOVX    A,@DPTR
   \   00005B   F5..         MOV     ?V0 + 4,A
   \   00005D   8E82         MOV     DPL,R6
   \   00005F   8F83         MOV     DPH,R7
   \   000061   A3           INC     DPTR
   \   000062   AE82         MOV     R6,DPL
   \   000064   AF83         MOV     R7,DPH
   2616              startIndex = *msg++;
   \   000066   8E82         MOV     DPL,R6
   \   000068   8F83         MOV     DPH,R7
   \   00006A   E0           MOVX    A,@DPTR
   \   00006B   F5..         MOV     ?V0 + 3,A
   \   00006D   8E82         MOV     DPL,R6
   \   00006F   8F83         MOV     DPH,R7
   \   000071   A3           INC     DPTR
   \   000072   AE82         MOV     R6,DPL
   \   000074   AF83         MOV     R7,DPH
   2617              bindingListCount = *msg++;
   \   000076   8E82         MOV     DPL,R6
   \   000078   8F83         MOV     DPH,R7
   \   00007A   E0           MOVX    A,@DPTR
   \   00007B   F5..         MOV     ?V0 + 2,A
   \   00007D   8E82         MOV     DPL,R6
   \   00007F   8F83         MOV     DPH,R7
   \   000081   A3           INC     DPTR
   \   000082   AE82         MOV     R6,DPL
   \   000084   AF83         MOV     R7,DPH
   2618            }
   2619          
   2620            // Allocate a buffer big enough to handle the list
   2621            pRsp = (ZDO_MgmtBindRsp_t *)osal_mem_alloc(
   2622                    (sizeof ( ZDO_MgmtBindRsp_t ) + (bindingListCount * sizeof( apsBindingItem_t ))) );
   \                     ??ZDO_ParseMgmtBindRsp_0:
   \   000086                ; Setup parameters for call to function osal_mem_alloc
   \   000086   A8..         MOV     R0,?V0 + 2
   \   000088   7900         MOV     R1,#0x0
   \   00008A   E8           MOV     A,R0
   \   00008B   75F015       MOV     B,#0x15
   \   00008E   A4           MUL     AB
   \   00008F   C8           XCH     A,R0
   \   000090   AAF0         MOV     R2,B
   \   000092   75F000       MOV     B,#0x0
   \   000095   A4           MUL     AB
   \   000096   2A           ADD     A,R2
   \   000097   FA           MOV     R2,A
   \   000098   75F015       MOV     B,#0x15
   \   00009B   E9           MOV     A,R1
   \   00009C   A4           MUL     AB
   \   00009D   2A           ADD     A,R2
   \   00009E   F9           MOV     R1,A
   \   00009F   7404         MOV     A,#0x4
   \   0000A1   28           ADD     A,R0
   \   0000A2   FA           MOV     R2,A
   \   0000A3   7400         MOV     A,#0x0
   \   0000A5   39           ADDC    A,R1
   \   0000A6   FB           MOV     R3,A
   \   0000A7   12....       LCALL   ??osal_mem_alloc?relay
   \   0000AA   8A..         MOV     ?V0 + 0,R2
   \   0000AC   8B..         MOV     ?V0 + 1,R3
   \   0000AE   85....       MOV     ?V0 + 6,?V0 + 0
   \   0000B1   85....       MOV     ?V0 + 7,?V0 + 1
   2623            if ( pRsp )
   \   0000B4   E5..         MOV     A,?V0 + 6
   \   0000B6   6400         XRL     A,#0x0
   \   0000B8   7004         JNZ     ??ZDO_ParseMgmtBindRsp_1
   \   0000BA   E5..         MOV     A,?V0 + 7
   \   0000BC   6400         XRL     A,#0x0
   \                     ??ZDO_ParseMgmtBindRsp_1:
   \   0000BE   7003         JNZ     $+5
   \   0000C0   02....       LJMP    ??ZDO_ParseMgmtBindRsp_2 & 0xFFFF
   2624            {
   2625              uint8 x;
   2626              apsBindingItem_t *pList = pRsp->list;
   \   0000C3   E5..         MOV     A,?V0 + 6
   \   0000C5   2404         ADD     A,#0x4
   \   0000C7   F8           MOV     R0,A
   \   0000C8   E5..         MOV     A,?V0 + 7
   \   0000CA   3400         ADDC    A,#0x0
   \   0000CC   F9           MOV     R1,A
   \   0000CD   88..         MOV     ?V0 + 0,R0
   \   0000CF   89..         MOV     ?V0 + 1,R1
   2627              pRsp->status = status;
   \   0000D1   85..82       MOV     DPL,?XSP + 0
   \   0000D4   85..83       MOV     DPH,?XSP + 1
   \   0000D7   E0           MOVX    A,@DPTR
   \   0000D8   85..82       MOV     DPL,?V0 + 6
   \   0000DB   85..83       MOV     DPH,?V0 + 7
   \   0000DE   F0           MOVX    @DPTR,A
   2628              pRsp->bindingCount = bindingCount;
   \   0000DF   85..82       MOV     DPL,?V0 + 6
   \   0000E2   85..83       MOV     DPH,?V0 + 7
   \   0000E5   A3           INC     DPTR
   \   0000E6   E5..         MOV     A,?V0 + 4
   \   0000E8   F0           MOVX    @DPTR,A
   2629              pRsp->startIndex = startIndex;
   \   0000E9   85..82       MOV     DPL,?V0 + 6
   \   0000EC   85..83       MOV     DPH,?V0 + 7
   \   0000EF   A3           INC     DPTR
   \   0000F0   A3           INC     DPTR
   \   0000F1   E5..         MOV     A,?V0 + 3
   \   0000F3   F0           MOVX    @DPTR,A
   2630              pRsp->bindingListCount = bindingListCount;
   \   0000F4   85..82       MOV     DPL,?V0 + 6
   \   0000F7   85..83       MOV     DPH,?V0 + 7
   \   0000FA   A3           INC     DPTR
   \   0000FB   A3           INC     DPTR
   \   0000FC   A3           INC     DPTR
   \   0000FD   E5..         MOV     A,?V0 + 2
   \   0000FF   F0           MOVX    @DPTR,A
   2631          
   2632              for ( x = 0; x < bindingListCount; x++ )
   \   000100   75..00       MOV     ?V0 + 5,#0x0
   \                     ??ZDO_ParseMgmtBindRsp_3:
   \   000103   E5..         MOV     A,?V0 + 5
   \   000105   C3           CLR     C
   \   000106   95..         SUBB    A,?V0 + 2
   \   000108   4003         JC      $+5
   \   00010A   02....       LJMP    ??ZDO_ParseMgmtBindRsp_2 & 0xFFFF
   2633              {
   2634                osal_cpyExtAddr( pList->srcAddr, msg );
   \   00010D                ; Setup parameters for call to function osal_cpyExtAddr
   \   00010D   EE           MOV     A,R6
   \   00010E   FC           MOV     R4,A
   \   00010F   EF           MOV     A,R7
   \   000110   FD           MOV     R5,A
   \   000111   AA..         MOV     R2,?V0 + 0
   \   000113   AB..         MOV     R3,?V0 + 1
   \   000115   12....       LCALL   ??osal_cpyExtAddr?relay
   2635                msg += Z_EXTADDR_LEN;
   \   000118   EE           MOV     A,R6
   \   000119   2408         ADD     A,#0x8
   \   00011B   FE           MOV     R6,A
   \   00011C   EF           MOV     A,R7
   \   00011D   3400         ADDC    A,#0x0
   \   00011F   FF           MOV     R7,A
   2636                pList->srcEP = *msg++;
   \   000120   8E82         MOV     DPL,R6
   \   000122   8F83         MOV     DPH,R7
   \   000124   E0           MOVX    A,@DPTR
   \   000125   85..82       MOV     DPL,?V0 + 0
   \   000128   85..83       MOV     DPH,?V0 + 1
   \   00012B   A3           INC     DPTR
   \   00012C   A3           INC     DPTR
   \   00012D   A3           INC     DPTR
   \   00012E   A3           INC     DPTR
   \   00012F   A3           INC     DPTR
   \   000130   A3           INC     DPTR
   \   000131   A3           INC     DPTR
   \   000132   A3           INC     DPTR
   \   000133   F0           MOVX    @DPTR,A
   \   000134   8E82         MOV     DPL,R6
   \   000136   8F83         MOV     DPH,R7
   \   000138   A3           INC     DPTR
   \   000139   AE82         MOV     R6,DPL
   \   00013B   AF83         MOV     R7,DPH
   2637          
   2638                // Get the Cluster ID
   2639          
   2640                pList->clusterID = BUILD_UINT16( msg[0], msg[1] );
   \   00013D   8E82         MOV     DPL,R6
   \   00013F   8F83         MOV     DPH,R7
   \   000141   E0           MOVX    A,@DPTR
   \   000142   F8           MOV     R0,A
   \   000143   7900         MOV     R1,#0x0
   \   000145   8E82         MOV     DPL,R6
   \   000147   8F83         MOV     DPH,R7
   \   000149   A3           INC     DPTR
   \   00014A   E0           MOVX    A,@DPTR
   \   00014B   FA           MOV     R2,A
   \   00014C   E4           CLR     A
   \   00014D   CA           XCH     A,R2
   \   00014E   FB           MOV     R3,A
   \   00014F   EA           MOV     A,R2
   \   000150   28           ADD     A,R0
   \   000151   F8           MOV     R0,A
   \   000152   EB           MOV     A,R3
   \   000153   39           ADDC    A,R1
   \   000154   F9           MOV     R1,A
   \   000155   85..82       MOV     DPL,?V0 + 0
   \   000158   85..83       MOV     DPH,?V0 + 1
   \   00015B   A3           INC     DPTR
   \   00015C   A3           INC     DPTR
   \   00015D   A3           INC     DPTR
   \   00015E   A3           INC     DPTR
   \   00015F   A3           INC     DPTR
   \   000160   A3           INC     DPTR
   \   000161   A3           INC     DPTR
   \   000162   A3           INC     DPTR
   \   000163   A3           INC     DPTR
   \   000164   E8           MOV     A,R0
   \   000165   F0           MOVX    @DPTR,A
   \   000166   A3           INC     DPTR
   \   000167   E9           MOV     A,R1
   \   000168   F0           MOVX    @DPTR,A
   2641                msg += 2;
   \   000169   EE           MOV     A,R6
   \   00016A   2402         ADD     A,#0x2
   \   00016C   FE           MOV     R6,A
   \   00016D   EF           MOV     A,R7
   \   00016E   3400         ADDC    A,#0x0
   \   000170   FF           MOV     R7,A
   2642                pList->dstAddr.addrMode = *msg++;
   \   000171   8E82         MOV     DPL,R6
   \   000173   8F83         MOV     DPH,R7
   \   000175   E0           MOVX    A,@DPTR
   \   000176   C0E0         PUSH    A
   \   000178   E5..         MOV     A,?V0 + 0
   \   00017A   2413         ADD     A,#0x13
   \   00017C   F582         MOV     DPL,A
   \   00017E   E5..         MOV     A,?V0 + 1
   \   000180   3400         ADDC    A,#0x0
   \   000182   F583         MOV     DPH,A
   \   000184   D0E0         POP     A
   \   000186   F0           MOVX    @DPTR,A
   \   000187   8E82         MOV     DPL,R6
   \   000189   8F83         MOV     DPH,R7
   \   00018B   A3           INC     DPTR
   \   00018C   AE82         MOV     R6,DPL
   \   00018E   AF83         MOV     R7,DPH
   2643                if ( pList->dstAddr.addrMode == Addr64Bit )
   \   000190   E5..         MOV     A,?V0 + 0
   \   000192   2413         ADD     A,#0x13
   \   000194   F582         MOV     DPL,A
   \   000196   E5..         MOV     A,?V0 + 1
   \   000198   3400         ADDC    A,#0x0
   \   00019A   F583         MOV     DPH,A
   \   00019C   E0           MOVX    A,@DPTR
   \   00019D   6403         XRL     A,#0x3
   \   00019F   703A         JNZ     ??ZDO_ParseMgmtBindRsp_4
   2644                {
   2645                  osal_cpyExtAddr( pList->dstAddr.addr.extAddr, msg );
   \   0001A1                ; Setup parameters for call to function osal_cpyExtAddr
   \   0001A1   EE           MOV     A,R6
   \   0001A2   FC           MOV     R4,A
   \   0001A3   EF           MOV     A,R7
   \   0001A4   FD           MOV     R5,A
   \   0001A5   E5..         MOV     A,?V0 + 0
   \   0001A7   240B         ADD     A,#0xb
   \   0001A9   FA           MOV     R2,A
   \   0001AA   E5..         MOV     A,?V0 + 1
   \   0001AC   3400         ADDC    A,#0x0
   \   0001AE   FB           MOV     R3,A
   \   0001AF   12....       LCALL   ??osal_cpyExtAddr?relay
   2646                  msg += Z_EXTADDR_LEN;
   \   0001B2   EE           MOV     A,R6
   \   0001B3   2408         ADD     A,#0x8
   \   0001B5   FE           MOV     R6,A
   \   0001B6   EF           MOV     A,R7
   \   0001B7   3400         ADDC    A,#0x0
   \   0001B9   FF           MOV     R7,A
   2647                  pList->dstEP = *msg++;
   \   0001BA   8E82         MOV     DPL,R6
   \   0001BC   8F83         MOV     DPH,R7
   \   0001BE   E0           MOVX    A,@DPTR
   \   0001BF   C0E0         PUSH    A
   \   0001C1   E5..         MOV     A,?V0 + 0
   \   0001C3   2414         ADD     A,#0x14
   \   0001C5   F582         MOV     DPL,A
   \   0001C7   E5..         MOV     A,?V0 + 1
   \   0001C9   3400         ADDC    A,#0x0
   \   0001CB   F583         MOV     DPH,A
   \   0001CD   D0E0         POP     A
   \   0001CF   F0           MOVX    @DPTR,A
   \   0001D0   8E82         MOV     DPL,R6
   \   0001D2   8F83         MOV     DPH,R7
   \   0001D4   A3           INC     DPTR
   \   0001D5   AE82         MOV     R6,DPL
   \   0001D7   AF83         MOV     R7,DPH
   \   0001D9   8031         SJMP    ??ZDO_ParseMgmtBindRsp_5
   2648                }
   2649                else
   2650                {
   2651                  pList->dstAddr.addr.shortAddr = BUILD_UINT16( msg[0], msg[1] );
   \                     ??ZDO_ParseMgmtBindRsp_4:
   \   0001DB   8E82         MOV     DPL,R6
   \   0001DD   8F83         MOV     DPH,R7
   \   0001DF   E0           MOVX    A,@DPTR
   \   0001E0   F8           MOV     R0,A
   \   0001E1   7900         MOV     R1,#0x0
   \   0001E3   8E82         MOV     DPL,R6
   \   0001E5   8F83         MOV     DPH,R7
   \   0001E7   A3           INC     DPTR
   \   0001E8   E0           MOVX    A,@DPTR
   \   0001E9   FA           MOV     R2,A
   \   0001EA   E4           CLR     A
   \   0001EB   CA           XCH     A,R2
   \   0001EC   FB           MOV     R3,A
   \   0001ED   EA           MOV     A,R2
   \   0001EE   28           ADD     A,R0
   \   0001EF   F8           MOV     R0,A
   \   0001F0   EB           MOV     A,R3
   \   0001F1   39           ADDC    A,R1
   \   0001F2   F9           MOV     R1,A
   \   0001F3   E5..         MOV     A,?V0 + 0
   \   0001F5   240B         ADD     A,#0xb
   \   0001F7   F582         MOV     DPL,A
   \   0001F9   E5..         MOV     A,?V0 + 1
   \   0001FB   3400         ADDC    A,#0x0
   \   0001FD   F583         MOV     DPH,A
   \   0001FF   E8           MOV     A,R0
   \   000200   F0           MOVX    @DPTR,A
   \   000201   A3           INC     DPTR
   \   000202   E9           MOV     A,R1
   \   000203   F0           MOVX    @DPTR,A
   2652                  msg += 2;
   \   000204   EE           MOV     A,R6
   \   000205   2402         ADD     A,#0x2
   \   000207   FE           MOV     R6,A
   \   000208   EF           MOV     A,R7
   \   000209   3400         ADDC    A,#0x0
   \   00020B   FF           MOV     R7,A
   2653                }
   2654          
   2655                pList++;
   \                     ??ZDO_ParseMgmtBindRsp_5:
   \   00020C   E5..         MOV     A,?V0 + 0
   \   00020E   2415         ADD     A,#0x15
   \   000210   F5..         MOV     ?V0 + 0,A
   \   000212   E5..         MOV     A,?V0 + 1
   \   000214   3400         ADDC    A,#0x0
   \   000216   F5..         MOV     ?V0 + 1,A
   2656              }
   \   000218   05..         INC     ?V0 + 5
   \   00021A   02....       LJMP    ??ZDO_ParseMgmtBindRsp_3 & 0xFFFF
   2657            }
   2658          
   2659            return ( pRsp );
   \                     ??ZDO_ParseMgmtBindRsp_2:
   \   00021D   AA..         MOV     R2,?V0 + 6
   \   00021F   AB..         MOV     R3,?V0 + 7
   \   000221   7403         MOV     A,#0x3
   \   000223   12....       LCALL   ?DEALLOC_XSTACK8
   \   000226   7F08         MOV     R7,#0x8
   \   000228   02....       LJMP    ?BANKED_LEAVE_XDATA
   2660          }
   2661          
   2662          /*********************************************************************
   2663           * @fn          ZDO_ParseUserDescRsp
   2664           *
   2665           * @brief       This function parses the incoming User
   2666           *              Descriptor Response.
   2667           *
   2668           * @param       inMsg - incoming response message
   2669           *
   2670           * @return      a pointer to parsed response structure (NULL if not allocated).
   2671           *          This structure was allocated using osal_mem_alloc, so it must be freed
   2672           *          by the calling function [osal_mem_free()].
   2673           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   2674          ZDO_UserDescRsp_t *ZDO_ParseUserDescRsp( zdoIncomingMsg_t *inMsg )
   \                     ZDO_ParseUserDescRsp:
   2675          {
   \   000000   74F0         MOV     A,#-0x10
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 16
   \   000005                ; Auto size: 0
   \   000005   8A..         MOV     ?V0 + 6,R2
   \   000007   8B..         MOV     ?V0 + 7,R3
   2676            ZDO_UserDescRsp_t *pRsp;
   2677            uint8 *msg;
   2678            uint8 descLen = 0;
   \   000009   75..00       MOV     ?V0 + 3,#0x0
   2679          
   2680            msg = inMsg->asdu;
   \   00000C   E5..         MOV     A,?V0 + 6
   \   00000E   2411         ADD     A,#0x11
   \   000010   F582         MOV     DPL,A
   \   000012   E5..         MOV     A,?V0 + 7
   \   000014   3400         ADDC    A,#0x0
   \   000016   F583         MOV     DPH,A
   \   000018   E0           MOVX    A,@DPTR
   \   000019   F8           MOV     R0,A
   \   00001A   A3           INC     DPTR
   \   00001B   E0           MOVX    A,@DPTR
   \   00001C   F9           MOV     R1,A
   \   00001D   E8           MOV     A,R0
   \   00001E   FE           MOV     R6,A
   \   00001F   E9           MOV     A,R1
   \   000020   FF           MOV     R7,A
   2681          
   2682            if ( msg[0] == ZSuccess )
   \   000021   8E82         MOV     DPL,R6
   \   000023   8F83         MOV     DPH,R7
   \   000025   E0           MOVX    A,@DPTR
   \   000026   700A         JNZ     ??ZDO_ParseUserDescRsp_0
   2683              descLen = msg[3];
   \   000028   8E82         MOV     DPL,R6
   \   00002A   8F83         MOV     DPH,R7
   \   00002C   A3           INC     DPTR
   \   00002D   A3           INC     DPTR
   \   00002E   A3           INC     DPTR
   \   00002F   E0           MOVX    A,@DPTR
   \   000030   F5..         MOV     ?V0 + 3,A
   2684          
   2685            pRsp = (ZDO_UserDescRsp_t *)osal_mem_alloc( sizeof ( ZDO_UserDescRsp_t ) + descLen );
   \                     ??ZDO_ParseUserDescRsp_0:
   \   000032                ; Setup parameters for call to function osal_mem_alloc
   \   000032   85....       MOV     ?V0 + 0,?V0 + 3
   \   000035   75..00       MOV     ?V0 + 1,#0x0
   \   000038   7404         MOV     A,#0x4
   \   00003A   25..         ADD     A,?V0 + 0
   \   00003C   FA           MOV     R2,A
   \   00003D   7400         MOV     A,#0x0
   \   00003F   35..         ADDC    A,?V0 + 1
   \   000041   FB           MOV     R3,A
   \   000042   12....       LCALL   ??osal_mem_alloc?relay
   \   000045   8A..         MOV     ?V0 + 0,R2
   \   000047   8B..         MOV     ?V0 + 1,R3
   \   000049   85....       MOV     ?V0 + 4,?V0 + 0
   \   00004C   85....       MOV     ?V0 + 5,?V0 + 1
   2686            if ( pRsp )
   \   00004F   E5..         MOV     A,?V0 + 4
   \   000051   6400         XRL     A,#0x0
   \   000053   7004         JNZ     ??ZDO_ParseUserDescRsp_1
   \   000055   E5..         MOV     A,?V0 + 5
   \   000057   6400         XRL     A,#0x0
   \                     ??ZDO_ParseUserDescRsp_1:
   \   000059   606E         JZ      ??ZDO_ParseUserDescRsp_2
   2687            {
   2688              pRsp->status = msg[0];
   \   00005B   8E82         MOV     DPL,R6
   \   00005D   8F83         MOV     DPH,R7
   \   00005F   E0           MOVX    A,@DPTR
   \   000060   85..82       MOV     DPL,?V0 + 4
   \   000063   85..83       MOV     DPH,?V0 + 5
   \   000066   F0           MOVX    @DPTR,A
   2689              pRsp->nwkAddr = BUILD_UINT16( msg[1], msg[2] );
   \   000067   8E82         MOV     DPL,R6
   \   000069   8F83         MOV     DPH,R7
   \   00006B   A3           INC     DPTR
   \   00006C   E0           MOVX    A,@DPTR
   \   00006D   FA           MOV     R2,A
   \   00006E   7B00         MOV     R3,#0x0
   \   000070   8E82         MOV     DPL,R6
   \   000072   8F83         MOV     DPH,R7
   \   000074   A3           INC     DPTR
   \   000075   A3           INC     DPTR
   \   000076   E0           MOVX    A,@DPTR
   \   000077   F8           MOV     R0,A
   \   000078   E4           CLR     A
   \   000079   C8           XCH     A,R0
   \   00007A   F9           MOV     R1,A
   \   00007B   E8           MOV     A,R0
   \   00007C   2A           ADD     A,R2
   \   00007D   F8           MOV     R0,A
   \   00007E   E9           MOV     A,R1
   \   00007F   3B           ADDC    A,R3
   \   000080   F9           MOV     R1,A
   \   000081   85..82       MOV     DPL,?V0 + 4
   \   000084   85..83       MOV     DPH,?V0 + 5
   \   000087   A3           INC     DPTR
   \   000088   E8           MOV     A,R0
   \   000089   F0           MOVX    @DPTR,A
   \   00008A   A3           INC     DPTR
   \   00008B   E9           MOV     A,R1
   \   00008C   F0           MOVX    @DPTR,A
   2690              pRsp->length = descLen;
   \   00008D   85..82       MOV     DPL,?V0 + 4
   \   000090   85..83       MOV     DPH,?V0 + 5
   \   000093   A3           INC     DPTR
   \   000094   A3           INC     DPTR
   \   000095   A3           INC     DPTR
   \   000096   E5..         MOV     A,?V0 + 3
   \   000098   F0           MOVX    @DPTR,A
   2691              if ( descLen )
   \   000099   E5..         MOV     A,?V0 + 3
   \   00009B   602C         JZ      ??ZDO_ParseUserDescRsp_2
   2692                osal_memcpy( pRsp->desc, &msg[4], descLen );
   \   00009D                ; Setup parameters for call to function osal_memcpy
   \   00009D   EE           MOV     A,R6
   \   00009E   2404         ADD     A,#0x4
   \   0000A0   F5..         MOV     ?V0 + 0,A
   \   0000A2   EF           MOV     A,R7
   \   0000A3   3400         ADDC    A,#0x0
   \   0000A5   F5..         MOV     ?V0 + 1,A
   \   0000A7   75..00       MOV     ?V0 + 2,#0x0
   \   0000AA   78..         MOV     R0,#?V0 + 0
   \   0000AC   12....       LCALL   ?PUSH_XSTACK_I_THREE
   \   0000AF   E5..         MOV     A,?V0 + 3
   \   0000B1   F5..         MOV     ?V0 + 0,A
   \   0000B3   AC..         MOV     R4,?V0 + 0
   \   0000B5   7D00         MOV     R5,#0x0
   \   0000B7   E5..         MOV     A,?V0 + 4
   \   0000B9   2404         ADD     A,#0x4
   \   0000BB   FA           MOV     R2,A
   \   0000BC   E5..         MOV     A,?V0 + 5
   \   0000BE   3400         ADDC    A,#0x0
   \   0000C0   FB           MOV     R3,A
   \   0000C1   12....       LCALL   ??osal_memcpy?relay
   \   0000C4   7403         MOV     A,#0x3
   \   0000C6   12....       LCALL   ?DEALLOC_XSTACK8
   2693            }
   2694          
   2695            return ( pRsp );
   \                     ??ZDO_ParseUserDescRsp_2:
   \   0000C9   AA..         MOV     R2,?V0 + 4
   \   0000CB   AB..         MOV     R3,?V0 + 5
   \   0000CD   7F08         MOV     R7,#0x8
   \   0000CF   02....       LJMP    ?BANKED_LEAVE_XDATA
   2696          }
   2697          
   2698          /*********************************************************************
   2699           * @fn          ZDO_ParseSimpleDescBuf
   2700           *
   2701           * @brief       Parse a byte sequence representation of a Simple Descriptor.
   2702           *
   2703           * @param       buf  - pointer to a byte array representing a Simple Desc.
   2704           * @param       desc - SimpleDescriptionFormat_t *
   2705           *
   2706           *              This routine allocates storage for the cluster IDs because
   2707           *              they are 16-bit and need to be aligned to be properly processed.
   2708           *              This routine returns non-zero if an allocation fails.
   2709           *
   2710           *              NOTE: This means that the caller or user of the input structure
   2711           *                    is responsible for freeing the memory
   2712           *
   2713           * @return      0: success
   2714           *              1: failure due to malloc failure.
   2715           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   2716          uint8 ZDO_ParseSimpleDescBuf( byte *buf, SimpleDescriptionFormat_t *desc )
   \                     ZDO_ParseSimpleDescBuf:
   2717          {
   \   000000   74F2         MOV     A,#-0xe
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 14
   \   000005                ; Auto size: 0
   \   000005   EA           MOV     A,R2
   \   000006   FE           MOV     R6,A
   \   000007   EB           MOV     A,R3
   \   000008   FF           MOV     R7,A
   \   000009   8C..         MOV     ?V0 + 4,R4
   \   00000B   8D..         MOV     ?V0 + 5,R5
   2718            uint8 num, i;
   2719          
   2720            desc->EndPoint = *buf++;
   \   00000D   8E82         MOV     DPL,R6
   \   00000F   8F83         MOV     DPH,R7
   \   000011   E0           MOVX    A,@DPTR
   \   000012   85..82       MOV     DPL,?V0 + 4
   \   000015   85..83       MOV     DPH,?V0 + 5
   \   000018   F0           MOVX    @DPTR,A
   \   000019   8E82         MOV     DPL,R6
   \   00001B   8F83         MOV     DPH,R7
   \   00001D   A3           INC     DPTR
   \   00001E   AE82         MOV     R6,DPL
   \   000020   AF83         MOV     R7,DPH
   2721            desc->AppProfId = BUILD_UINT16( buf[0], buf[1] );
   \   000022   8E82         MOV     DPL,R6
   \   000024   8F83         MOV     DPH,R7
   \   000026   E0           MOVX    A,@DPTR
   \   000027   FA           MOV     R2,A
   \   000028   7B00         MOV     R3,#0x0
   \   00002A   8E82         MOV     DPL,R6
   \   00002C   8F83         MOV     DPH,R7
   \   00002E   A3           INC     DPTR
   \   00002F   E0           MOVX    A,@DPTR
   \   000030   F8           MOV     R0,A
   \   000031   E4           CLR     A
   \   000032   C8           XCH     A,R0
   \   000033   F9           MOV     R1,A
   \   000034   E8           MOV     A,R0
   \   000035   2A           ADD     A,R2
   \   000036   F8           MOV     R0,A
   \   000037   E9           MOV     A,R1
   \   000038   3B           ADDC    A,R3
   \   000039   F9           MOV     R1,A
   \   00003A   85..82       MOV     DPL,?V0 + 4
   \   00003D   85..83       MOV     DPH,?V0 + 5
   \   000040   A3           INC     DPTR
   \   000041   E8           MOV     A,R0
   \   000042   F0           MOVX    @DPTR,A
   \   000043   A3           INC     DPTR
   \   000044   E9           MOV     A,R1
   \   000045   F0           MOVX    @DPTR,A
   2722            buf += 2;
   \   000046   EE           MOV     A,R6
   \   000047   2402         ADD     A,#0x2
   \   000049   FE           MOV     R6,A
   \   00004A   EF           MOV     A,R7
   \   00004B   3400         ADDC    A,#0x0
   \   00004D   FF           MOV     R7,A
   2723            desc->AppDeviceId = BUILD_UINT16( buf[0], buf[1] );
   \   00004E   8E82         MOV     DPL,R6
   \   000050   8F83         MOV     DPH,R7
   \   000052   E0           MOVX    A,@DPTR
   \   000053   FA           MOV     R2,A
   \   000054   7B00         MOV     R3,#0x0
   \   000056   8E82         MOV     DPL,R6
   \   000058   8F83         MOV     DPH,R7
   \   00005A   A3           INC     DPTR
   \   00005B   E0           MOVX    A,@DPTR
   \   00005C   F8           MOV     R0,A
   \   00005D   E4           CLR     A
   \   00005E   C8           XCH     A,R0
   \   00005F   F9           MOV     R1,A
   \   000060   E8           MOV     A,R0
   \   000061   2A           ADD     A,R2
   \   000062   F8           MOV     R0,A
   \   000063   E9           MOV     A,R1
   \   000064   3B           ADDC    A,R3
   \   000065   F9           MOV     R1,A
   \   000066   85..82       MOV     DPL,?V0 + 4
   \   000069   85..83       MOV     DPH,?V0 + 5
   \   00006C   A3           INC     DPTR
   \   00006D   A3           INC     DPTR
   \   00006E   A3           INC     DPTR
   \   00006F   E8           MOV     A,R0
   \   000070   F0           MOVX    @DPTR,A
   \   000071   A3           INC     DPTR
   \   000072   E9           MOV     A,R1
   \   000073   F0           MOVX    @DPTR,A
   2724            buf += 2;
   \   000074   EE           MOV     A,R6
   \   000075   2402         ADD     A,#0x2
   \   000077   FE           MOV     R6,A
   \   000078   EF           MOV     A,R7
   \   000079   3400         ADDC    A,#0x0
   \   00007B   FF           MOV     R7,A
   2725            desc->AppDevVer = *buf >> 4;
   \   00007C   8E82         MOV     DPL,R6
   \   00007E   8F83         MOV     DPH,R7
   \   000080   E0           MOVX    A,@DPTR
   \   000081   C4           SWAP    A
   \   000082   540F         ANL     A,#0xf
   \   000084   C0E0         PUSH    A
   \   000086   85..82       MOV     DPL,?V0 + 4
   \   000089   85..83       MOV     DPH,?V0 + 5
   \   00008C   A3           INC     DPTR
   \   00008D   A3           INC     DPTR
   \   00008E   A3           INC     DPTR
   \   00008F   A3           INC     DPTR
   \   000090   A3           INC     DPTR
   \   000091   E0           MOVX    A,@DPTR
   \   000092   54F0         ANL     A,#0xf0
   \   000094   FA           MOV     R2,A
   \   000095   D0E0         POP     A
   \   000097   4A           ORL     A,R2
   \   000098   85..82       MOV     DPL,?V0 + 4
   \   00009B   85..83       MOV     DPH,?V0 + 5
   \   00009E   A3           INC     DPTR
   \   00009F   A3           INC     DPTR
   \   0000A0   A3           INC     DPTR
   \   0000A1   A3           INC     DPTR
   \   0000A2   A3           INC     DPTR
   \   0000A3   F0           MOVX    @DPTR,A
   2726          
   2727            desc->Reserved = 0;
   \   0000A4   85..82       MOV     DPL,?V0 + 4
   \   0000A7   85..83       MOV     DPH,?V0 + 5
   \   0000AA   A3           INC     DPTR
   \   0000AB   A3           INC     DPTR
   \   0000AC   A3           INC     DPTR
   \   0000AD   A3           INC     DPTR
   \   0000AE   A3           INC     DPTR
   \   0000AF   E0           MOVX    A,@DPTR
   \   0000B0   540F         ANL     A,#0xf
   \   0000B2   F0           MOVX    @DPTR,A
   2728            buf++;
   \   0000B3   8E82         MOV     DPL,R6
   \   0000B5   8F83         MOV     DPH,R7
   \   0000B7   A3           INC     DPTR
   \   0000B8   AE82         MOV     R6,DPL
   \   0000BA   AF83         MOV     R7,DPH
   2729          
   2730            // move in input cluster list (if any). allocate aligned memory.
   2731            num = desc->AppNumInClusters = *buf++;
   \   0000BC   8E82         MOV     DPL,R6
   \   0000BE   8F83         MOV     DPH,R7
   \   0000C0   E0           MOVX    A,@DPTR
   \   0000C1   FA           MOV     R2,A
   \   0000C2   8E82         MOV     DPL,R6
   \   0000C4   8F83         MOV     DPH,R7
   \   0000C6   A3           INC     DPTR
   \   0000C7   AE82         MOV     R6,DPL
   \   0000C9   AF83         MOV     R7,DPH
   \   0000CB   EA           MOV     A,R2
   \   0000CC   85..82       MOV     DPL,?V0 + 4
   \   0000CF   85..83       MOV     DPH,?V0 + 5
   \   0000D2   A3           INC     DPTR
   \   0000D3   A3           INC     DPTR
   \   0000D4   A3           INC     DPTR
   \   0000D5   A3           INC     DPTR
   \   0000D6   A3           INC     DPTR
   \   0000D7   A3           INC     DPTR
   \   0000D8   F0           MOVX    @DPTR,A
   \   0000D9   8A..         MOV     ?V0 + 1,R2
   2732            if ( num )
   \   0000DB   E5..         MOV     A,?V0 + 1
   \   0000DD   7003         JNZ     $+5
   \   0000DF   02....       LJMP    ??ZDO_ParseSimpleDescBuf_0 & 0xFFFF
   2733            {
   2734              if (!(desc->pAppInClusterList = (uint16 *)osal_mem_alloc(num*sizeof(uint16))))
   \   0000E2                ; Setup parameters for call to function osal_mem_alloc
   \   0000E2   AA..         MOV     R2,?V0 + 1
   \   0000E4   7B00         MOV     R3,#0x0
   \   0000E6   EA           MOV     A,R2
   \   0000E7   75F002       MOV     B,#0x2
   \   0000EA   A4           MUL     AB
   \   0000EB   CA           XCH     A,R2
   \   0000EC   ACF0         MOV     R4,B
   \   0000EE   75F000       MOV     B,#0x0
   \   0000F1   A4           MUL     AB
   \   0000F2   2C           ADD     A,R4
   \   0000F3   FC           MOV     R4,A
   \   0000F4   75F002       MOV     B,#0x2
   \   0000F7   EB           MOV     A,R3
   \   0000F8   A4           MUL     AB
   \   0000F9   2C           ADD     A,R4
   \   0000FA   FB           MOV     R3,A
   \   0000FB   12....       LCALL   ??osal_mem_alloc?relay
   \   0000FE   8A..         MOV     ?V0 + 2,R2
   \   000100   8B..         MOV     ?V0 + 3,R3
   \   000102   A8..         MOV     R0,?V0 + 2
   \   000104   A9..         MOV     R1,?V0 + 3
   \   000106   85..82       MOV     DPL,?V0 + 4
   \   000109   85..83       MOV     DPH,?V0 + 5
   \   00010C   A3           INC     DPTR
   \   00010D   A3           INC     DPTR
   \   00010E   A3           INC     DPTR
   \   00010F   A3           INC     DPTR
   \   000110   A3           INC     DPTR
   \   000111   A3           INC     DPTR
   \   000112   A3           INC     DPTR
   \   000113   E8           MOV     A,R0
   \   000114   F0           MOVX    @DPTR,A
   \   000115   A3           INC     DPTR
   \   000116   E9           MOV     A,R1
   \   000117   F0           MOVX    @DPTR,A
   \   000118   E8           MOV     A,R0
   \   000119   6400         XRL     A,#0x0
   \   00011B   7003         JNZ     ??ZDO_ParseSimpleDescBuf_1
   \   00011D   E9           MOV     A,R1
   \   00011E   6400         XRL     A,#0x0
   \                     ??ZDO_ParseSimpleDescBuf_1:
   \   000120   7005         JNZ     ??ZDO_ParseSimpleDescBuf_2
   2735              {
   2736                // malloc failed. we're done.
   2737                return 1;
   \   000122   7901         MOV     R1,#0x1
   \   000124   02....       LJMP    ??ZDO_ParseSimpleDescBuf_3 & 0xFFFF
   2738              }
   2739              for (i=0; i<num; ++i)
   \                     ??ZDO_ParseSimpleDescBuf_2:
   \   000127   75..00       MOV     ?V0 + 0,#0x0
   \                     ??ZDO_ParseSimpleDescBuf_4:
   \   00012A   E5..         MOV     A,?V0 + 0
   \   00012C   C3           CLR     C
   \   00012D   95..         SUBB    A,?V0 + 1
   \   00012F   5059         JNC     ??ZDO_ParseSimpleDescBuf_0
   2740              {
   2741                desc->pAppInClusterList[i] = BUILD_UINT16( buf[0], buf[1] );
   \   000131   8E82         MOV     DPL,R6
   \   000133   8F83         MOV     DPH,R7
   \   000135   E0           MOVX    A,@DPTR
   \   000136   FA           MOV     R2,A
   \   000137   7B00         MOV     R3,#0x0
   \   000139   8E82         MOV     DPL,R6
   \   00013B   8F83         MOV     DPH,R7
   \   00013D   A3           INC     DPTR
   \   00013E   E0           MOVX    A,@DPTR
   \   00013F   F8           MOV     R0,A
   \   000140   E4           CLR     A
   \   000141   C8           XCH     A,R0
   \   000142   F9           MOV     R1,A
   \   000143   E8           MOV     A,R0
   \   000144   2A           ADD     A,R2
   \   000145   FA           MOV     R2,A
   \   000146   E9           MOV     A,R1
   \   000147   3B           ADDC    A,R3
   \   000148   FB           MOV     R3,A
   \   000149   A8..         MOV     R0,?V0 + 0
   \   00014B   7900         MOV     R1,#0x0
   \   00014D   E8           MOV     A,R0
   \   00014E   75F002       MOV     B,#0x2
   \   000151   A4           MUL     AB
   \   000152   C8           XCH     A,R0
   \   000153   ACF0         MOV     R4,B
   \   000155   75F000       MOV     B,#0x0
   \   000158   A4           MUL     AB
   \   000159   2C           ADD     A,R4
   \   00015A   FC           MOV     R4,A
   \   00015B   75F002       MOV     B,#0x2
   \   00015E   E9           MOV     A,R1
   \   00015F   A4           MUL     AB
   \   000160   2C           ADD     A,R4
   \   000161   F9           MOV     R1,A
   \   000162   85..82       MOV     DPL,?V0 + 4
   \   000165   85..83       MOV     DPH,?V0 + 5
   \   000168   A3           INC     DPTR
   \   000169   A3           INC     DPTR
   \   00016A   A3           INC     DPTR
   \   00016B   A3           INC     DPTR
   \   00016C   A3           INC     DPTR
   \   00016D   A3           INC     DPTR
   \   00016E   A3           INC     DPTR
   \   00016F   E0           MOVX    A,@DPTR
   \   000170   28           ADD     A,R0
   \   000171   FC           MOV     R4,A
   \   000172   A3           INC     DPTR
   \   000173   E0           MOVX    A,@DPTR
   \   000174   39           ADDC    A,R1
   \   000175   8C82         MOV     DPL,R4
   \   000177   F583         MOV     DPH,A
   \   000179   EA           MOV     A,R2
   \   00017A   F0           MOVX    @DPTR,A
   \   00017B   A3           INC     DPTR
   \   00017C   EB           MOV     A,R3
   \   00017D   F0           MOVX    @DPTR,A
   2742                buf += 2;
   \   00017E   EE           MOV     A,R6
   \   00017F   2402         ADD     A,#0x2
   \   000181   FE           MOV     R6,A
   \   000182   EF           MOV     A,R7
   \   000183   3400         ADDC    A,#0x0
   \   000185   FF           MOV     R7,A
   2743              }
   \   000186   05..         INC     ?V0 + 0
   \   000188   80A0         SJMP    ??ZDO_ParseSimpleDescBuf_4
   2744            }
   2745          
   2746            // move in output cluster list (if any). allocate aligned memory.
   2747            num = desc->AppNumOutClusters = *buf++;
   \                     ??ZDO_ParseSimpleDescBuf_0:
   \   00018A   8E82         MOV     DPL,R6
   \   00018C   8F83         MOV     DPH,R7
   \   00018E   E0           MOVX    A,@DPTR
   \   00018F   FA           MOV     R2,A
   \   000190   8E82         MOV     DPL,R6
   \   000192   8F83         MOV     DPH,R7
   \   000194   A3           INC     DPTR
   \   000195   AE82         MOV     R6,DPL
   \   000197   AF83         MOV     R7,DPH
   \   000199   EA           MOV     A,R2
   \   00019A   85..82       MOV     DPL,?V0 + 4
   \   00019D   85..83       MOV     DPH,?V0 + 5
   \   0001A0   A3           INC     DPTR
   \   0001A1   A3           INC     DPTR
   \   0001A2   A3           INC     DPTR
   \   0001A3   A3           INC     DPTR
   \   0001A4   A3           INC     DPTR
   \   0001A5   A3           INC     DPTR
   \   0001A6   A3           INC     DPTR
   \   0001A7   A3           INC     DPTR
   \   0001A8   A3           INC     DPTR
   \   0001A9   F0           MOVX    @DPTR,A
   \   0001AA   8A..         MOV     ?V0 + 1,R2
   2748            if (num)
   \   0001AC   E5..         MOV     A,?V0 + 1
   \   0001AE   7003         JNZ     $+5
   \   0001B0   02....       LJMP    ??ZDO_ParseSimpleDescBuf_5 & 0xFFFF
   2749            {
   2750              if (!(desc->pAppOutClusterList = (uint16 *)osal_mem_alloc(num*sizeof(uint16))))
   \   0001B3                ; Setup parameters for call to function osal_mem_alloc
   \   0001B3   AA..         MOV     R2,?V0 + 1
   \   0001B5   7B00         MOV     R3,#0x0
   \   0001B7   EA           MOV     A,R2
   \   0001B8   75F002       MOV     B,#0x2
   \   0001BB   A4           MUL     AB
   \   0001BC   CA           XCH     A,R2
   \   0001BD   ACF0         MOV     R4,B
   \   0001BF   75F000       MOV     B,#0x0
   \   0001C2   A4           MUL     AB
   \   0001C3   2C           ADD     A,R4
   \   0001C4   FC           MOV     R4,A
   \   0001C5   75F002       MOV     B,#0x2
   \   0001C8   EB           MOV     A,R3
   \   0001C9   A4           MUL     AB
   \   0001CA   2C           ADD     A,R4
   \   0001CB   FB           MOV     R3,A
   \   0001CC   12....       LCALL   ??osal_mem_alloc?relay
   \   0001CF   8A..         MOV     ?V0 + 2,R2
   \   0001D1   8B..         MOV     ?V0 + 3,R3
   \   0001D3   A8..         MOV     R0,?V0 + 2
   \   0001D5   A9..         MOV     R1,?V0 + 3
   \   0001D7   85..82       MOV     DPL,?V0 + 4
   \   0001DA   85..83       MOV     DPH,?V0 + 5
   \   0001DD   A3           INC     DPTR
   \   0001DE   A3           INC     DPTR
   \   0001DF   A3           INC     DPTR
   \   0001E0   A3           INC     DPTR
   \   0001E1   A3           INC     DPTR
   \   0001E2   A3           INC     DPTR
   \   0001E3   A3           INC     DPTR
   \   0001E4   A3           INC     DPTR
   \   0001E5   A3           INC     DPTR
   \   0001E6   A3           INC     DPTR
   \   0001E7   E8           MOV     A,R0
   \   0001E8   F0           MOVX    @DPTR,A
   \   0001E9   A3           INC     DPTR
   \   0001EA   E9           MOV     A,R1
   \   0001EB   F0           MOVX    @DPTR,A
   \   0001EC   E8           MOV     A,R0
   \   0001ED   6400         XRL     A,#0x0
   \   0001EF   7003         JNZ     ??ZDO_ParseSimpleDescBuf_6
   \   0001F1   E9           MOV     A,R1
   \   0001F2   6400         XRL     A,#0x0
   \                     ??ZDO_ParseSimpleDescBuf_6:
   \   0001F4   7031         JNZ     ??ZDO_ParseSimpleDescBuf_7
   2751              {
   2752                // malloc failed. free input cluster list memory if there is any
   2753                if (desc->pAppInClusterList)
   \   0001F6   85..82       MOV     DPL,?V0 + 4
   \   0001F9   85..83       MOV     DPH,?V0 + 5
   \   0001FC   A3           INC     DPTR
   \   0001FD   A3           INC     DPTR
   \   0001FE   A3           INC     DPTR
   \   0001FF   A3           INC     DPTR
   \   000200   A3           INC     DPTR
   \   000201   A3           INC     DPTR
   \   000202   A3           INC     DPTR
   \   000203   E0           MOVX    A,@DPTR
   \   000204   6400         XRL     A,#0x0
   \   000206   7004         JNZ     ??ZDO_ParseSimpleDescBuf_8
   \   000208   A3           INC     DPTR
   \   000209   E0           MOVX    A,@DPTR
   \   00020A   6400         XRL     A,#0x0
   \                     ??ZDO_ParseSimpleDescBuf_8:
   \   00020C   6015         JZ      ??ZDO_ParseSimpleDescBuf_9
   2754                {
   2755                  osal_mem_free(desc->pAppInClusterList);
   \   00020E                ; Setup parameters for call to function osal_mem_free
   \   00020E   85..82       MOV     DPL,?V0 + 4
   \   000211   85..83       MOV     DPH,?V0 + 5
   \   000214   A3           INC     DPTR
   \   000215   A3           INC     DPTR
   \   000216   A3           INC     DPTR
   \   000217   A3           INC     DPTR
   \   000218   A3           INC     DPTR
   \   000219   A3           INC     DPTR
   \   00021A   A3           INC     DPTR
   \   00021B   E0           MOVX    A,@DPTR
   \   00021C   FA           MOV     R2,A
   \   00021D   A3           INC     DPTR
   \   00021E   E0           MOVX    A,@DPTR
   \   00021F   FB           MOV     R3,A
   \   000220   12....       LCALL   ??osal_mem_free?relay
   2756                }
   2757                return 1;
   \                     ??ZDO_ParseSimpleDescBuf_9:
   \   000223   7901         MOV     R1,#0x1
   \   000225   8068         SJMP    ??ZDO_ParseSimpleDescBuf_3
   2758              }
   2759              for (i=0; i<num; ++i)
   \                     ??ZDO_ParseSimpleDescBuf_7:
   \   000227   75..00       MOV     ?V0 + 0,#0x0
   \                     ??ZDO_ParseSimpleDescBuf_10:
   \   00022A   E5..         MOV     A,?V0 + 0
   \   00022C   C3           CLR     C
   \   00022D   95..         SUBB    A,?V0 + 1
   \   00022F   505C         JNC     ??ZDO_ParseSimpleDescBuf_5
   2760              {
   2761                desc->pAppOutClusterList[i] = BUILD_UINT16( buf[0], buf[1] );
   \   000231   8E82         MOV     DPL,R6
   \   000233   8F83         MOV     DPH,R7
   \   000235   E0           MOVX    A,@DPTR
   \   000236   FA           MOV     R2,A
   \   000237   7B00         MOV     R3,#0x0
   \   000239   8E82         MOV     DPL,R6
   \   00023B   8F83         MOV     DPH,R7
   \   00023D   A3           INC     DPTR
   \   00023E   E0           MOVX    A,@DPTR
   \   00023F   F8           MOV     R0,A
   \   000240   E4           CLR     A
   \   000241   C8           XCH     A,R0
   \   000242   F9           MOV     R1,A
   \   000243   E8           MOV     A,R0
   \   000244   2A           ADD     A,R2
   \   000245   FA           MOV     R2,A
   \   000246   E9           MOV     A,R1
   \   000247   3B           ADDC    A,R3
   \   000248   FB           MOV     R3,A
   \   000249   A8..         MOV     R0,?V0 + 0
   \   00024B   7900         MOV     R1,#0x0
   \   00024D   E8           MOV     A,R0
   \   00024E   75F002       MOV     B,#0x2
   \   000251   A4           MUL     AB
   \   000252   C8           XCH     A,R0
   \   000253   ACF0         MOV     R4,B
   \   000255   75F000       MOV     B,#0x0
   \   000258   A4           MUL     AB
   \   000259   2C           ADD     A,R4
   \   00025A   FC           MOV     R4,A
   \   00025B   75F002       MOV     B,#0x2
   \   00025E   E9           MOV     A,R1
   \   00025F   A4           MUL     AB
   \   000260   2C           ADD     A,R4
   \   000261   F9           MOV     R1,A
   \   000262   85..82       MOV     DPL,?V0 + 4
   \   000265   85..83       MOV     DPH,?V0 + 5
   \   000268   A3           INC     DPTR
   \   000269   A3           INC     DPTR
   \   00026A   A3           INC     DPTR
   \   00026B   A3           INC     DPTR
   \   00026C   A3           INC     DPTR
   \   00026D   A3           INC     DPTR
   \   00026E   A3           INC     DPTR
   \   00026F   A3           INC     DPTR
   \   000270   A3           INC     DPTR
   \   000271   A3           INC     DPTR
   \   000272   E0           MOVX    A,@DPTR
   \   000273   28           ADD     A,R0
   \   000274   FC           MOV     R4,A
   \   000275   A3           INC     DPTR
   \   000276   E0           MOVX    A,@DPTR
   \   000277   39           ADDC    A,R1
   \   000278   8C82         MOV     DPL,R4
   \   00027A   F583         MOV     DPH,A
   \   00027C   EA           MOV     A,R2
   \   00027D   F0           MOVX    @DPTR,A
   \   00027E   A3           INC     DPTR
   \   00027F   EB           MOV     A,R3
   \   000280   F0           MOVX    @DPTR,A
   2762                buf += 2;
   \   000281   EE           MOV     A,R6
   \   000282   2402         ADD     A,#0x2
   \   000284   FE           MOV     R6,A
   \   000285   EF           MOV     A,R7
   \   000286   3400         ADDC    A,#0x0
   \   000288   FF           MOV     R7,A
   2763              }
   \   000289   05..         INC     ?V0 + 0
   \   00028B   809D         SJMP    ??ZDO_ParseSimpleDescBuf_10
   2764            }
   2765            return 0;
   \                     ??ZDO_ParseSimpleDescBuf_5:
   \   00028D   7900         MOV     R1,#0x0
   \                     ??ZDO_ParseSimpleDescBuf_3:
   \   00028F   7F06         MOV     R7,#0x6
   \   000291   02....       LJMP    ?BANKED_LEAVE_XDATA
   2766          }
   2767          
   2768          /*********************************************************************
   2769           * @fn          ZDO_ParseDeviceAnnce
   2770           *
   2771           * @brief       Parse a Device Announce message.
   2772           *
   2773           * @param       inMsg - Incoming message
   2774           * @param       pAnnce - place to put the parsed information
   2775           *
   2776           * @return      none
   2777           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   2778          void ZDO_ParseDeviceAnnce( zdoIncomingMsg_t *inMsg, ZDO_DeviceAnnce_t *pAnnce )
   \                     ZDO_ParseDeviceAnnce:
   2779          {
   \   000000   74F4         MOV     A,#-0xc
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 12
   \   000005                ; Auto size: 0
   \   000005   8A..         MOV     ?V0 + 2,R2
   \   000007   8B..         MOV     ?V0 + 3,R3
   \   000009   8C..         MOV     ?V0 + 0,R4
   \   00000B   8D..         MOV     ?V0 + 1,R5
   2780            uint8 *msg;
   2781          
   2782            // Parse incoming message
   2783            msg = inMsg->asdu;
   \   00000D   E5..         MOV     A,?V0 + 2
   \   00000F   2411         ADD     A,#0x11
   \   000011   F582         MOV     DPL,A
   \   000013   E5..         MOV     A,?V0 + 3
   \   000015   3400         ADDC    A,#0x0
   \   000017   F583         MOV     DPH,A
   \   000019   E0           MOVX    A,@DPTR
   \   00001A   F8           MOV     R0,A
   \   00001B   A3           INC     DPTR
   \   00001C   E0           MOVX    A,@DPTR
   \   00001D   F9           MOV     R1,A
   \   00001E   E8           MOV     A,R0
   \   00001F   FE           MOV     R6,A
   \   000020   E9           MOV     A,R1
   \   000021   FF           MOV     R7,A
   2784            pAnnce->nwkAddr = BUILD_UINT16( msg[0], msg[1] );
   \   000022   8E82         MOV     DPL,R6
   \   000024   8F83         MOV     DPH,R7
   \   000026   E0           MOVX    A,@DPTR
   \   000027   FA           MOV     R2,A
   \   000028   7B00         MOV     R3,#0x0
   \   00002A   8E82         MOV     DPL,R6
   \   00002C   8F83         MOV     DPH,R7
   \   00002E   A3           INC     DPTR
   \   00002F   E0           MOVX    A,@DPTR
   \   000030   F8           MOV     R0,A
   \   000031   E4           CLR     A
   \   000032   C8           XCH     A,R0
   \   000033   F9           MOV     R1,A
   \   000034   E8           MOV     A,R0
   \   000035   2A           ADD     A,R2
   \   000036   F8           MOV     R0,A
   \   000037   E9           MOV     A,R1
   \   000038   3B           ADDC    A,R3
   \   000039   F9           MOV     R1,A
   \   00003A   85..82       MOV     DPL,?V0 + 0
   \   00003D   85..83       MOV     DPH,?V0 + 1
   \   000040   E8           MOV     A,R0
   \   000041   F0           MOVX    @DPTR,A
   \   000042   A3           INC     DPTR
   \   000043   E9           MOV     A,R1
   \   000044   F0           MOVX    @DPTR,A
   2785            msg += 2;
   \   000045   EE           MOV     A,R6
   \   000046   2402         ADD     A,#0x2
   \   000048   FE           MOV     R6,A
   \   000049   EF           MOV     A,R7
   \   00004A   3400         ADDC    A,#0x0
   \   00004C   FF           MOV     R7,A
   2786            osal_cpyExtAddr( pAnnce->extAddr, msg );
   \   00004D                ; Setup parameters for call to function osal_cpyExtAddr
   \   00004D   EE           MOV     A,R6
   \   00004E   FC           MOV     R4,A
   \   00004F   EF           MOV     A,R7
   \   000050   FD           MOV     R5,A
   \   000051   E5..         MOV     A,?V0 + 0
   \   000053   2402         ADD     A,#0x2
   \   000055   FA           MOV     R2,A
   \   000056   E5..         MOV     A,?V0 + 1
   \   000058   3400         ADDC    A,#0x0
   \   00005A   FB           MOV     R3,A
   \   00005B   12....       LCALL   ??osal_cpyExtAddr?relay
   2787            msg += Z_EXTADDR_LEN;
   \   00005E   EE           MOV     A,R6
   \   00005F   2408         ADD     A,#0x8
   \   000061   FE           MOV     R6,A
   \   000062   EF           MOV     A,R7
   \   000063   3400         ADDC    A,#0x0
   \   000065   FF           MOV     R7,A
   2788            pAnnce->capabilities = *msg;
   \   000066   8E82         MOV     DPL,R6
   \   000068   8F83         MOV     DPH,R7
   \   00006A   E0           MOVX    A,@DPTR
   \   00006B   85..82       MOV     DPL,?V0 + 0
   \   00006E   85..83       MOV     DPH,?V0 + 1
   \   000071   A3           INC     DPTR
   \   000072   A3           INC     DPTR
   \   000073   A3           INC     DPTR
   \   000074   A3           INC     DPTR
   \   000075   A3           INC     DPTR
   \   000076   A3           INC     DPTR
   \   000077   A3           INC     DPTR
   \   000078   A3           INC     DPTR
   \   000079   A3           INC     DPTR
   \   00007A   A3           INC     DPTR
   \   00007B   F0           MOVX    @DPTR,A
   2789          }
   \   00007C   7F04         MOV     R7,#0x4
   \   00007E   02....       LJMP    ?BANKED_LEAVE_XDATA

   \                                 In  segment XDATA_I, align 1, keep-with-next
   \                     __Constant_0:
   \   000000                DS 4
   \   000004                REQUIRE `?<Initializer for __Constant_0>`
   \   000004                REQUIRE __INIT_XDATA_I

   \                                 In  segment XDATA_ID, align 1, keep-with-next
   \                     `?<Initializer for __Constant_0>`:
   \   000000   00000000     DD 0

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDO_Init?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDO_Init

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDODeviceSetup?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDODeviceSetup

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDO_StartDevice?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDO_StartDevice

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDO_UpdateNwkStatus?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDO_UpdateNwkStatus

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDO_RemoveEndDeviceBind?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDO_RemoveEndDeviceBind

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDO_SendEDBindRsp?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDO_SendEDBindRsp

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDO_AnyClusterMatches?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDO_AnyClusterMatches

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDO_ProcessNodeDescReq?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDO_ProcessNodeDescReq

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDO_ProcessPowerDescReq?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDO_ProcessPowerDescReq

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDO_ProcessSimpleDescReq?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDO_ProcessSimpleDescReq

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDO_ProcessActiveEPReq?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDO_ProcessActiveEPReq

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDO_ConvertOTAClusters?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDO_ConvertOTAClusters

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDO_ProcessMatchDescReq?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDO_ProcessMatchDescReq

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDO_ProcessBindUnbindReq?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDO_ProcessBindUnbindReq

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDO_UpdateAddrManager?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDO_UpdateAddrManager

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDO_EndDeviceTimeoutCB?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDO_EndDeviceTimeoutCB

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDO_BuildSimpleDescBuf?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDO_BuildSimpleDescBuf

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDO_ParseEndDeviceBindReq?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDO_ParseEndDeviceBindReq

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDO_ParseBindUnbindReq?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDO_ParseBindUnbindReq

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDO_ParseAddrRsp?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDO_ParseAddrRsp

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDO_ParseNodeDescRsp?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDO_ParseNodeDescRsp

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDO_ParsePowerDescRsp?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDO_ParsePowerDescRsp

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDO_ParseSimpleDescRsp?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDO_ParseSimpleDescRsp

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDO_ParseEPListRsp?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDO_ParseEPListRsp

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDO_ParseServerDiscRsp?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDO_ParseServerDiscRsp

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDO_ParseMgmtLqiRsp?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDO_ParseMgmtLqiRsp

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDO_ParseMgmNwkDiscRsp?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDO_ParseMgmNwkDiscRsp

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDO_ParseMgmtRtgRsp?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDO_ParseMgmtRtgRsp

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDO_ParseMgmtBindRsp?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDO_ParseMgmtBindRsp

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDO_ParseUserDescRsp?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDO_ParseUserDescRsp

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDO_ParseSimpleDescBuf?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDO_ParseSimpleDescBuf

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??ZDO_ParseDeviceAnnce?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    ZDO_ParseDeviceAnnce
   2790          
   2791          /*********************************************************************
   2792          *********************************************************************/
   2793          
   2794          

   Maximum stack usage in bytes:

     Function                       ISTACK PSTACK XSTACK
     --------                       ------ ------ ------
     ZDODeviceSetup                     2      0      0
       -> APS_ReflectorInit             4      0      0
       -> NLME_DeviceJoiningInit        4      0      0
     ZDO_AnyClusterMatches              0      0     49
     ZDO_BuildSimpleDescBuf             1      0      9
     ZDO_ConvertOTAClusters             0      0     45
     ZDO_EndDeviceTimeoutCB             0      0      9
       -> ZDO_SendEDBindRsp             0      0     18
       -> ZDO_RemoveEndDeviceBind       0      0     18
     ZDO_Init                           2      0      0
       -> ZDODeviceSetup                4      0      0
     ZDO_ParseAddrRsp                   1      0     16
       -> osal_mem_alloc                0      0     32
       -> osal_cpyExtAddr               0      0     32
     ZDO_ParseBindUnbindReq             1      0     12
       -> osal_cpyExtAddr               0      0     24
       -> osal_cpyExtAddr               0      0     24
     ZDO_ParseDeviceAnnce               1      0     12
       -> osal_cpyExtAddr               0      0     24
     ZDO_ParseEPListRsp                 1      0     20
       -> osal_mem_alloc                0      0     34
       -> osal_memcpy                   0      0     40
     ZDO_ParseEndDeviceBindReq          1      0     14
       -> osal_cpyExtAddr               0      0     28
       -> osal_mem_alloc                0      0     28
       -> ZDO_ConvertOTAClusters        0      0     28
       -> osal_mem_alloc                0      0     28
       -> ZDO_ConvertOTAClusters        0      0     28
     ZDO_ParseMgmNwkDiscRsp             1      0     19
       -> osal_mem_alloc                0      0     38
       -> osal_cpyExtAddr               0      0     38
     ZDO_ParseMgmtBindRsp               1      0     19
       -> osal_mem_alloc                0      0     38
       -> osal_cpyExtAddr               0      0     38
       -> osal_cpyExtAddr               0      0     38
     ZDO_ParseMgmtLqiRsp                1      0     19
       -> osal_mem_alloc                0      0     38
       -> osal_cpyExtAddr               0      0     38
     ZDO_ParseMgmtRtgRsp                1      0     18
       -> osal_mem_alloc                0      0     36
     ZDO_ParseNodeDescRsp               2      0     10
     ZDO_ParsePowerDescRsp              1      0     12
     ZDO_ParseServerDiscRsp             1      0      9
     ZDO_ParseSimpleDescBuf             1      0     26
       -> osal_mem_alloc                0      0     28
       -> osal_mem_alloc                0      0     28
       -> osal_mem_free                 0      0     28
     ZDO_ParseSimpleDescRsp             1      0     12
       -> ZDO_ParseSimpleDescBuf        0      0     24
     ZDO_ParseUserDescRsp               1      0     19
       -> osal_mem_alloc                0      0     32
       -> osal_memcpy                   0      0     38
     ZDO_ProcessActiveEPReq             0      0     21
       -> NLME_GetShortAddr             0      0     28
       -> afNumEndPoints                0      0     28
       -> afEndPoints                   0      0     28
       -> ZDP_EPRsp                     0      0     42
     ZDO_ProcessBindUnbindReq           1      0     29
       -> osal_cpyExtAddr               0      0     48
       -> NLME_GetExtAddr               0      0     48
       -> osal_ExtAddrEqual             0      0     48
       -> APSME_LookupNwkAddr           0      0     48
       -> ZDP_NwkAddrReq                0      0     48
       -> APSME_BindRequest             0      0     50
       -> ZDApp_NVUpdate                0      0     48
       -> APSME_UnBindRequest           0      0     50
       -> ZDApp_NVUpdate                0      0     48
       -> ZDP_SendData                  0      0     58
     ZDO_ProcessMatchDescReq            1      0     41
       -> NLME_IsAddressBroadcast       0      0     68
       -> ZDP_EPRsp                     0      0     82
       -> NLME_IsAddressBroadcast       0      0     68
       -> ZDP_EPRsp                     0      0     82
       -> osal_mem_alloc                0      0     68
       -> ZDO_ConvertOTAClusters        0      0     68
       -> osal_mem_alloc                0      0     68
       -> ZDO_ConvertOTAClusters        0      0     68
       -> ZDO_AnyClusterMatches         0      0     72
       -> ZDO_AnyClusterMatches         0      0     72
       -> osal_msg_allocate             0      0     68
       -> osal_memcpy                   0      0     74
       -> osal_memcpy                   0      0     74
       -> osal_msg_send                 0      0     68
       -> osal_mem_free                 0      0     68
       -> ZDP_EPRsp                     0      0     82
       -> osal_mem_free                 0      0     68
       -> osal_mem_free                 0      0     68
     ZDO_ProcessNodeDescReq             0      0     18
       -> ZDP_NodeDescMsg               0      0     32
       -> ZDP_GenericRsp                0      0     36
     ZDO_ProcessPowerDescReq            0      0     18
       -> ZDP_PowerDescMsg              0      0     32
       -> ZDP_GenericRsp                0      0     36
     ZDO_ProcessSimpleDescReq           0      0     16
       -> afFindSimpleDesc              0      0     32
       -> ZDP_SimpleDescMsg             0      0     32
       -> osal_mem_free                 0      0     32
     ZDO_RemoveEndDeviceBind            2      0      9
       -> osal_mem_free                 4      0      0
       -> osal_mem_free                 4      0      0
       -> osal_mem_free                 4      0      0
     ZDO_SendEDBindRsp                  1      0     27
       -> ZDP_SendData                  0      0     36
     ZDO_StartDevice                    1      0     26
       -> NLME_NetworkDiscoveryRequest
                                        0      0     52
       -> nwk_ScanJoiningOrphan         0      0     52
       -> NLME_OrphanJoinRequest        0      0     52
       -> osal_start_timerEx            0      0     52
     ZDO_UpdateAddrManager              1      0     23
       -> AddrMgrExtAddrSet             0      0     46
       -> AddrMgrEntryUpdate            0      0     46
     ZDO_UpdateNwkStatus                1      0     14
       -> NLME_GetShortAddr             0      0     28
       -> NLME_GetExtAddr               0      0     28
       -> osal_msg_allocate             0      0     28
       -> osal_msg_send                 0      0     28


   Segment part sizes:

     Function/Label                 Bytes
     --------------                 -----
     ZDOBuildBuf                      52
     ZDO_EDBind                        2
     ZDO_Init                         24
     ZDODeviceSetup                   19
     ZDO_StartDevice                 233
     ZDO_UpdateNwkStatus             164
     ZDO_RemoveEndDeviceBind         148
     ZDO_SendEDBindRsp               104
     ZDO_AnyClusterMatches           146
     ZDO_ProcessNodeDescReq          189
     ZDO_ProcessPowerDescReq         189
     ZDO_ProcessSimpleDescReq        232
     ZDO_ProcessActiveEPReq          213
     ZDO_ConvertOTAClusters          103
     ZDO_ProcessMatchDescReq        1877
     ZDO_ProcessBindUnbindReq        590
     ZDO_UpdateAddrManager            76
     ZDO_EndDeviceTimeoutCB           93
     ZDO_BuildSimpleDescBuf          393
     ZDO_ParseEndDeviceBindReq       586
     ZDO_ParseBindUnbindReq          277
     ZDO_ParseAddrRsp                419
     ZDO_ParseNodeDescRsp            473
     ZDO_ParsePowerDescRsp           355
     ZDO_ParseSimpleDescRsp          139
     ZDO_ParseEPListRsp              241
     ZDO_ParseServerDiscRsp           98
     ZDO_ParseMgmtLqiRsp             426
     ZDO_ParseMgmNwkDiscRsp          540
     ZDO_ParseMgmtRtgRsp             387
     ZDO_ParseMgmtBindRsp            555
     ZDO_ParseUserDescRsp            210
     ZDO_ParseSimpleDescBuf          660
     ZDO_ParseDeviceAnnce            129
     __Constant_0                      4
     ?<Initializer for __Constant_0>
                                       4
     ??ZDO_Init?relay                  6
     ??ZDODeviceSetup?relay            6
     ??ZDO_StartDevice?relay           6
     ??ZDO_UpdateNwkStatus?relay       6
     ??ZDO_RemoveEndDeviceBind?relay
                                       6
     ??ZDO_SendEDBindRsp?relay         6
     ??ZDO_AnyClusterMatches?relay     6
     ??ZDO_ProcessNodeDescReq?relay    6
     ??ZDO_ProcessPowerDescReq?relay
                                       6
     ??ZDO_ProcessSimpleDescReq?relay
                                       6
     ??ZDO_ProcessActiveEPReq?relay    6
     ??ZDO_ConvertOTAClusters?relay    6
     ??ZDO_ProcessMatchDescReq?relay
                                       6
     ??ZDO_ProcessBindUnbindReq?relay
                                       6
     ??ZDO_UpdateAddrManager?relay     6
     ??ZDO_EndDeviceTimeoutCB?relay    6
     ??ZDO_BuildSimpleDescBuf?relay    6
     ??ZDO_ParseEndDeviceBindReq?relay
                                       6
     ??ZDO_ParseBindUnbindReq?relay    6
     ??ZDO_ParseAddrRsp?relay          6
     ??ZDO_ParseNodeDescRsp?relay      6
     ??ZDO_ParsePowerDescRsp?relay     6
     ??ZDO_ParseSimpleDescRsp?relay    6
     ??ZDO_ParseEPListRsp?relay        6
     ??ZDO_ParseServerDiscRsp?relay    6
     ??ZDO_ParseMgmtLqiRsp?relay       6
     ??ZDO_ParseMgmNwkDiscRsp?relay    6
     ??ZDO_ParseMgmtRtgRsp?relay       6
     ??ZDO_ParseMgmtBindRsp?relay      6
     ??ZDO_ParseUserDescRsp?relay      6
     ??ZDO_ParseSimpleDescBuf?relay    6
     ??ZDO_ParseDeviceAnnce?relay      6

 
 10 288 bytes in segment BANKED_CODE
    192 bytes in segment BANK_RELAYS
      4 bytes in segment XDATA_I
      4 bytes in segment XDATA_ID
     54 bytes in segment XDATA_Z
 
 10 480 bytes of CODE  memory (+ 4 bytes shared)
     54 bytes of XDATA memory (+ 4 bytes shared)

Errors: none
Warnings: none
